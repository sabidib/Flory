'use strict';var fa;function Ka(a,b,c){this.x=void 0===a?0:a;this.y=void 0===b?0:b;this.z=void 0===c?0:c}
Ka.prototype={Kf:function(){return 3},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},scale:function(a){this.x*=a;this.y*=a;this.z*=a;return this},th:function(a){return new Ka(this.x*a,this.y*a,this.z*a)},pa:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},Ye:function(){return this.x*this.x+this.y*this.y+this.z*this.z},mb:function(a){return Math.sqrt((a.x-
this.x)*(a.x-this.x)+(a.y-this.y)*(a.y-this.y)+(a.z-this.z)*(a.z-this.z))},Se:function(a){return(a.x-this.x)*(a.x-this.x)+(a.y-this.y)*(a.y-this.y)+(a.z-this.z)*(a.z-this.z)},clone:function(){return new Ka(this.x,this.y,this.z)}};function Oa(a){this.h=void 0==a?[]:"number"==typeof a?[].slice.apply(new Uint8Array(a)):a}
Oa.prototype={Kf:function(){return this.h.length},add:function(a){if(a.h.length>this.h.length){for(var b=0,c=this.h.length;b<c;b++)this.h[b]+=a.h[b];for(c=a.h.length;b<c;b++)this.h[b]=0,this.h[b]+=a.h[b]}else for(var b=0,c=a.h.length;b<c;b++)this.h[b]+=a.h[b];return this},sub:function(a){if(a.h.length>this.h.length){for(var b=0,c=this.h.length;b<c;b++)this.h[b]-=a.h[b];for(c=a.h.length;b<c;b++)this.h[b]=0,this.h[b]-=a.h[b]}else for(var b=0,c=a.h.length;b<c;b++)this.h[b]-=a.h[b];return this},scale:function(a){for(var b=
0,c=this.h.length;b<c;b++)this.h[b]*=a;return this},th:function(a){for(var b=[],c=0,e=this.h.length;c<e;c++)b[c]=a*this.h[c];return new Oa(b)},pa:function(a){if(a.h.length!=this.h.length)console.log("Flory.vector.dot(a) can only accept a vector of the same dimension as the object.");else{for(var b=0,c=0,e=a.h.length;c<e;c++)b+=this.h[c]*a.h[c];return b}},length:function(){for(var a=0,b=0,c=this.h.length;b<c;b++)a+=this.h[b]*this.h[b];return Math.sqrt(a)},Ye:function(){for(var a=0,b=0,c=this.h.length;b<
c;b++)a+=this.h[b]*this.h[b];return a},mb:function(a){var b=0,c=0;if(a.h.length>this.h.length){for(var e=this.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);for(;c<len2;c++)b+=(0-a.h[c])*(0-a.h[c])}else if(a.h.length<this.h.length){for(e=a.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);for(;c<len2;c++)b+=(this.h[c]-0)*(this.h[c]-0)}else for(e=a.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);return Math.sqrt(b)},Se:function(a){var b=0,c=0;if(a.h.length>this.h.length){for(var e=
this.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);for(;c<len2;c++)b+=(0-a.h[c])*(0-a.h[c])}else if(a.h.length<this.h.length){for(e=a.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);for(;c<len2;c++)b+=(this.h[c]-0)*(this.h[c]-0)}else for(e=a.h.length;c<e;c++)b+=(this.h[c]-a.h[c])*(this.h[c]-a.h[c]);return b},clone:function(){return new Oa(this.h.slice(0))}};
function Sa(a){void 0==a&&(a=(new Date).getTime());this.tc=624;this.Gg=397;this.Om=2567483615;this.oi=2147483648;this.$h=2147483647;this.Ka=Array(this.tc);this.Ib=this.tc+1;Za(this,a)}function Za(a,b){a.Ka[0]=b>>>0;for(a.Ib=1;a.Ib<a.tc;a.Ib++)b=a.Ka[a.Ib-1]^a.Ka[a.Ib-1]>>>30,a.Ka[a.Ib]=(1812433253*((b&4294901760)>>>16)<<16)+1812433253*(b&65535)+a.Ib,a.Ka[a.Ib]>>>=0}
Sa.prototype.random=function(){var a,b=[0,this.Om];if(this.Ib>=this.tc){var c;this.Ib==this.tc+1&&Za(this,5489);for(c=0;c<this.tc-this.Gg;c++)a=this.Ka[c]&this.oi|this.Ka[c+1]&this.$h,this.Ka[c]=this.Ka[c+this.Gg]^a>>>1^b[a&1];for(;c<this.tc-1;c++)a=this.Ka[c]&this.oi|this.Ka[c+1]&this.$h,this.Ka[c]=this.Ka[c+(this.Gg-this.tc)]^a>>>1^b[a&1];a=this.Ka[this.tc-1]&this.oi|this.Ka[0]&this.$h;this.Ka[this.tc-1]=this.Ka[this.Gg-1]^a>>>1^b[a&1];this.Ib=0}a=this.Ka[this.Ib++];a^=a>>>11;a^=a<<7&2636928640;
a^=a<<15&4022730752;return 1/4294967296*((a^a>>>18)>>>0)};function bb(a){this.da=[];for(var b=0;16>b;b++)this.da[b]=a[b]}
bb.prototype={add:function(a){for(var b=0;16>b;b++)this.da[b]+=a.da[b];return this},multiply:function(a){m=this.da;t=a.da;m[0]=m[0]*t[0]+m[1]*t[4]+m[2]*t[8]+m[3]*t[12];m[1]=m[0]*t[1]+m[1]*t[5]+m[2]*t[9]+m[3]*t[13];m[2]=m[0]*t[2]+m[1]*t[6]+m[2]*t[10]+m[3]*t[14];m[3]=m[0]*t[3]+m[1]*t[7]+m[2]*t[11]+m[3]*t[15];m[0]=m[4]*t[0]+m[5]*t[4]+m[6]*t[8]+m[7]*t[12];m[1]=m[4]*t[1]+m[5]*t[5]+m[6]*t[9]+m[7]*t[13];m[2]=m[4]*t[2]+m[5]*t[6]+m[6]*t[10]+m[7]*t[14];m[3]=m[4]*t[3]+m[5]*t[7]+m[6]*t[11]+m[7]*t[15];m[0]=m[8]*
t[0]+m[9]*t[4]+m[10]*t[8]+m[11]*t[12];m[1]=m[8]*t[1]+m[9]*t[5]+m[10]*t[9]+m[11]*t[13];m[2]=m[8]*t[2]+m[9]*t[6]+m[10]*t[10]+m[11]*t[14];m[3]=m[8]*t[3]+m[9]*t[7]+m[10]*t[11]+m[11]*t[15];m[0]=m[12]*t[0]+m[13]*t[4]+m[14]*t[8]+m[15]*t[12];m[1]=m[12]*t[1]+m[13]*t[5]+m[14]*t[9]+m[15]*t[13];m[2]=m[12]*t[2]+m[13]*t[6]+m[14]*t[10]+m[15]*t[14];m[3]=m[12]*t[3]+m[13]*t[7]+m[14]*t[11]+m[15]*t[15];return this},xj:function(){for(var a=0;4>a;a++)for(var b=0;4>b;b++)this.da[a*b+b]=this.da[a*b+a]}};
new bb([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);var d={ek:"68"};"object"===typeof module&&(module.er=d);d.pq=0;d.nq=1;d.Vh=2;d.oq=3;d.uq=0;d.tq=1;d.hq=0;d.$j=1;d.ak=2;d.Nj=0;d.te=1;d.Id=2;d.Cq=0;d.Wh=1;d.Qd=2;d.Ld=0;d.nf=1;d.Rd=2;d.Yj=0;d.gi=1;d.Bj=2;d.nk=3;d.Rm=4;d.Hj=5;d.Aj=100;d.on=101;d.fn=102;d.An=200;d.Vm=201;d.nn=202;d.Ym=203;d.mk=204;d.Zj=205;d.Am=206;d.Wm=207;d.Bm=208;d.Xm=209;d.mn=210;d.fi=0;d.Bq=1;d.gq=2;d.qk=function(){};d.lq=function(){};d.um=function(){};d.jn=function(){};d.kn=function(){};
d.De=1E3;d.kf=1001;d.Uj=1002;d.Be=1003;d.Xj=1004;d.Wj=1005;d.Jd=1006;d.Km=1007;d.ci=1008;d.qi=1009;d.pm=1010;d.hn=1011;d.xn=1012;d.Gm=1013;d.tn=1014;d.Xh=1015;d.un=1016;d.vn=1017;d.wn=1018;d.km=1019;d.ii=1020;d.Nd=1021;d.Nm=1022;d.Mm=1023;d.cn=2001;d.$m=2002;d.an=2003;d.bn=2004;d.q=function(a){return 3===arguments.length?cb(this,arguments[0],arguments[1],arguments[2]):this.set(a)};
d.q.prototype={C:1,B:1,i:1,set:function(a){a instanceof d.q?this.c(a):"number"===typeof a?kb(this,a):"string"===typeof a&&(/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.test(a)?(a=/^rgb\((\d+), ?(\d+), ?(\d+)\)$/i.exec(a),this.C=Math.min(255,parseInt(a[1],10))/255,this.B=Math.min(255,parseInt(a[2],10))/255,this.i=Math.min(255,parseInt(a[3],10))/255):/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.test(a)?(a=/^rgb\((\d+)\%, ?(\d+)\%, ?(\d+)\%\)$/i.exec(a),this.C=Math.min(100,parseInt(a[1],10))/100,this.B=Math.min(100,
parseInt(a[2],10))/100,this.i=Math.min(100,parseInt(a[3],10))/100):/^\#([0-9a-f]{6})$/i.test(a)?(a=/^\#([0-9a-f]{6})$/i.exec(a),kb(this,parseInt(a[1],16))):/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(a)?(a=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a),kb(this,parseInt(a[1]+a[1]+a[2]+a[2]+a[3]+a[3],16))):/^(\w+)$/i.test(a)&&kb(this,d.sm[a]));return this},c:function(a){this.C=a.C;this.B=a.B;this.i=a.i;return this},add:function(a){this.C+=a.C;this.B+=a.B;this.i+=a.i;return this},qd:function(a){this.C+=
a;this.B+=a;this.i+=a;return this},multiply:function(a){this.C*=a.C;this.B*=a.B;this.i*=a.i;return this},G:function(a){this.C*=a;this.B*=a;this.i*=a;return this},Ic:function(a,b){this.C+=(a.C-this.C)*b;this.B+=(a.B-this.B)*b;this.i+=(a.i-this.i)*b;return this},la:function(a){return a.C===this.C&&a.B===this.B&&a.i===this.i},Fb:function(a){this.C=a[0];this.B=a[1];this.i=a[2];return this},clone:function(){return cb(new d.q,this.C,this.B,this.i)}};
function ob(a){return"rgb("+(255*a.C|0)+","+(255*a.B|0)+","+(255*a.i|0)+")"}function pb(a){return 255*a.C<<16^255*a.B<<8^255*a.i<<0}function Ab(a,b){a.C=b.C*b.C;a.B=b.B*b.B;a.i=b.i*b.i}function cb(a,b,c,e){a.C=b;a.B=c;a.i=e;return a}function kb(a,b){b=Math.floor(b);a.C=(b>>16&255)/255;a.B=(b>>8&255)/255;a.i=(b&255)/255}
d.sm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,
darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,
hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,
linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,
palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,
violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};d.Zb=function(a,b,c,e){this.n=a||0;this.o=b||0;this.p=c||0;this.K=void 0!==e?e:1};
d.Zb.prototype={n:0,o:0,p:0,K:0,get x(){return this.n},set x(a){this.n=a;this.ua()},get y(){return this.o},set y(a){this.o=a;this.ua()},get z(){return this.p},set z(a){this.p=a;this.ua()},get f(){return this.K},set f(a){this.K=a;this.ua()},set:function(a,b,c,e){this.n=a;this.o=b;this.p=c;this.K=e;this.ua();return this},c:function(a){this.n=a.x;this.o=a.y;this.p=a.z;this.K=a.f;this.ua();return this},zh:function(a){var b=a.elements,c=b[0];a=b[4];var e=b[8],f=b[1],g=b[5],h=b[9],k=b[2],l=b[6],b=b[10],
n=c+g+b;0<n?(c=.5/Math.sqrt(n+1),this.K=.25/c,this.n=(l-h)*c,this.o=(e-k)*c,this.p=(f-a)*c):c>g&&c>b?(c=2*Math.sqrt(1+c-g-b),this.K=(l-h)/c,this.n=.25*c,this.o=(a+f)/c,this.p=(e+k)/c):g>b?(c=2*Math.sqrt(1+g-c-b),this.K=(e-k)/c,this.n=(a+f)/c,this.o=.25*c,this.p=(h+l)/c):(c=2*Math.sqrt(1+b-c-g),this.K=(f-a)/c,this.n=(e+k)/c,this.o=(h+l)/c,this.p=.25*c);this.ua();return this},pa:function(a){return this.n*a.n+this.o*a.o+this.p*a.p+this.K*a.K},Ye:function(){return this.n*this.n+this.o*this.o+this.p*this.p+
this.K*this.K},length:function(){return Math.sqrt(this.n*this.n+this.o*this.o+this.p*this.p+this.K*this.K)},normalize:function(){var a=this.length();0===a?(this.p=this.o=this.n=0,this.K=1):(a=1/a,this.n*=a,this.o*=a,this.p*=a,this.K*=a);this.ua();return this},multiply:function(a,b){return void 0!==b?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),Bb(this,a,b)):Bb(this,this,a)},Ih:function(a,b){var c=this.n,e=this.o,f=this.p,g=
this.K,h=g*a.K+c*a.n+e*a.o+f*a.p;0>h?(this.K=-a.K,this.n=-a.n,this.o=-a.o,this.p=-a.p,h=-h):this.c(a);if(1<=h)return this.K=g,this.n=c,this.o=e,this.p=f,this;var k=Math.acos(h),l=Math.sqrt(1-h*h);if(.001>Math.abs(l))return this.K=.5*(g+this.K),this.n=.5*(c+this.n),this.o=.5*(e+this.o),this.p=.5*(f+this.p),this;h=Math.sin((1-b)*k)/l;k=Math.sin(b*k)/l;this.K=g*h+this.K*k;this.n=c*h+this.n*k;this.o=e*h+this.o*k;this.p=f*h+this.p*k;this.ua();return this},la:function(a){return a.n===this.n&&a.o===this.o&&
a.p===this.p&&a.K===this.K},Fb:function(a){this.n=a[0];this.o=a[1];this.p=a[2];this.K=a[3];this.ua();return this},bj:function(a){this.ua=a;return this},ua:function(){},clone:function(){return new d.Zb(this.n,this.o,this.p,this.K)}};function Bb(a,b,c){var e=b.n,f=b.o,g=b.p;b=b.K;var h=c.n,k=c.o,l=c.p;c=c.K;a.n=e*c+b*h+f*l-g*k;a.o=f*c+b*k+g*h-e*l;a.p=g*c+b*l+e*k-f*h;a.K=b*c-e*h-f*k-g*l;a.ua();return a}d.Zb.Ih=function(a,b,c,e){return c.c(a).Ih(b,e)};d.g=function(a,b){this.x=a||0;this.y=b||0};
d.g.prototype={set:function(a,b){this.x=a;this.y=b;return this},ng:function(a){this.y=a;return this},c:function(a){this.x=a.x;this.y=a.y;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.yc(a,b);this.x+=a.x;this.y+=a.y;return this},yc:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;return this},qd:function(a){this.x+=a;this.y+=a;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.ca(a,b);this.x-=a.x;this.y-=a.y;return this},ca:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;return this},multiply:function(a){this.x*=a.x;this.y*=a.y;return this},G:function(a){this.x*=a;this.y*=a;return this},ud:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a):this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);return this},zc:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&
(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this},he:function(){this.x=-this.x;this.y=-this.y;return this},pa:function(a){return this.x*a.x+this.y*a.y},Ye:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.ud(this.length())},
mb:function(a){return Math.sqrt(this.ce(a))},ce:function(a){var b=this.x-a.x;a=this.y-a.y;return b*b+a*a},Ah:function(a){var b=this.length();0!==b&&a!==b&&this.G(a/b);return this},Ic:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;return this},la:function(a){return a.x===this.x&&a.y===this.y},Fb:function(a){this.x=a[0];this.y=a[1];return this},clone:function(){return new d.g(this.x,this.y)}};d.b=function(a,b,c){this.x=a||0;this.y=b||0;this.z=c||0};
d.b.prototype={set:function(a,b,c){this.x=a;this.y=b;this.z=c;return this},ng:function(a){this.y=a;return this},c:function(a){this.x=a.x;this.y=a.y;this.z=a.z;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.yc(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},qd:function(a){this.x+=a;this.y+=a;this.z+=a;return this},yc:function(a,b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;return this},
sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.ca(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},ca:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;return this},multiply:function(a,b){if(void 0!==b)return console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this;this.x*=a.x;this.y*=
a.y;this.z*=a.z;return this},G:function(a){this.x*=a;this.y*=a;this.z*=a;return this},Q:function(a){var b=this.x,c=this.y,e=this.z;a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12];this.y=a[1]*b+a[5]*c+a[9]*e+a[13];this.z=a[2]*b+a[6]*c+a[10]*e+a[14];return this},ud:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a):this.z=this.y=this.x=0;return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<
a.y&&(this.y=a.y);this.z<a.z&&(this.z=a.z);return this},zc:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);return this},he:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;
return this},pa:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},Ye:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},nl:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.ud(this.length())},Ah:function(a){var b=this.length();0!==b&&a!==b&&this.G(a/b);return this},Ic:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;return this},
mb:function(a){return Math.sqrt(this.ce(a))},ce:function(a){var b=this.x-a.x,c=this.y-a.y;a=this.z-a.z;return b*b+c*c+a*a},la:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z},Fb:function(a){this.x=a[0];this.y=a[1];this.z=a[2];return this},clone:function(){return new d.b(this.x,this.y,this.z)}};function Cb(a,b){a.x=b.elements[12];a.y=b.elements[13];a.z=b.elements[14];return a}function Ib(a,b,c){var e=b.x,f=b.y;b=b.z;var g=c.x,h=c.y;c=c.z;a.x=f*c-b*h;a.y=b*g-e*c;a.z=e*h-f*g;return a}
function Nb(a,b){var c=a.x,e=a.y,f=a.z;a.x=e*b.z-f*b.y;a.y=f*b.x-c*b.z;a.z=c*b.y-e*b.x;return a}function Wb(a,b){var c=a.x,e=a.y,f=a.z,g=b.elements,h=1/(g[3]*c+g[7]*e+g[11]*f+g[15]);a.x=(g[0]*c+g[4]*e+g[8]*f+g[12])*h;a.y=(g[1]*c+g[5]*e+g[9]*f+g[13])*h;a.z=(g[2]*c+g[6]*e+g[10]*f+g[14])*h;return a}function Xb(a,b){var c=a.x,e=a.y,f=a.z,g=b.elements;a.x=g[0]*c+g[3]*e+g[6]*f;a.y=g[1]*c+g[4]*e+g[7]*f;a.z=g[2]*c+g[5]*e+g[8]*f;return a}
d.bc=function(a,b,c,e){this.x=a||0;this.y=b||0;this.z=c||0;this.f=void 0!==e?e:1};
d.bc.prototype={set:function(a,b,c,e){this.x=a;this.y=b;this.z=c;this.f=e;return this},ng:function(a){this.y=a;return this},c:function(a){this.x=a.x;this.y=a.y;this.z=a.z;this.f=void 0!==a.f?a.f:1;return this},add:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.yc(a,b);this.x+=a.x;this.y+=a.y;this.z+=a.z;this.f+=a.f;return this},qd:function(a){this.x+=a;this.y+=a;this.z+=a;this.f+=a;return this},yc:function(a,
b){this.x=a.x+b.x;this.y=a.y+b.y;this.z=a.z+b.z;this.f=a.f+b.f;return this},sub:function(a,b){if(void 0!==b)return console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.ca(a,b);this.x-=a.x;this.y-=a.y;this.z-=a.z;this.f-=a.f;return this},ca:function(a,b){this.x=a.x-b.x;this.y=a.y-b.y;this.z=a.z-b.z;this.f=a.f-b.f;return this},G:function(a){this.x*=a;this.y*=a;this.z*=a;this.f*=a;return this},Q:function(a){var b=this.x,c=this.y,e=this.z,f=this.f;
a=a.elements;this.x=a[0]*b+a[4]*c+a[8]*e+a[12]*f;this.y=a[1]*b+a[5]*c+a[9]*e+a[13]*f;this.z=a[2]*b+a[6]*c+a[10]*e+a[14]*f;this.f=a[3]*b+a[7]*c+a[11]*e+a[15]*f;return this},ud:function(a){0!==a?(a=1/a,this.x*=a,this.y*=a,this.z*=a,this.f*=a):(this.z=this.y=this.x=0,this.f=1);return this},min:function(a){this.x>a.x&&(this.x=a.x);this.y>a.y&&(this.y=a.y);this.z>a.z&&(this.z=a.z);this.f>a.f&&(this.f=a.f);return this},max:function(a){this.x<a.x&&(this.x=a.x);this.y<a.y&&(this.y=a.y);this.z<a.z&&(this.z=
a.z);this.f<a.f&&(this.f=a.f);return this},zc:function(a,b){this.x<a.x?this.x=a.x:this.x>b.x&&(this.x=b.x);this.y<a.y?this.y=a.y:this.y>b.y&&(this.y=b.y);this.z<a.z?this.z=a.z:this.z>b.z&&(this.z=b.z);this.f<a.f?this.f=a.f:this.f>b.f&&(this.f=b.f);return this},floor:function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);this.z=Math.floor(this.z);this.f=Math.floor(this.f);return this},round:function(){this.x=Math.round(this.x);this.y=Math.round(this.y);this.z=Math.round(this.z);this.f=Math.round(this.f);
return this},he:function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;this.f=-this.f;return this},pa:function(a){return this.x*a.x+this.y*a.y+this.z*a.z+this.f*a.f},Ye:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.f*this.f)},nl:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.f)},normalize:function(){return this.ud(this.length())},Ah:function(a){var b=
this.length();0!==b&&a!==b&&this.G(a/b);return this},Ic:function(a,b){this.x+=(a.x-this.x)*b;this.y+=(a.y-this.y)*b;this.z+=(a.z-this.z)*b;this.f+=(a.f-this.f)*b;return this},la:function(a){return a.x===this.x&&a.y===this.y&&a.z===this.z&&a.f===this.f},Fb:function(a){this.x=a[0];this.y=a[1];this.z=a[2];this.f=a[3];return this},clone:function(){return new d.bc(this.x,this.y,this.z,this.f)}};d.hd=function(a,b,c,e){this.n=a||0;this.o=b||0;this.p=c||0;this.jb=e||d.hd.Ij};d.hd.Jq="XYZ YZX ZXY XZY YXZ ZYX".split(" ");
d.hd.Ij="XYZ";
d.hd.prototype={n:0,o:0,p:0,jb:d.hd.Ij,get x(){return this.n},set x(a){this.n=a;this.ua()},get y(){return this.o},set y(a){this.o=a;this.ua()},get z(){return this.p},set z(a){this.p=a;this.ua()},get ke(){return this.jb},set ke(a){this.jb=a;this.ua()},set:function(a,b,c,e){this.n=a;this.o=b;this.p=c;this.jb=e||this.jb;this.ua();return this},c:function(a){this.n=a.n;this.o=a.o;this.p=a.p;this.jb=a.jb;this.ua();return this},zh:function(a,b){var c=d.Math.zc,e=a.elements,f=e[0],g=e[4],h=e[8],k=e[1],l=
e[5],n=e[9],q=e[2],r=e[6],e=e[10];b=b||this.jb;"XYZ"===b?(this.o=Math.asin(c(h,-1,1)),.99999>Math.abs(h)?(this.n=Math.atan2(-n,e),this.p=Math.atan2(-g,f)):(this.n=Math.atan2(r,l),this.p=0)):"YXZ"===b?(this.n=Math.asin(-c(n,-1,1)),.99999>Math.abs(n)?(this.o=Math.atan2(h,e),this.p=Math.atan2(k,l)):(this.o=Math.atan2(-q,f),this.p=0)):"ZXY"===b?(this.n=Math.asin(c(r,-1,1)),.99999>Math.abs(r)?(this.o=Math.atan2(-q,e),this.p=Math.atan2(-g,l)):(this.o=0,this.p=Math.atan2(k,f))):"ZYX"===b?(this.o=Math.asin(-c(q,
-1,1)),.99999>Math.abs(q)?(this.n=Math.atan2(r,e),this.p=Math.atan2(k,f)):(this.n=0,this.p=Math.atan2(-g,l))):"YZX"===b?(this.p=Math.asin(c(k,-1,1)),.99999>Math.abs(k)?(this.n=Math.atan2(-n,l),this.o=Math.atan2(-q,f)):(this.n=0,this.o=Math.atan2(h,e))):"XZY"===b?(this.p=Math.asin(-c(g,-1,1)),.99999>Math.abs(g)?(this.n=Math.atan2(r,l),this.o=Math.atan2(h,f)):(this.n=Math.atan2(-n,e),this.o=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+b);this.jb=b;this.ua();return this},
la:function(a){return a.n===this.n&&a.o===this.o&&a.p===this.p&&a.jb===this.jb},Fb:function(a){this.n=a[0];this.o=a[1];this.p=a[2];void 0!==a[3]&&(this.jb=a[3]);this.ua();return this},bj:function(a){this.ua=a;return this},ua:function(){},clone:function(){return new d.hd(this.n,this.o,this.p,this.jb)}};d.Sj=function(a,b){this.start=void 0!==a?a:new d.b;this.end=void 0!==b?b:new d.b};
d.Sj.prototype={set:function(a,b){this.start.c(a);this.end.c(b);return this},c:function(a){this.start.c(a.start);this.end.c(a.end);return this},ia:function(a){return(a||new d.b).yc(this.start,this.end).G(.5)},Da:function(){return this.start.mb(this.end)},Rk:function(a,b){return(b||new d.b||new d.b).ca(this.end,this.start).G(a).add(this.start)},Q:function(a){this.start.Q(a);this.end.Q(a);return this},la:function(a){return a.start.la(this.start)&&a.end.la(this.end)},clone:function(){return(new d.Sj).c(this)}};
d.jf=function(a,b){this.min=void 0!==a?a:new d.g(Infinity,Infinity);this.max=void 0!==b?b:new d.g(-Infinity,-Infinity)};
d.jf.prototype={set:function(a,b){this.min.c(a);this.max.c(b);return this},Yc:function(a){this.zd();for(var b=0,c=a.length;b<c;b++)this.Nf(a[b]);return this},c:function(a){this.min.c(a.min);this.max.c(a.max);return this},zd:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},ia:function(a){return(a||new d.g).yc(this.min,this.max).G(.5)},size:function(a){return(a||new d.g).ca(this.max,this.min)},
Nf:function(a){this.min.min(a);this.max.max(a);return this},Te:function(a){this.min.qd(-a);this.max.qd(a);return this},Oe:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y?!1:!0},getParameter:function(a,b){return(b||new d.g).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y))},Wf:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y?!1:!0},Re:function(){var a=new d.g;return function(b){return a.c(b).zc(this.min,
this.max).sub(b).length()}}(),hl:function(a){this.min.max(a.min);this.max.min(a.max);return this},em:function(a){this.min.min(a.min);this.max.max(a.max);return this},translate:function(a){this.min.add(a);this.max.add(a);return this},la:function(a){return a.min.la(this.min)&&a.max.la(this.max)},clone:function(){return(new d.jf).c(this)}};d.Wb=function(a,b){this.min=void 0!==a?a:new d.b(Infinity,Infinity,Infinity);this.max=void 0!==b?b:new d.b(-Infinity,-Infinity,-Infinity)};
d.Wb.prototype={set:function(a,b){this.min.c(a);this.max.c(b);return this},Yc:function(a){this.zd();for(var b=0,c=a.length;b<c;b++)this.Nf(a[b]);return this},Bp:function(){var a=new d.b;return function(b){var c=this;b.ra(!0);this.zd();Yb(b,function(b){if(void 0!==b.k&&void 0!==b.k.e)for(var f=b.k.e,g=0,h=f.length;g<h;g++)a.c(f[g]),a.Q(b.m),c.Nf(a)});return this}}(),c:function(a){this.min.c(a.min);this.max.c(a.max);return this},zd:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=
this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},ia:function(a){return(a||new d.b).yc(this.min,this.max).G(.5)},size:function(a){return(a||new d.b).ca(this.max,this.min)},Nf:function(a){this.min.min(a);this.max.max(a);return this},Te:function(a){this.min.qd(-a);this.max.qd(a);return this},Oe:function(a){return a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y||a.z<this.min.z||a.z>this.max.z?!1:!0},getParameter:function(a,
b){return(b||new d.b).set((a.x-this.min.x)/(this.max.x-this.min.x),(a.y-this.min.y)/(this.max.y-this.min.y),(a.z-this.min.z)/(this.max.z-this.min.z))},Wf:function(a){return a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y||a.max.z<this.min.z||a.min.z>this.max.z?!1:!0},Re:function(){var a=new d.b;return function(b){return a.c(b).zc(this.min,this.max).sub(b).length()}}(),hl:function(a){this.min.max(a.min);this.max.min(a.max);return this},em:function(a){this.min.min(a.min);
this.max.max(a.max);return this},Q:function(){var a=[new d.b,new d.b,new d.b,new d.b,new d.b,new d.b,new d.b,new d.b];return function(b){a[0].set(this.min.x,this.min.y,this.min.z).Q(b);a[1].set(this.min.x,this.min.y,this.max.z).Q(b);a[2].set(this.min.x,this.max.y,this.min.z).Q(b);a[3].set(this.min.x,this.max.y,this.max.z).Q(b);a[4].set(this.max.x,this.min.y,this.min.z).Q(b);a[5].set(this.max.x,this.min.y,this.max.z).Q(b);a[6].set(this.max.x,this.max.y,this.min.z).Q(b);a[7].set(this.max.x,this.max.y,
this.max.z).Q(b);this.zd();this.Yc(a);return this}}(),translate:function(a){this.min.add(a);this.max.add(a);return this},la:function(a){return a.min.la(this.min)&&a.max.la(this.max)},clone:function(){return(new d.Wb).c(this)}};d.Nb=function(a,b,c,e,f,g,h,k,l){var n=this.elements=new Float32Array(9);n[0]=void 0!==a?a:1;n[3]=b||0;n[6]=c||0;n[1]=e||0;n[4]=void 0!==f?f:1;n[7]=g||0;n[2]=h||0;n[5]=k||0;n[8]=void 0!==l?l:1};
d.Nb.prototype={set:function(a,b,c,e,f,g,h,k,l){var n=this.elements;n[0]=a;n[3]=b;n[6]=c;n[1]=e;n[4]=f;n[7]=g;n[2]=h;n[5]=k;n[8]=l;return this},Vi:function(){this.set(1,0,0,0,1,0,0,0,1);return this},c:function(a){a=a.elements;this.set(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]);return this},xi:function(){var a=new d.b;return function(b,c,e){void 0===c&&(c=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],Xb(a,this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),G:function(a){var b=
this.elements;b[0]*=a;b[3]*=a;b[6]*=a;b[1]*=a;b[4]*=a;b[7]*=a;b[2]*=a;b[5]*=a;b[8]*=a;return this},Wk:function(){var a=this.elements,b=a[0],c=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],l=a[7],a=a[8];return b*g*a-b*h*l-c*f*a+c*h*k+e*f*l-e*g*k},Gb:function(a,b){var c=a.elements,e=this.elements;e[0]=c[10]*c[5]-c[6]*c[9];e[1]=-c[10]*c[1]+c[2]*c[9];e[2]=c[6]*c[1]-c[2]*c[5];e[3]=-c[10]*c[4]+c[6]*c[8];e[4]=c[10]*c[0]-c[2]*c[8];e[5]=-c[6]*c[0]+c[2]*c[4];e[6]=c[9]*c[4]-c[5]*c[8];e[7]=-c[9]*c[0]+c[1]*c[8];e[8]=
c[5]*c[0]-c[1]*c[4];c=c[0]*e[0]+c[1]*e[3]+c[2]*e[6];if(0===c){if(b)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.Vi();return this}this.G(1/c);return this},xj:function(){var a,b=this.elements;a=b[1];b[1]=b[3];b[3]=a;a=b[2];b[2]=b[6];b[6]=a;a=b[5];b[5]=b[7];b[7]=a;return this},fh:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];
a[b+7]=c[7];a[b+8]=c[8];return a},Fb:function(a){this.elements.set(a);return this},clone:function(){var a=this.elements;return new d.Nb(a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8])}};function bc(a,b){a.Gb(b).xj();return a}
d.S=function(a,b,c,e,f,g,h,k,l,n,q,r,s,u,w,v){var y=this.elements=new Float32Array(16);y[0]=void 0!==a?a:1;y[4]=b||0;y[8]=c||0;y[12]=e||0;y[1]=f||0;y[5]=void 0!==g?g:1;y[9]=h||0;y[13]=k||0;y[2]=l||0;y[6]=n||0;y[10]=void 0!==q?q:1;y[14]=r||0;y[3]=s||0;y[7]=u||0;y[11]=w||0;y[15]=void 0!==v?v:1};
d.S.prototype={set:function(a,b,c,e,f,g,h,k,l,n,q,r,s,u,w,v){var y=this.elements;y[0]=a;y[4]=b;y[8]=c;y[12]=e;y[1]=f;y[5]=g;y[9]=h;y[13]=k;y[2]=l;y[6]=n;y[10]=q;y[14]=r;y[3]=s;y[7]=u;y[11]=w;y[15]=v;return this},Vi:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},c:function(a){this.elements.set(a.elements);return this},gb:function(){var a=new d.b,b=new d.b,c=new d.b;return function(e,f,g){var h=this.elements;c.ca(e,f).normalize();0===c.length()&&(c.z=1);Ib(a,g,c).normalize();0===
a.length()&&(c.x+=1E-4,Ib(a,g,c).normalize());Ib(b,c,a);h[0]=a.x;h[4]=b.x;h[8]=c.x;h[1]=a.y;h[5]=b.y;h[9]=c.y;h[2]=a.z;h[6]=b.z;h[10]=c.z;return this}}(),multiply:function(a,b){return void 0!==b?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),cc(this,a,b)):cc(this,this,a)},G:function(a){var b=this.elements;b[0]*=a;b[4]*=a;b[8]*=a;b[12]*=a;b[1]*=a;b[5]*=a;b[9]*=a;b[13]*=a;b[2]*=a;b[6]*=a;b[10]*=a;b[14]*=a;b[3]*=a;b[7]*=a;b[11]*=a;b[15]*=
a;return this},xi:function(){var a=new d.b;return function(b,c,e){void 0===c&&(c=0);void 0===e&&(e=b.length);for(var f=0;f<e;f+=3,c+=3)a.x=b[c],a.y=b[c+1],a.z=b[c+2],a.Q(this),b[c]=a.x,b[c+1]=a.y,b[c+2]=a.z;return b}}(),Wk:function(){var a=this.elements,b=a[0],c=a[4],e=a[8],f=a[12],g=a[1],h=a[5],k=a[9],l=a[13],n=a[2],q=a[6],r=a[10],s=a[14];return a[3]*(+f*k*q-e*l*q-f*h*r+c*l*r+e*h*s-c*k*s)+a[7]*(+b*k*s-b*l*r+f*g*r-e*g*s+e*l*n-f*k*n)+a[11]*(+b*l*q-b*h*s-f*g*q+c*g*s+f*h*n-c*l*n)+a[15]*(-e*h*n-b*k*q+
b*h*r+e*g*q-c*g*r+c*k*n)},xj:function(){var a=this.elements,b;b=a[1];a[1]=a[4];a[4]=b;b=a[2];a[2]=a[8];a[8]=b;b=a[6];a[6]=a[9];a[9]=b;b=a[3];a[3]=a[12];a[12]=b;b=a[7];a[7]=a[13];a[13]=b;b=a[11];a[11]=a[14];a[14]=b;return this},fh:function(a,b){var c=this.elements;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];a[b+4]=c[4];a[b+5]=c[5];a[b+6]=c[6];a[b+7]=c[7];a[b+8]=c[8];a[b+9]=c[9];a[b+10]=c[10];a[b+11]=c[11];a[b+12]=c[12];a[b+13]=c[13];a[b+14]=c[14];a[b+15]=c[15];return a},Gb:function(a,b){var c=this.elements,
e=a.elements,f=e[0],g=e[4],h=e[8],k=e[12],l=e[1],n=e[5],q=e[9],r=e[13],s=e[2],u=e[6],w=e[10],v=e[14],y=e[3],z=e[7],x=e[11],e=e[15];c[0]=q*v*z-r*w*z+r*u*x-n*v*x-q*u*e+n*w*e;c[4]=k*w*z-h*v*z-k*u*x+g*v*x+h*u*e-g*w*e;c[8]=h*r*z-k*q*z+k*n*x-g*r*x-h*n*e+g*q*e;c[12]=k*q*u-h*r*u-k*n*w+g*r*w+h*n*v-g*q*v;c[1]=r*w*y-q*v*y-r*s*x+l*v*x+q*s*e-l*w*e;c[5]=h*v*y-k*w*y+k*s*x-f*v*x-h*s*e+f*w*e;c[9]=k*q*y-h*r*y-k*l*x+f*r*x+h*l*e-f*q*e;c[13]=h*r*s-k*q*s+k*l*w-f*r*w-h*l*v+f*q*v;c[2]=n*v*y-r*u*y+r*s*z-l*v*z-n*s*e+l*u*e;
c[6]=k*u*y-g*v*y-k*s*z+f*v*z+g*s*e-f*u*e;c[10]=g*r*y-k*n*y+k*l*z-f*r*z-g*l*e+f*n*e;c[14]=k*n*s-g*r*s-k*l*u+f*r*u+g*l*v-f*n*v;c[3]=q*u*y-n*w*y-q*s*z+l*w*z+n*s*x-l*u*x;c[7]=g*w*y-h*u*y+h*s*z-f*w*z-g*s*x+f*u*x;c[11]=h*n*y-g*q*y-h*l*z+f*q*z+g*l*x-f*n*x;c[15]=g*q*s-h*n*s+h*l*u-f*q*u-g*l*w+f*n*w;c=f*c[0]+l*c[4]+s*c[8]+y*c[12];if(0==c){if(b)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.Vi();return this}this.G(1/
c);return this},translate:function(){console.warn("THREE.Matrix4: .translate() has been removed.")},scale:function(a){var b=this.elements,c=a.x,e=a.y;a=a.z;b[0]*=c;b[4]*=e;b[8]*=a;b[1]*=c;b[5]*=e;b[9]*=a;b[2]*=c;b[6]*=e;b[10]*=a;b[3]*=c;b[7]*=e;b[11]*=a;return this},bh:function(){var a=new d.b,b=new d.S;return function(c,e,f){var g=this.elements,h=a.set(g[0],g[1],g[2]).length(),k=a.set(g[4],g[5],g[6]).length(),l=a.set(g[8],g[9],g[10]).length();0>this.Wk()&&(h=-h);c.x=g[12];c.y=g[13];c.z=g[14];b.elements.set(this.elements);
c=1/h;var g=1/k,n=1/l;b.elements[0]*=c;b.elements[1]*=c;b.elements[2]*=c;b.elements[4]*=g;b.elements[5]*=g;b.elements[6]*=g;b.elements[8]*=n;b.elements[9]*=n;b.elements[10]*=n;e.zh(b);f.x=h;f.y=k;f.z=l;return this}}(),Fb:function(a){this.elements.set(a);return this},clone:function(){var a=this.elements;return new d.S(a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15])}};
function dc(a,b,c,e,f,g,h){a=a.elements;a[0]=2*g/(c-b);a[4]=0;a[8]=(c+b)/(c-b);a[12]=0;a[1]=0;a[5]=2*g/(f-e);a[9]=(f+e)/(f-e);a[13]=0;a[2]=0;a[6]=0;a[10]=-(h+g)/(h-g);a[14]=-2*h*g/(h-g);a[3]=0;a[7]=0;a[11]=-1;a[15]=0}
function qc(a,b,c,e){var f=a.elements,g=c.x,h=c.y,k=c.z,l=c.f,n=g+g,q=h+h,r=k+k;c=g*n;var s=g*q,g=g*r,u=h*q,h=h*r,k=k*r,n=l*n,q=l*q,l=l*r;f[0]=1-(u+k);f[4]=s-l;f[8]=g+q;f[1]=s+l;f[5]=1-(c+k);f[9]=h-n;f[2]=g-q;f[6]=h+n;f[10]=1-(c+u);f[3]=0;f[7]=0;f[11]=0;f[12]=0;f[13]=0;f[14]=0;f[15]=1;a.scale(e);a=a.elements;a[12]=b.x;a[13]=b.y;a[14]=b.z}
function rc(a,b,c){var e=Math.cos(c);c=Math.sin(c);var f=1-e,g=b.x,h=b.y;b=b.z;var k=f*g,l=f*h;a.set(k*g+e,k*h-c*b,k*b+c*h,0,k*h+c*b,l*h+e,l*b-c*g,0,k*b-c*h,l*b+c*g,f*b*b+e,0,0,0,0,1);return a}function sc(){var a=new d.S,b=-Math.PI/2,c=Math.cos(b),b=Math.sin(b);a.set(1,0,0,0,0,c,-b,0,0,b,c,0,0,0,0,1);return a}function tc(a,b,c,e){a.set(1,0,0,b,0,1,0,c,0,0,1,e,0,0,0,1);return a}
function cc(a,b,c){var e=b.elements,f=c.elements;c=a.elements;b=e[0];var g=e[4],h=e[8],k=e[12],l=e[1],n=e[5],q=e[9],r=e[13],s=e[2],u=e[6],w=e[10],v=e[14],y=e[3],z=e[7],x=e[11],e=e[15],C=f[0],E=f[4],A=f[8],H=f[12],B=f[1],D=f[5],F=f[9],L=f[13],M=f[2],ea=f[6],T=f[10],Q=f[14],P=f[3],G=f[7],K=f[11],f=f[15];c[0]=b*C+g*B+h*M+k*P;c[4]=b*E+g*D+h*ea+k*G;c[8]=b*A+g*F+h*T+k*K;c[12]=b*H+g*L+h*Q+k*f;c[1]=l*C+n*B+q*M+r*P;c[5]=l*E+n*D+q*ea+r*G;c[9]=l*A+n*F+q*T+r*K;c[13]=l*H+n*L+q*Q+r*f;c[2]=s*C+u*B+w*M+v*P;c[6]=
s*E+u*D+w*ea+v*G;c[10]=s*A+u*F+w*T+v*K;c[14]=s*H+u*L+w*Q+v*f;c[3]=y*C+z*B+x*M+e*P;c[7]=y*E+z*D+x*ea+e*G;c[11]=y*A+z*F+x*T+e*K;c[15]=y*H+z*L+x*Q+e*f;return a}d.ji=function(a,b){this.origin=void 0!==a?a:new d.b;this.direction=void 0!==b?b:new d.b};
d.ji.prototype={set:function(a,b){this.origin.c(a);this.direction.c(b);return this},c:function(a){this.origin.c(a.origin);this.direction.c(a.direction);return this},Rk:function(a,b){return(b||new d.b).c(this.direction).G(a).add(this.origin)},Re:function(){var a=new d.b;return function(b){var c=a.ca(b,this.origin).pa(this.direction);if(0>c)return this.origin.mb(b);a.c(this.direction).G(c).add(this.origin);return a.mb(b)}}(),Wf:function(){var a=new d.b;return function(b){var c;var e,f,g;e=1/this.direction.x;
g=1/this.direction.y;var h=1/this.direction.z,k=this.origin;0<=e?(c=(b.min.x-k.x)*e,e*=b.max.x-k.x):(c=(b.max.x-k.x)*e,e*=b.min.x-k.x);0<=g?(f=(b.min.y-k.y)*g,g*=b.max.y-k.y):(f=(b.max.y-k.y)*g,g*=b.min.y-k.y);if(c>g||f>e)c=null;else{if(f>c||c!==c)c=f;if(g<e||e!==e)e=g;0<=h?(f=(b.min.z-k.z)*h,b=(b.max.z-k.z)*h):(f=(b.max.z-k.z)*h,b=(b.min.z-k.z)*h);if(c>b||f>e)c=null;else{if(f>c||c!==c)c=f;if(b<e||e!==e)e=b;c=0>e?null:this.Rk(0<=c?c:e,a)}}return null!==c}}(),Q:function(a){this.direction.add(this.origin).Q(a);
this.origin.Q(a);this.direction.sub(this.origin);this.direction.normalize();return this},la:function(a){return a.origin.la(this.origin)&&a.direction.la(this.direction)},clone:function(){return(new d.ji).c(this)}};d.$b=function(a,b){this.ia=void 0!==a?a:new d.b;this.ea=void 0!==b?b:0};
d.$b.prototype={set:function(a,b){this.ia.c(a);this.ea=b;return this},Yc:function(){var a=new d.Wb;return function(b,c){var e=this.ia;void 0!==c?e.c(c):a.Yc(b).ia(e);for(var f=0,g=0,h=b.length;g<h;g++)f=Math.max(f,e.ce(b[g]));this.ea=Math.sqrt(f);return this}}(),c:function(a){this.ia.c(a.ia);this.ea=a.ea;return this},empty:function(){return 0>=this.ea},Oe:function(a){return a.ce(this.ia)<=this.ea*this.ea},Re:function(a){return a.mb(this.ia)-this.ea},il:function(a){var b=this.ea+a.ea;return a.ia.ce(this.ia)<=
b*b},el:function(a){a=a||new d.Wb;a.set(this.ia,this.ia);a.Te(this.ea);return a},Q:function(a){this.ia.Q(a);var b=this.ea;a=a.elements;a=Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1]+a[2]*a[2],Math.max(a[4]*a[4]+a[5]*a[5]+a[6]*a[6],a[8]*a[8]+a[9]*a[9]+a[10]*a[10])));this.ea=b*a;return this},translate:function(a){this.ia.add(a);return this},la:function(a){return a.ia.la(this.ia)&&a.ea===this.ea},clone:function(){return(new d.$b).c(this)}};
d.we=function(a,b,c,e,f,g){this.bf=[void 0!==a?a:new d.kd,void 0!==b?b:new d.kd,void 0!==c?c:new d.kd,void 0!==e?e:new d.kd,void 0!==f?f:new d.kd,void 0!==g?g:new d.kd]};
d.we.prototype={set:function(a,b,c,e,f,g){var h=this.bf;h[0].c(a);h[1].c(b);h[2].c(c);h[3].c(e);h[4].c(f);h[5].c(g);return this},c:function(a){for(var b=this.bf,c=0;6>c;c++)b[c].c(a.bf[c]);return this},lh:function(){var a=new d.$b;return function(b){var c=b.k;null===c.Ra&&c.Ne();a.c(c.Ra);a.Q(b.m);return this.il(a)}}(),il:function(a){var b=this.bf,c=a.ia;a=-a.ea;for(var e=0;6>e;e++)if(b[e].Re(c)<a)return!1;return!0},Oe:function(a){for(var b=this.bf,c=0;6>c;c++)if(0>b[c].Re(a))return!1;return!0},clone:function(){return(new d.we).c(this)}};
function uc(a,b){var c=a.bf,e=b.elements,f=e[0],g=e[1],h=e[2],k=e[3],l=e[4],n=e[5],q=e[6],r=e[7],s=e[8],u=e[9],w=e[10],v=e[11],y=e[12],z=e[13],x=e[14],e=e[15];Kc(c[0],k-f,r-l,v-s,e-y).normalize();Kc(c[1],k+f,r+l,v+s,e+y).normalize();Kc(c[2],k+g,r+n,v+u,e+z).normalize();Kc(c[3],k-g,r-n,v-u,e-z).normalize();Kc(c[4],k-h,r-q,v-w,e-x).normalize();Kc(c[5],k+h,r+q,v+w,e+x).normalize()}d.kd=function(a,b){this.F=void 0!==a?a:new d.b(1,0,0);this.lb=void 0!==b?b:0};
d.kd.prototype={set:function(a,b){this.F.c(a);this.lb=b;return this},c:function(a){this.F.c(a.F);this.lb=a.lb;return this},normalize:function(){var a=1/this.F.length();this.F.G(a);this.lb*=a;return this},he:function(){this.lb*=-1;this.F.he();return this},Re:function(a){return this.F.pa(a)+this.lb},Q:function(){var a=new d.b,b=new d.b,c=new d.Nb;return function(e,f){var g=f||bc(c,e),g=Xb(a.c(this.F),g),h=(b||new d.b).c(this.F).G(-this.lb);h.Q(e);this.F.c(g);this.lb=-h.pa(this.F);return this}}(),translate:function(a){this.lb-=
a.pa(this.F);return this},la:function(a){return a.F.la(this.F)&&a.lb==this.lb},clone:function(){return(new d.kd).c(this)}};function Kc(a,b,c,e,f){a.F.set(b,c,e);a.lb=f;return a}
d.Math={Pf:function(){var a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),b=Array(36),c=0,e;return function(){for(var f=0;36>f;f++)8==f||13==f||18==f||23==f?b[f]="-":14==f?b[f]="4":(2>=c&&(c=33554432+16777216*Math.random()|0),e=c&15,c>>=4,b[f]=a[19==f?e&3|8:e]);return b.join("")}}(),zc:function(a,b,c){return a<b?b:a>c?c:a},$q:function(a,b){return a<b?b:a},Tr:function(a,b,c,e,f){return e+(a-b)*(f-e)/(c-b)},Hp:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-
b);return a*a*(3-2*a)},Cs:function(a,b,c){if(a<=b)return 0;if(a>=c)return 1;a=(a-b)/(c-b);return a*a*a*(a*(6*a-15)+10)},ws:function(){return(65280*Math.random()+255*Math.random())/65535},vs:function(a,b){return a+Math.floor(Math.random()*(b-a+1))},ts:function(a,b){return a+Math.random()*(b-a)},us:function(a){return a*(.5-Math.random())},Gp:function(a){return 0>a?-1:0<a?1:0},Vk:function(){var a=Math.PI/180;return function(b){return b*a}}(),qs:function(){var a=180/Math.PI;return function(b){return b*
a}}(),yd:function(a){return 0===(a&a-1)&&0!==a}};
d.Lq=function(a){function b(a,b,c,e,f,g,h){a=.5*(c-a);e=.5*(e-b);return(2*(b-c)+a+e)*h+(-3*(b-c)-2*a-e)*g+a*f+b}this.ma=a;var c=[],e={x:0,y:0,z:0},f,g,h,k,l,n,q,r,s;this.ya=function(a){f=(this.ma.length-1)*a;g=Math.floor(f);h=f-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.ma.length-2?this.ma.length-1:g+1;c[3]=g>this.ma.length-3?this.ma.length-1:g+2;n=this.ma[c[0]];q=this.ma[c[1]];r=this.ma[c[2]];s=this.ma[c[3]];k=h*h;l=h*k;e.x=b(n.x,q.x,r.x,s.x,h,k,l);e.y=b(n.y,q.y,r.y,s.y,h,k,l);e.z=b(n.z,q.z,r.z,s.z,h,
k,l);return e};this.Qf=function(a){var b,c,e,f=b=b=0,g=new d.b,h=new d.b,k=[],l=0;k[0]=0;a||(a=100);c=this.ma.length*a;g.c(this.ma[0]);for(a=1;a<c;a++)b=a/c,e=this.ya(b),h.c(e),l+=h.mb(g),g.c(e),b*=this.ma.length-1,b=Math.floor(b),b!=f&&(k[b]=l,f=b);k[k.length]=l;return{Zq:k,total:l}}};d.Qc=function(a,b,c){this.N=void 0!==a?a:new d.b;this.i=void 0!==b?b:new d.b;this.O=void 0!==c?c:new d.b};
d.Qc.F=function(){var a=new d.b;return function(b,c,e,f){f=f||new d.b;f.ca(e,c);a.ca(b,c);Nb(f,a);b=f.Ye();return 0<b?f.G(1/Math.sqrt(b)):f.set(0,0,0)}}();d.Qc.zi=function(){var a=new d.b,b=new d.b,c=new d.b;return function(e,f,g,h,k){a.ca(h,f);b.ca(g,f);c.ca(e,f);e=a.pa(a);f=a.pa(b);g=a.pa(c);var l=b.pa(b);h=b.pa(c);var n=e*l-f*f;k=k||new d.b;if(0==n)return k.set(-2,-1,-1);n=1/n;l=(l*g-f*h)*n;e=(e*h-f*g)*n;return k.set(1-l-e,e,l)}}();
d.Qc.Oe=function(){var a=new d.b;return function(b,c,e,f){b=d.Qc.zi(b,c,e,f,a);return 0<=b.x&&0<=b.y&&1>=b.x+b.y}}();
d.Qc.prototype={set:function(a,b,c){this.N.c(a);this.i.c(b);this.O.c(c);return this},c:function(a){this.N.c(a.N);this.i.c(a.i);this.O.c(a.O);return this},Qk:function(){var a=new d.b,b=new d.b;return function(){a.ca(this.O,this.i);b.ca(this.N,this.i);return.5*Nb(a,b).length()}}(),F:function(a){return d.Qc.F(this.N,this.i,this.O,a)},zi:function(a,b){return d.Qc.zi(a,this.N,this.i,this.O,b)},Oe:function(a){return d.Qc.Oe(a,this.N,this.i,this.O)},la:function(a){return a.N.la(this.N)&&a.i.la(this.i)&&
a.O.la(this.O)},clone:function(){return(new d.Qc).c(this)}};d.rm=function(a){this.Xn=void 0!==a?a:!0;this.elapsedTime=this.aj=this.startTime=0;this.yh=!1};
d.rm.prototype={start:function(){this.aj=this.startTime=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now();this.yh=!0},stop:function(){var a=0;this.Xn&&!this.yh&&this.start();if(this.yh){var b=void 0!==self.performance&&void 0!==self.performance.now?self.performance.now():Date.now(),a=.001*(b-this.aj);this.aj=b;this.elapsedTime+=a}this.yh=!1}};d.Xb=function(){};
d.Xb.prototype={apply:function(a){a.addEventListener=d.Xb.prototype.addEventListener;a.kh=d.Xb.prototype.kh;a.removeEventListener=d.Xb.prototype.removeEventListener;a.dispatchEvent=d.Xb.prototype.dispatchEvent},addEventListener:function(a,b){void 0===this.od&&(this.od={});var c=this.od;void 0===c[a]&&(c[a]=[]);-1===c[a].indexOf(b)&&c[a].push(b)},kh:function(a,b){if(void 0===this.od)return!1;var c=this.od;return void 0!==c[a]&&-1!==c[a].indexOf(b)?!0:!1},removeEventListener:function(a,b){if(void 0!==
this.od){var c=this.od[a];if(void 0!==c){var e=c.indexOf(b);-1!==e&&c.splice(e,1)}}},dispatchEvent:function(a){if(void 0!==this.od){var b=this.od[a.type];if(void 0!==b){a.target=this;for(var c=[],e=b.length,f=0;f<e;f++)c[f]=b[f];for(f=0;f<e;f++)c[f].call(this,a)}}}};(function(a){a.dn=function(b,c,e,f){this.xp=new a.ji(b,c);this.Xa=e||0;this.Ta=f||Infinity};a.dn.prototype={precision:1E-4,set:function(a,c){this.xp.set(a,c)}}})(d);
d.A=function(){this.id=d.Sm++;this.Tb=d.Math.Pf();this.name="";this.parent=void 0;this.children=[];this.mc=d.A.zm.clone();var a=new d.b,b=new d.hd,c=new d.Zb,e=new d.b(1,1,1);b.bj(function(){if(!1===b instanceof d.hd)throw Error("THREE.Quaternion: .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var a=Math.cos(b.n/2),e=Math.cos(b.o/2),h=Math.cos(b.p/2),k=Math.sin(b.n/2),l=Math.sin(b.o/2),n=Math.sin(b.p/2);"XYZ"===b.ke?(c.n=k*e*h+a*l*n,c.o=a*l*h-k*e*n,c.p=a*e*n+k*l*h,
c.K=a*e*h-k*l*n):"YXZ"===b.ke?(c.n=k*e*h+a*l*n,c.o=a*l*h-k*e*n,c.p=a*e*n-k*l*h,c.K=a*e*h+k*l*n):"ZXY"===b.ke?(c.n=k*e*h-a*l*n,c.o=a*l*h+k*e*n,c.p=a*e*n+k*l*h,c.K=a*e*h-k*l*n):"ZYX"===b.ke?(c.n=k*e*h-a*l*n,c.o=a*l*h+k*e*n,c.p=a*e*n-k*l*h,c.K=a*e*h+k*l*n):"YZX"===b.ke?(c.n=k*e*h+a*l*n,c.o=a*l*h+k*e*n,c.p=a*e*n-k*l*h,c.K=a*e*h-k*l*n):"XZY"===b.ke&&(c.n=k*e*h-a*l*n,c.o=a*l*h-k*e*n,c.p=a*e*n+k*l*h,c.K=a*e*h+k*l*n)});c.bj(function(){var a,e=d.Math.zc,h=c.x*c.x,k=c.y*c.y,l=c.z*c.z,n=c.f*c.f;a=b.jb;"XYZ"===
a?(b.n=Math.atan2(2*(c.x*c.f-c.y*c.z),n-h-k+l),b.o=Math.asin(e(2*(c.x*c.z+c.y*c.f),-1,1)),b.p=Math.atan2(2*(c.z*c.f-c.x*c.y),n+h-k-l)):"YXZ"===a?(b.n=Math.asin(e(2*(c.x*c.f-c.y*c.z),-1,1)),b.o=Math.atan2(2*(c.x*c.z+c.y*c.f),n-h-k+l),b.p=Math.atan2(2*(c.x*c.y+c.z*c.f),n-h+k-l)):"ZXY"===a?(b.n=Math.asin(e(2*(c.x*c.f+c.y*c.z),-1,1)),b.o=Math.atan2(2*(c.y*c.f-c.z*c.x),n-h-k+l),b.p=Math.atan2(2*(c.z*c.f-c.x*c.y),n-h+k-l)):"ZYX"===a?(b.n=Math.atan2(2*(c.x*c.f+c.z*c.y),n-h-k+l),b.o=Math.asin(e(2*(c.y*c.f-
c.x*c.z),-1,1)),b.p=Math.atan2(2*(c.x*c.y+c.z*c.f),n+h-k-l)):"YZX"===a?(b.n=Math.atan2(2*(c.x*c.f-c.z*c.y),n-h+k-l),b.o=Math.atan2(2*(c.y*c.f-c.x*c.z),n+h-k-l),b.p=Math.asin(e(2*(c.x*c.y+c.z*c.f),-1,1))):"XZY"===a?(b.n=Math.atan2(2*(c.x*c.f+c.y*c.z),n-h+k-l),b.o=Math.atan2(2*(c.x*c.z+c.y*c.f),n+h-k-l),b.p=Math.asin(e(2*(c.z*c.f-c.x*c.y),-1,1))):console.warn("THREE.Euler: .setFromQuaternion() given unsupported order: "+a);b.jb=a});Object.defineProperties(this,{position:{enumerable:!0,value:a},rotation:{enumerable:!0,
value:b},cb:{enumerable:!0,value:c},scale:{enumerable:!0,value:e}});this.df=null;this.Pl=!0;this.da=new d.S;this.m=new d.S;this.oa=!0;this.ic=!1;this.visible=!0;this.xh=this.tb=!1;this.Ve=!0;this.xg={}};d.A.zm=new d.b(0,1,0);
d.A.prototype={Tc:function(a){cc(this.da,a,this.da);this.da.bh(this.position,this.cb,this.scale)},Vp:function(){var a=new d.b;return function(b,c){var e=a.c(b),f=this.cb,g=e.x,h=e.y,k=e.z,l=f.x,n=f.y,q=f.z,f=f.f,r=f*g+n*k-q*h,s=f*h+q*g-l*k,u=f*k+l*h-n*g,g=-l*g-n*h-q*k;e.x=r*f+g*-l+s*-q-u*-n;e.y=s*f+g*-n+u*-l-r*-q;e.z=u*f+g*-q+r*-n-s*-l;this.position.add(a.G(c));return this}}(),translate:function(a,b){console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead.");
return this.Vp(b,a)},gb:function(){var a=new d.S;return function(b){a.gb(b,this.position,this.mc);this.cb.zh(a)}}(),add:function(a){if(1<arguments.length){for(var b=0;b<arguments.length;b++)this.add(arguments[b]);return this}if(a===this)return console.error("THREE.Object3D.add:",a,"can't be added as a child of itself."),this;if(a instanceof d.A){void 0!==a.parent&&a.parent.remove(a);a.parent=this;a.dispatchEvent({type:"added"});this.children.push(a);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==
b&&b instanceof d.Pd&&Lc(b,a)}else console.error("THREE.Object3D.add:",a,"is not an instance of THREE.Object3D.");return this},remove:function(a){if(1<arguments.length)for(var b=0;b<arguments.length;b++)this.remove(arguments[b]);b=this.children.indexOf(a);if(-1!==b){a.parent=void 0;a.dispatchEvent({type:"removed"});this.children.splice(b,1);for(b=this;void 0!==b.parent;)b=b.parent;void 0!==b&&b instanceof d.Pd&&Mc(b,a)}},Dd:function(){qc(this.da,this.position,this.cb,this.scale);this.ic=!0},ra:function(a){!0===
this.oa&&this.Dd();if(!0===this.ic||!0===a)void 0===this.parent?this.m.c(this.da):cc(this.m,this.parent.m,this.da),this.ic=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].ra(a)},clone:function(a,b){void 0===a&&(a=new d.A);void 0===b&&(b=!0);a.name=this.name;a.mc.c(this.mc);a.position.c(this.position);a.cb.c(this.cb);a.scale.c(this.scale);a.df=this.df;a.Pl=this.Pl;a.da.c(this.da);a.m.c(this.m);a.oa=this.oa;a.ic=this.ic;a.visible=this.visible;a.tb=this.tb;a.xh=this.xh;a.Ve=this.Ve;
a.xg=JSON.parse(JSON.stringify(this.xg));if(!0===b)for(var c=0;c<this.children.length;c++)a.add(this.children[c].clone());return a}};function Nc(a,b){if(!1!==a.visible){b(a);for(var c=0,e=a.children.length;c<e;c++)Nc(a.children[c],b)}}function Yb(a,b){b(a);for(var c=0,e=a.children.length;c<e;c++)Yb(a.children[c],b)}d.Xb.prototype.apply(d.A.prototype);d.Sm=0;
d.hi=function(){function a(){if(r===u){var a=new d.Od;s.push(a);u++;r++;return a}return s[r++]}function b(){if(v===z){var a=new d.fk;y.push(a);z++;v++;return a}return y[v++]}function c(){if(C===A){var a=new d.gk;E.push(a);A++;C++;return a}return E[C++]}function e(){if(B===F){var a=new d.hk;D.push(a);F++;B++;return a}return D[B++]}function f(a,b){return a.z!==b.z?b.z-a.z:a.id!==b.id?a.id-b.id:0}function g(a,b){var c=0,e=1,f=a.z+a.f,g=b.z+b.f,h=-a.z+a.f,k=-b.z+b.f;if(0<=f&&0<=g&&0<=h&&0<=k)return!0;
if(0>f&&0>g||0>h&&0>k)return!1;0>f?c=Math.max(c,f/(f-g)):0>g&&(e=Math.min(e,f/(f-g)));0>h?c=Math.max(c,h/(h-k)):0>k&&(e=Math.min(e,h/(h-k)));if(e<c)return!1;a.Ic(b,c);b.Ic(a,1-e);return!0}var h,k,l=[],n=0,q,r,s=[],u=0,w,v,y=[],z=0,x,C,E=[],A=0,H,B,D=[],F=0,L={La:[],Wc:[],elements:[]},M=new d.b,ea=new d.b,T=new d.b,Q=new d.b,P=new d.bc,G=new d.Wb(new d.b(-1,-1,-1),new d.b(1,1,1)),K=new d.Wb,J=Array(3),ba=new d.S,R=new d.S,V,U=new d.S,ca=new d.Nb,S=new d.we,Y=new d.bc,da=new d.bc;this.fm=function(){var a=
new d.S;return function(b,c){a.Gb(c.za);cc(R,c.m,a);return Wb(b,R)}}();var aa=new function(){function e(a,b,c){return 0>(c.l.x-a.l.x)*(b.l.y-a.l.y)-(c.l.y-a.l.y)*(b.l.x-a.l.x)}function f(a,b,c){if(!0===a.visible||!0===b.visible||!0===c.visible)return!0;J[0]=a.l;J[1]=b.l;J[2]=c.l;return G.Wf(K.Yc(J))}function g(a){var b=a.cf,c=a.l;b.c(a.position).Q(V);c.c(b).Q(R);b=1/c.f;c.x*=b;c.y*=b;c.z*=b;a.visible=-1<=c.x&&1>=c.x&&-1<=c.y&&1>=c.y&&-1<=c.z&&1>=c.z}var h=[],k=[],l=null,n=null,r=new d.Nb;return{Cp:function(a){l=
a;n=l.r;bc(r,l.m);h.length=0;k.length=0},fj:g,ko:f,jo:e,hj:function(b,c,e){q=a();q.position.set(b,c,e);g(q)},up:function(a,b,c){h.push(a,b,c)},vp:function(a,b){k.push(a,b)},Jl:function(a,b){var e=s[a],f=s[b];x=c();x.id=l.id;x.X.c(e);x.ba.c(f);x.z=(e.l.z+f.l.z)/2;x.r=l.r;L.elements.push(x)},gj:function(a,c,g){var q=s[a],u=s[c],v=s[g];if(!1!==f(q,u,v)&&(n.Jb===d.Id||!0===e(q,u,v))){w=b();w.id=l.id;w.X.c(q);w.ba.c(u);w.Ub.c(v);w.z=(q.l.z+u.l.z+v.l.z)/3;for(q=0;3>q;q++)u=3*arguments[q],v=w.Fd[q],v.set(h[u],
h[u+1],h[u+2]),Xb(v,r).normalize(),u=2*arguments[q],w.Ed[q].set(k[u],k[u+1]);w.im=3;w.r=l.r;L.elements.push(w)}}}};this.tp=function(q,u,z,y){B=C=v=0;L.elements.length=0;!0===q.Le&&q.ra();void 0===u.parent&&u.ra();ba.c(u.Ea.Gb(u.m));cc(R,u.za,ba);uc(S,R);k=0;L.La.length=0;L.Wc.length=0;Nc(q,function(a){if(a instanceof d.sa)L.Wc.push(a);else if(a instanceof d.Y||a instanceof d.U||a instanceof d.Pc)if(!1===a.Ve||!0===S.lh(a)){if(k===n){var b=new d.en;l.push(b);n++;k++;h=b}else h=l[k++];h.id=a.id;h.object=
a;null!==a.df?h.z=a.df:(Cb(Q,a.m),Wb(Q,R),h.z=Q.z);L.La.push(h)}});!0===z&&L.La.sort(f);q=0;for(z=L.La.length;q<z;q++){var E=L.La[q].object,A=E.k;aa.Cp(E);V=E.m;r=0;if(E instanceof d.Y)if(A instanceof d.wa){var D=A.attributes,E=A.Qb;if(void 0!==D.position){for(var F=D.position.d,A=0,J=F.length;A<J;A+=3)aa.hj(F[A],F[A+1],F[A+2]);if(void 0!==D.F)for(var K=D.F.d,A=0,J=K.length;A<J;A+=3)aa.up(K[A],K[A+1],K[A+2]);if(void 0!==D.pb)for(K=D.pb.d,A=0,J=K.length;A<J;A+=2)aa.vp(K[A],K[A+1]);if(void 0!==D.index)if(D=
D.index.d,0<E.length)for(q=0;q<E.length;q++)for(J=E[q],F=J.index,A=J.start,J=J.start+J.count;A<J;A+=3)aa.gj(D[A]+F,D[A+1]+F,D[A+2]+F);else for(A=0,J=D.length;A<J;A+=3)aa.gj(D[A],D[A+1],D[A+2]);else for(A=0,J=F.length/3;A<J;A+=3)aa.gj(A,A+1,A+2)}}else{if(A instanceof d.u){var G=A.e,J=A.j,D=A.D[0];bc(ca,V);for(var F=E.r instanceof d.jd,K=!0===F?E.r:null,Aa=0,oa=G.length;Aa<oa;Aa++){var N=G[Aa];aa.hj(N.x,N.y,N.z)}G=0;for(Aa=J.length;G<Aa;G++){var oa=J[G],La=!0===F?K.Va[oa.Hb]:E.r;if(void 0!==La){var Ea=
La.Jb,N=s[oa.N],pa=s[oa.i],Ja=s[oa.O];if(!0===La.w){var qa=A.w,la=E.Wa,ta=N.position,Ra=pa.position,Pa=Ja.position;M.set(0,0,0);ea.set(0,0,0);T.set(0,0,0);for(var Ha=0,$a=qa.length;Ha<$a;Ha++){var Qa=la[Ha];if(0!==Qa){var ga=qa[Ha].e;M.x+=(ga[oa.N].x-ta.x)*Qa;M.y+=(ga[oa.N].y-ta.y)*Qa;M.z+=(ga[oa.N].z-ta.z)*Qa;ea.x+=(ga[oa.i].x-Ra.x)*Qa;ea.y+=(ga[oa.i].y-Ra.y)*Qa;ea.z+=(ga[oa.i].z-Ra.z)*Qa;T.x+=(ga[oa.O].x-Pa.x)*Qa;T.y+=(ga[oa.O].y-Pa.y)*Qa;T.z+=(ga[oa.O].z-Pa.z)*Qa}}N.position.add(M);pa.position.add(ea);
Ja.position.add(T);aa.fj(N);aa.fj(pa);aa.fj(Ja)}if(!1!==aa.ko(N,pa,Ja)){qa=aa.jo(N,pa,Ja);if(Ea!==d.Id){if(Ea===d.Nj&&!1===qa)continue;if(Ea===d.te&&!0===qa)continue}w=b();w.id=E.id;w.X.c(N);w.ba.c(pa);w.Ub.c(Ja);w.bg.c(oa.F);!1!==qa||Ea!==d.te&&Ea!==d.Id||w.bg.he();Xb(w.bg,ca).normalize();la=oa.na;ta=0;for(Ra=Math.min(la.length,3);ta<Ra;ta++)Pa=w.Fd[ta],Pa.c(la[ta]),!1!==qa||Ea!==d.te&&Ea!==d.Id||Pa.he(),Xb(Pa,ca).normalize();w.im=la.length;Ea=D[G];if(void 0!==Ea)for(qa=0;3>qa;qa++)w.Ed[qa].c(Ea[qa]);
w.color=oa.color;w.r=La;w.z=(N.l.z+pa.l.z+Ja.l.z)/3;L.elements.push(w)}}}}}else if(E instanceof d.U)if(A instanceof d.wa){if(D=A.attributes,void 0!==D.position){F=D.position.d;A=0;for(J=F.length;A<J;A+=3)aa.hj(F[A],F[A+1],F[A+2]);if(void 0!==D.index)for(D=D.index.d,A=0,J=D.length;A<J;A+=2)aa.Jl(D[A],D[A+1]);else for(D=E.type===d.Mb?2:1,A=0,J=F.length/3-1;A<J;A+=D)aa.Jl(A,A+1)}}else{if(A instanceof d.u&&(cc(U,R,V),G=E.k.e,0!==G.length))for(N=a(),N.l.c(G[0]).Q(U),D=E.type===d.Mb?2:1,Aa=1,oa=G.length;Aa<
oa;Aa++)N=a(),N.l.c(G[Aa]).Q(U),0<(Aa+1)%D||(pa=s[r-2],Y.c(N.l),da.c(pa.l),!0===g(Y,da)&&(Y.G(1/Y.f),da.G(1/da.f),x=c(),x.id=E.id,x.X.l.c(Y),x.ba.l.c(da),x.z=Math.max(Y.z,da.z),x.r=E.r,E.r.s===d.Rd&&(x.s[0].c(E.k.ka[Aa]),x.s[1].c(E.k.ka[Aa-1])),L.elements.push(x)))}else E instanceof d.Pc&&(P.set(V.elements[12],V.elements[13],V.elements[14],1),P.Q(R),A=1/P.f,P.z*=A,-1<=P.z&&1>=P.z&&(H=e(),H.id=E.id,H.x=P.x*A,H.y=P.y*A,H.z=P.z,H.object=E,H.rotation=E.rotation,H.scale.x=E.scale.x*Math.abs(H.x-(P.x+u.za.elements[0])/
(P.f+u.za.elements[12])),H.scale.y=E.scale.y*Math.abs(H.y-(P.y+u.za.elements[5])/(P.f+u.za.elements[13])),H.r=E.r,L.elements.push(H)))}!0===y&&L.elements.sort(f);return L}};d.P=function(a,b,c,e,f,g){this.N=a;this.i=b;this.O=c;this.F=e instanceof d.b?e:new d.b;this.na=e instanceof Array?e:[];this.color=f instanceof d.q?f:new d.q;this.s=f instanceof Array?f:[];this.Gd=[];this.Hb=void 0!==g?g:0};
d.P.prototype={clone:function(){var a=new d.P(this.N,this.i,this.O);a.F.c(this.F);a.color.c(this.color);a.Hb=this.Hb;for(var b=0,c=this.na.length;b<c;b++)a.na[b]=this.na[b].clone();b=0;for(c=this.s.length;b<c;b++)a.s[b]=this.s[b].clone();b=0;for(c=this.Gd.length;b<c;b++)a.Gd[b]=this.Gd[b].clone();return a}};d.rq=function(a,b,c,e,f,g,h){console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead.");return new d.P(a,b,c,f,g,h)};d.ab=function(a,b){this.d=a;this.Vc=b};
d.ab.prototype={get length(){return this.d.length},set:function(a){this.d.set(a);return this},ng:function(a,b){this.d[a*this.Vc+1]=b;return this}};d.zq=function(a,b){console.warn("THREE.Int8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.Pq=function(a,b){console.warn("THREE.Uint8Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};
d.Qq=function(a,b){console.warn("THREE.Uint8ClampedAttribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.xq=function(a,b){console.warn("THREE.Int16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.Nq=function(a,b){console.warn("THREE.Uint16Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};
d.yq=function(a,b){console.warn("THREE.Int32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.Oq=function(a,b){console.warn("THREE.Uint32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.Dm=function(a){console.warn("THREE.Float32Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,3)};
d.sq=function(a,b){console.warn("THREE.Float64Attribute has been removed. Use THREE.BufferAttribute( array, itemSize ) instead.");return new d.ab(a,b)};d.wa=function(){this.id=d.Oj++;this.Tb=d.Math.Pf();this.name="";this.attributes={};this.Qb=this.wo=[];this.Ra=this.Qa=null};
d.wa.prototype={Tc:function(a){var b=this.attributes.position;void 0!==b&&(a.xi(b.d),b.H=!0);b=this.attributes.F;void 0!==b&&(bc(new d.Nb,a).xi(b.d),b.H=!0)},Ff:function(){null===this.Qa&&(this.Qa=new d.Wb);var a=this.attributes.position.d;if(a){var b=this.Qa;3<=a.length&&(b.min.x=b.max.x=a[0],b.min.y=b.max.y=a[1],b.min.z=b.max.z=a[2]);for(var c=3,e=a.length;c<e;c+=3){var f=a[c],g=a[c+1],h=a[c+2];f<b.min.x?b.min.x=f:f>b.max.x&&(b.max.x=f);g<b.min.y?b.min.y=g:g>b.max.y&&(b.max.y=g);h<b.min.z?b.min.z=
h:h>b.max.z&&(b.max.z=h)}}if(void 0===a||0===a.length)this.Qa.min.set(0,0,0),this.Qa.max.set(0,0,0);(isNaN(this.Qa.min.x)||isNaN(this.Qa.min.y)||isNaN(this.Qa.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.')},Ne:function(){var a=new d.Wb,b=new d.b;return function(){null===this.Ra&&(this.Ra=new d.$b);var c=this.attributes.position.d;if(c){a.zd();for(var e=this.Ra.ia,f=0,g=c.length;f<g;f+=3)b.set(c[f],
c[f+1],c[f+2]),a.Nf(b);a.ia(e);for(var h=0,f=0,g=c.length;f<g;f+=3)b.set(c[f],c[f+1],c[f+2]),h=Math.max(h,e.ce(b));this.Ra.ea=Math.sqrt(h);isNaN(this.Ra.ea)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}}}(),kb:function(){},Gf:function(){if(this.attributes.position){var a,b,c,e;a=this.attributes.position.d.length;if(void 0===this.attributes.normal)this.attributes.normal={Vc:3,d:new Float32Array(a)};else for(a=
0,b=this.attributes.normal.d.length;a<b;a++)this.attributes.normal.d[a]=0;var f=this.attributes.position.d,g=this.attributes.normal.d,h,k,l,n,q,r,s=new d.b,u=new d.b,w=new d.b,v=new d.b,y=new d.b;if(this.attributes.index){var z=this.attributes.index.d,x=0<this.Qb.length?this.Qb:[{start:0,count:z.length,index:0}];c=0;for(e=x.length;c<e;++c){b=x[c].start;h=x[c].count;var C=x[c].index;a=b;for(b+=h;a<b;a+=3)h=C+z[a],k=C+z[a+1],l=C+z[a+2],n=f[3*h],q=f[3*h+1],r=f[3*h+2],s.set(n,q,r),n=f[3*k],q=f[3*k+1],
r=f[3*k+2],u.set(n,q,r),n=f[3*l],q=f[3*l+1],r=f[3*l+2],w.set(n,q,r),v.ca(w,u),y.ca(s,u),Nb(v,y),g[3*h]+=v.x,g[3*h+1]+=v.y,g[3*h+2]+=v.z,g[3*k]+=v.x,g[3*k+1]+=v.y,g[3*k+2]+=v.z,g[3*l]+=v.x,g[3*l+1]+=v.y,g[3*l+2]+=v.z}}else for(a=0,b=f.length;a<b;a+=9)n=f[a],q=f[a+1],r=f[a+2],s.set(n,q,r),n=f[a+3],q=f[a+4],r=f[a+5],u.set(n,q,r),n=f[a+6],q=f[a+7],r=f[a+8],w.set(n,q,r),v.ca(w,u),y.ca(s,u),Nb(v,y),g[a]=v.x,g[a+1]=v.y,g[a+2]=v.z,g[a+3]=v.x,g[a+4]=v.y,g[a+5]=v.z,g[a+6]=v.x,g[a+7]=v.y,g[a+8]=v.z;a=this.attributes.normal.d;
c=0;for(e=a.length;c<e;c+=3)f=a[c],g=a[c+1],s=a[c+2],f=1/Math.sqrt(f*f+g*g+s*s),a[c]*=f,a[c+1]*=f,a[c+2]*=f;this.dg=!0}},Sk:function(){function a(a,b,c){r=e[3*a];s=e[3*a+1];u=e[3*a+2];w=e[3*b];v=e[3*b+1];y=e[3*b+2];z=e[3*c];x=e[3*c+1];C=e[3*c+2];E=g[2*a];A=g[2*a+1];H=g[2*b];B=g[2*b+1];D=g[2*c];F=g[2*c+1];L=w-r;M=z-r;ea=v-s;T=x-s;Q=y-u;P=C-u;G=H-E;K=D-E;J=B-A;ba=F-A;R=1/(G*ba-K*J);V.set((ba*L-J*M)*R,(ba*ea-J*T)*R,(ba*Q-J*P)*R);U.set((G*M-K*L)*R,(G*T-K*ea)*R,(G*P-K*Q)*R);l[a].add(V);l[b].add(V);l[c].add(V);
n[a].add(U);n[b].add(U);n[c].add(U)}function b(a){Ga.x=f[3*a];Ga.y=f[3*a+1];Ga.z=f[3*a+2];va.c(Ga);Va=l[a];na.c(Va);na.sub(Ga.G(Ga.pa(Va))).normalize();Ib(Ua,va,Va);gb=Ua.pa(n[a]);sa=0>gb?-1:1;k[4*a]=na.x;k[4*a+1]=na.y;k[4*a+2]=na.z;k[4*a+3]=sa}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var c=this.attributes.index.d,
e=this.attributes.position.d,f=this.attributes.normal.d,g=this.attributes.uv.d,h=e.length/3;void 0===this.attributes.tangent&&(this.attributes.tangent={Vc:4,d:new Float32Array(4*h)});for(var k=this.attributes.tangent.d,l=[],n=[],q=0;q<h;q++)l[q]=new d.b,n[q]=new d.b;var r,s,u,w,v,y,z,x,C,E,A,H,B,D,F,L,M,ea,T,Q,P,G,K,J,ba,R,V=new d.b,U=new d.b,ca,S,Y,da,aa,ua=this.Qb,q=0;for(S=ua.length;q<S;++q){ca=ua[q].start;Y=ua[q].count;var Ca=ua[q].index,h=ca;for(ca+=Y;h<ca;h+=3)Y=Ca+c[h],da=Ca+c[h+1],aa=Ca+c[h+
2],a(Y,da,aa)}var na=new d.b,Ua=new d.b,Ga=new d.b,va=new d.b,sa,Va,gb,q=0;for(S=ua.length;q<S;++q)for(ca=ua[q].start,Y=ua[q].count,Ca=ua[q].index,h=ca,ca+=Y;h<ca;h+=3)Y=Ca+c[h],da=Ca+c[h+1],aa=Ca+c[h+2],b(Y),b(da),b(aa)}},Jc:function(){console.log("BufferGeometry.merge(): TODO")},clone:function(){var a=new d.wa,b=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],c;for(c in this.attributes){for(var e=this.attributes[c],f=e.d,g={Vc:e.Vc,
d:null},e=0,h=b.length;e<h;e++){var k=b[e];if(f instanceof k){g.d=new k(f);break}}a.attributes[c]=g}e=0;for(h=this.Qb.length;e<h;e++)b=this.Qb[e],a.Qb.push({start:b.start,index:b.index,count:b.count});return a}};function Zc(a,b,c){!1===c instanceof d.ab?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),a.attributes[b]={d:c,Vc:void 0}):a.attributes[b]=c}d.Xb.prototype.apply(d.wa.prototype);
d.u=function(){this.id=d.Oj++;this.Tb=d.Math.Pf();this.name="";this.e=[];this.ka=[];this.j=[];this.D=[[]];this.w=[];this.Ad=[];this.Ja=[];this.Sb=[];this.Kb=[];this.Xo=[];this.Ra=this.Qa=null;this.Ui=!1;this.xo=!0;this.ih=this.Fi=this.oh=this.Eb=this.Kh=this.dg=this.Oh=this.dh=this.Oa=!1};
d.u.prototype={Tc:function(a){for(var b=bc(new d.Nb,a),c=0,e=this.e.length;c<e;c++)this.e[c].Q(a);c=0;for(e=this.j.length;c<e;c++){a=this.j[c];Xb(a.F,b).normalize();for(var f=0,g=a.na.length;f<g;f++)Xb(a.na[f],b).normalize()}this.Qa instanceof d.Wb&&this.Ff();this.Ra instanceof d.$b&&this.Ne()},ia:function(){this.Ff();var a=new d.b;a.yc(this.Qa.min,this.Qa.max);a.G(-.5);this.Tc(tc(new d.S,a.x,a.y,a.z));this.Ff();return a},kb:function(){for(var a=new d.b,b=new d.b,c=0,e=this.j.length;c<e;c++){var f=
this.j[c],g=this.e[f.N],h=this.e[f.i];a.ca(this.e[f.O],h);b.ca(g,h);Nb(a,b);a.normalize();f.F.c(a)}},Gf:function(a){var b,c,e;e=Array(this.e.length);b=0;for(c=this.e.length;b<c;b++)e[b]=new d.b;if(a){var f,g,h,k=new d.b,l=new d.b;a=0;for(b=this.j.length;a<b;a++)c=this.j[a],f=this.e[c.N],g=this.e[c.i],h=this.e[c.O],k.ca(h,g),l.ca(f,g),Nb(k,l),e[c.N].add(k),e[c.i].add(k),e[c.O].add(k)}else for(a=0,b=this.j.length;a<b;a++)c=this.j[a],e[c.N].add(c.F),e[c.i].add(c.F),e[c.O].add(c.F);b=0;for(c=this.e.length;b<
c;b++)e[b].normalize();a=0;for(b=this.j.length;a<b;a++)c=this.j[a],c.na[0]=e[c.N].clone(),c.na[1]=e[c.i].clone(),c.na[2]=e[c.O].clone()},Sk:function(){var a,b,c,e,f,g,h,k,l,n,q,r,s,u,w,v,y,z=[],x=[];c=new d.b;var C=new d.b,E=new d.b,A=new d.b,H=new d.b;a=0;for(b=this.e.length;a<b;a++)z[a]=new d.b,x[a]=new d.b;a=0;for(b=this.j.length;a<b;a++)f=this.j[a],g=this.D[0][a],e=f.N,y=f.i,f=f.O,h=this.e[e],k=this.e[y],l=this.e[f],n=g[0],q=g[1],r=g[2],g=k.x-h.x,s=l.x-h.x,u=k.y-h.y,w=l.y-h.y,k=k.z-h.z,h=l.z-
h.z,l=q.x-n.x,v=r.x-n.x,q=q.y-n.y,n=r.y-n.y,r=1/(l*n-v*q),c.set((n*g-q*s)*r,(n*u-q*w)*r,(n*k-q*h)*r),C.set((l*s-v*g)*r,(l*w-v*u)*r,(l*h-v*k)*r),z[e].add(c),z[y].add(c),z[f].add(c),x[e].add(C),x[y].add(C),x[f].add(C);C=["a","b","c","d"];a=0;for(b=this.j.length;a<b;a++)for(f=this.j[a],c=0;c<Math.min(f.na.length,3);c++)H.c(f.na[c]),e=f[C[c]],y=z[e],E.c(y),E.sub(H.G(H.pa(y))).normalize(),Ib(A,f.na[c],y),e=A.pa(x[e]),e=0>e?-1:1,f.Gd[c]=new d.bc(E.x,E.y,E.z,e);this.Ui=!0},Ff:function(){null===this.Qa&&
(this.Qa=new d.Wb);this.Qa.Yc(this.e)},Ne:function(){null===this.Ra&&(this.Ra=new d.$b);this.Ra.Yc(this.e)},Jc:function(a,b,c){if(!1===a instanceof d.u)console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",a);else{var e,f=this.e.length,g=this.e,h=a.e,k=this.j,l=a.j,n=this.D[0];a=a.D[0];void 0===c&&(c=0);void 0!==b&&(e=bc(new d.Nb,b));for(var q=0,r=h.length;q<r;q++){var s=h[q].clone();void 0!==b&&s.Q(b);g.push(s)}q=0;for(r=l.length;q<r;q++){var h=l[q],u,w=h.na,v=h.s,s=
new d.P(h.N+f,h.i+f,h.O+f);s.F.c(h.F);void 0!==e&&Xb(s.F,e).normalize();b=0;for(g=w.length;b<g;b++)u=w[b].clone(),void 0!==e&&Xb(u,e).normalize(),s.na.push(u);s.color.c(h.color);b=0;for(g=v.length;b<g;b++)u=v[b],s.s.push(u.clone());s.Hb=h.Hb+c;k.push(s)}q=0;for(r=a.length;q<r;q++)if(c=a[q],e=[],void 0!==c){b=0;for(g=c.length;b<g;b++)e.push(new d.g(c[b].x,c[b].y));n.push(e)}}},Yo:function(){var a=0;return function(b,c){var e,f,g,h,k={},l,n=this.w.length,q=this.Ja.length;this.Gc={};this.Hc=[];e=0;for(f=
this.j.length;e<f;e++)g=this.j[e],g=b?g.Hb:0,g in k||(k[g]={hash:g,counter:0}),h=k[g].hash+"_"+k[g].Ii,h in this.Gc||(l={id:a++,faces3:[],materialIndex:g,vertices:0,numMorphTargets:n,numMorphNormals:q},this.Gc[h]=l,this.Hc.push(l)),this.Gc[h].e+3>c&&(k[g].Ii+=1,h=k[g].hash+"_"+k[g].Ii,h in this.Gc||(l={id:a++,faces3:[],materialIndex:g,vertices:0,numMorphTargets:n,numMorphNormals:q},this.Gc[h]=l,this.Hc.push(l))),this.Gc[h].$k.push(e),this.Gc[h].e+=3}}(),clone:function(){for(var a=new d.u,b=this.e,
c=0,e=b.length;c<e;c++)a.e.push(b[c].clone());b=this.j;c=0;for(e=b.length;c<e;c++)a.j.push(b[c].clone());b=this.D[0];c=0;for(e=b.length;c<e;c++){for(var f=b[c],g=[],h=0,k=f.length;h<k;h++)g.push(new d.g(f[h].x,f[h].y));a.D[0].push(g)}return a}};
function $c(a){var b={},c=[],e=[],f,g=Math.pow(10,4),h,k;h=0;for(k=a.e.length;h<k;h++)f=a.e[h],f=Math.round(f.x*g)+"_"+Math.round(f.y*g)+"_"+Math.round(f.z*g),void 0===b[f]?(b[f]=h,c.push(a.e[h]),e[h]=c.length-1):e[h]=e[b[f]];b=[];h=0;for(k=a.j.length;h<k;h++)for(g=a.j[h],g.N=e[g.N],g.i=e[g.i],g.O=e[g.O],g=[g.N,g.i,g.O],f=0;3>f;f++)if(g[f]==g[(f+1)%3]){b.push(h);break}for(h=b.length-1;0<=h;h--)for(g=b[h],a.j.splice(g,1),e=0,k=a.D.length;e<k;e++)a.D[e].splice(g,1);a.e=c}d.Xb.prototype.apply(d.u.prototype);
d.Oj=0;d.hb=function(){d.A.call(this);this.Ea=new d.S;this.za=new d.S};d.hb.prototype=Object.create(d.A.prototype);d.hb.prototype.gb=function(){var a=new d.S;return function(b){a.gb(this.position,b,this.mc);this.cb.zh(a)}}();d.hb.prototype.clone=function(a){void 0===a&&(a=new d.hb);d.A.prototype.clone.call(this,a);a.Ea.c(this.Ea);a.za.c(this.za);return a};
d.tm=function(a,b,c){d.A.call(this);var e=new d.zb(90,1,a,b);e.mc.set(0,-1,0);e.gb(new d.b(1,0,0));this.add(e);e=new d.zb(90,1,a,b);e.mc.set(0,-1,0);e.gb(new d.b(-1,0,0));this.add(e);e=new d.zb(90,1,a,b);e.mc.set(0,0,1);e.gb(new d.b(0,1,0));this.add(e);e=new d.zb(90,1,a,b);e.mc.set(0,0,-1);e.gb(new d.b(0,-1,0));this.add(e);e=new d.zb(90,1,a,b);e.mc.set(0,-1,0);e.gb(new d.b(0,0,1));this.add(e);a=new d.zb(90,1,a,b);a.mc.set(0,-1,0);a.gb(new d.b(0,0,-1));this.add(a);this.Ol=new d.Sd(c,c,{format:d.ii,
Pb:d.Jd,ub:d.Jd})};d.tm.prototype=Object.create(d.A.prototype);d.Ce=function(a,b,c,e,f,g){d.hb.call(this);this.left=a;this.right=b;this.top=c;this.bottom=e;this.Xa=void 0!==f?f:.1;this.Ta=void 0!==g?g:2E3;this.Mh()};d.Ce.prototype=Object.create(d.hb.prototype);
d.Ce.prototype.Mh=function(){var a=this.left,b=this.right,c=this.top,e=this.bottom,f=this.Xa,g=this.Ta,h=this.za.elements,k=b-a,l=c-e,n=g-f;h[0]=2/k;h[4]=0;h[8]=0;h[12]=-((b+a)/k);h[1]=0;h[5]=2/l;h[9]=0;h[13]=-((c+e)/l);h[2]=0;h[6]=0;h[10]=-2/n;h[14]=-((g+f)/n);h[3]=0;h[7]=0;h[11]=0;h[15]=1};d.Ce.prototype.clone=function(){var a=new d.Ce;d.hb.prototype.clone.call(this,a);a.left=this.left;a.right=this.right;a.top=this.top;a.bottom=this.bottom;a.Xa=this.Xa;a.Ta=this.Ta;return a};
d.zb=function(a,b,c,e){d.hb.call(this);this.Of=void 0!==a?a:50;this.Xg=void 0!==b?b:1;this.Xa=void 0!==c?c:.1;this.Ta=void 0!==e?e:2E3;this.Mh()};d.zb.prototype=Object.create(d.hb.prototype);
d.zb.prototype.Mh=function(){if(this.Ri){var a=this.Ri/this.al,b=Math.tan(d.Math.Vk(.5*this.Of))*this.Xa,c=-b,e=a*c,a=Math.abs(a*b-e),c=Math.abs(b-c);dc(this.za,e+this.x*a/this.Ri,e+(this.x+this.width)*a/this.Ri,b-(this.y+this.height)*c/this.al,b-this.y*c/this.al,this.Xa,this.Ta)}else{var b=this.za,e=this.Xg,c=this.Xa,a=this.Ta,f=c*Math.tan(d.Math.Vk(.5*this.Of)),g=-f;dc(b,g*e,f*e,g,f,c,a)}};
d.zb.prototype.clone=function(){var a=new d.zb;d.hb.prototype.clone.call(this,a);a.Of=this.Of;a.Xg=this.Xg;a.Xa=this.Xa;a.Ta=this.Ta;return a};d.sa=function(a){d.A.call(this);this.color=new d.q(a)};d.sa.prototype=Object.create(d.A.prototype);d.sa.prototype.clone=function(a){void 0===a&&(a=new d.sa);d.A.prototype.clone.call(this,a);a.color.c(this.color);return a};d.se=function(a){d.sa.call(this,a)};d.se.prototype=Object.create(d.sa.prototype);
d.se.prototype.clone=function(){var a=new d.se;d.sa.prototype.clone.call(this,a);return a};d.nm=function(a,b){d.sa.call(this,a);this.F=new d.b(0,-1,0);this.right=new d.b(1,0,0);this.ja=void 0!==b?b:1;this.height=this.width=1};d.nm.prototype=Object.create(d.sa.prototype);
d.vb=function(a,b){d.sa.call(this,a);this.position.set(0,1,0);this.target=new d.A;this.ja=void 0!==b?b:1;this.Bd=this.tb=!1;this.bd=50;this.ad=5E3;this.pg=-500;this.rg=this.qg=500;this.og=-500;this.Rb=!1;this.Zc=0;this.kc=.5;this.cd=this.dd=512;this.sg=!1;this.tj=new d.b(0,0,-1E3);this.rj=2;this.Ch=[0,0,0];this.uj=[512,512,512];this.sj=[512,512,512];this.Eh=[-1,.99,.998];this.Dh=[.99,.998,1];this.oe=[];this.hf=this.$c=this.Hh=this.gf=null};d.vb.prototype=Object.create(d.sa.prototype);
d.vb.prototype.clone=function(){var a=new d.vb;d.sa.prototype.clone.call(this,a);a.target=this.target.clone();a.ja=this.ja;a.tb=this.tb;a.Bd=this.Bd;a.bd=this.bd;a.ad=this.ad;a.pg=this.pg;a.qg=this.qg;a.rg=this.rg;a.og=this.og;a.Rb=this.Rb;a.Zc=this.Zc;a.kc=this.kc;a.dd=this.dd;a.cd=this.cd;a.sg=this.sg;a.tj.c(this.tj);a.rj=this.rj;a.Ch=this.Ch.slice(0);a.uj=this.uj.slice(0);a.sj=this.sj.slice(0);a.Eh=this.Eh.slice(0);a.Dh=this.Dh.slice(0);return a};
d.xe=function(a,b,c){d.sa.call(this,a);this.position.set(0,100,0);this.Uf=new d.q(b);this.ja=void 0!==c?c:1};d.xe.prototype=Object.create(d.sa.prototype);d.xe.prototype.clone=function(){var a=new d.xe;d.sa.prototype.clone.call(this,a);a.Uf.c(this.Uf);a.ja=this.ja;return a};d.ld=function(a,b,c){d.sa.call(this,a);this.ja=void 0!==b?b:1;this.Da=void 0!==c?c:0};d.ld.prototype=Object.create(d.sa.prototype);
d.ld.prototype.clone=function(){var a=new d.ld;d.sa.prototype.clone.call(this,a);a.ja=this.ja;a.Da=this.Da;return a};d.Oc=function(a,b,c,e,f){d.sa.call(this,a);this.position.set(0,1,0);this.target=new d.A;this.ja=void 0!==b?b:1;this.Da=void 0!==c?c:0;this.xf=void 0!==e?e:Math.PI/3;this.eh=void 0!==f?f:10;this.Bd=this.tb=!1;this.bd=50;this.ad=5E3;this.qj=50;this.Rb=!1;this.Zc=0;this.kc=.5;this.cd=this.dd=512;this.hf=this.$c=this.Hh=this.gf=null};d.Oc.prototype=Object.create(d.sa.prototype);
d.Oc.prototype.clone=function(){var a=new d.Oc;d.sa.prototype.clone.call(this,a);a.target=this.target.clone();a.ja=this.ja;a.Da=this.Da;a.xf=this.xf;a.eh=this.eh;a.tb=this.tb;a.Bd=this.Bd;a.bd=this.bd;a.ad=this.ad;a.qj=this.qj;a.Rb=this.Rb;a.Zc=this.Zc;a.kc=this.kc;a.dd=this.dd;a.cd=this.cd;return a};d.Th=function(){this.files={}};d.Th.prototype={add:function(a,b){this.files[a]=b},get:function(a){return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};
d.qf=function(a){a&&(a=document.createElement("div"),a.style.position="absolute",a.style.right="0px",a.style.top="0px",a.style.fontSize="0.8em",a.style.textAlign="left",a.style.background="rgba(0,0,0,0.25)",a.style.color="#fff",a.style.width="120px",a.style.padding="0.5em 0.5em 0.5em 0.5em",a.style.zIndex=1E3,a.innerHTML="Loading ...");this.Ro=new d.pf};d.qf.prototype={crossOrigin:void 0};
function ad(a,b,c){function e(a){a=Math.log(a)/Math.LN2;return Math.pow(2,Math.round(a))}function f(a,b,f,g,k,l,v){var y=c+f,z,x=d.qf.Fm.get(y);null!==x?z=x.load(y):(z=new d.xa,x=h.Ro,x.crossOrigin=h.crossOrigin,x.load(y,function(a){if(!1===d.Math.yd(a.width)||!1===d.Math.yd(a.height)){var b=e(a.width),c=e(a.height),f=document.createElement("canvas");f.width=b;f.height=c;f.getContext("2d").drawImage(a,0,0,b,c);z.$=f}else z.$=a;z.H=!0}));z.Jp=f;g&&(z.repeat.set(g[0],g[1]),1!==g[0]&&(z.qc=d.De),1!==
g[1]&&(z.rc=d.De));k&&z.offset.set(k[0],k[1]);l&&(f={repeat:d.De,mirror:d.Uj},void 0!==f[l[0]]&&(z.qc=f[l[0]]),void 0!==f[l[1]]&&(z.rc=f[l[1]]));v&&(z.dc=v);a[b]=z}function g(a){return(255*a[0]<<16)+(255*a[1]<<8)+255*a[2]}var h=a,k="MeshLambertMaterial";a={color:15658734,opacity:1,map:null,Ua:null,ob:null,sb:null,V:!1};if(b.Ma){var l=b.Ma.toLowerCase();"phong"===l?k="MeshPhongMaterial":"basic"===l&&(k="MeshBasicMaterial")}void 0!==b.Pa&&void 0!==d[b.Pa]&&(a.Pa=d[b.Pa]);if(void 0!==b.eb||1>b.opacity)a.eb=
b.eb;void 0!==b.Dc&&(a.Dc=b.Dc);void 0!==b.Ec&&(a.Ec=b.Ec);void 0!==b.visible&&(a.visible=b.visible);void 0!==b.Qi&&(a.Jb=d.te);void 0!==b.Oi&&(a.Jb=d.Id);void 0!==b.V&&(a.V=b.V);void 0!==b.s&&("face"===b.s?a.s=d.nf:b.s&&(a.s=d.Rd));b.oo?a.color=g(b.oo):b.xm&&(a.color=b.xm);b.qo&&(a.lc=g(b.qo));b.no&&(a.ta=g(b.no));b.po&&(a.Sa=g(b.po));b.Xp&&(a.opacity=b.Xp);b.Kp&&(a.ed=b.Kp);b.bp&&c&&f(a,"map",b.bp,b.Nr,b.Mr,b.Or,b.Lr);b.cp&&c&&f(a,"lightMap",b.cp,b.Rr,b.Qr,b.Sr,b.Pr);b.$o&&c&&f(a,"bumpMap",b.$o,
b.Jr,b.Ir,b.Kr,b.Hr);b.ql&&c&&f(a,"normalMap",b.ql,b.Wr,b.Vr,b.Xr,b.Ur);b.dp&&c&&f(a,"specularMap",b.dp,b.$r,b.Zr,b.as,b.Yr);b.Zo&&c&&f(a,"alphaMap",b.Zo,b.Fr,b.Er,b.Gr,b.Dr);b.ap&&(a.Cf=b.ap);b.ql?(k=d.Kg.normalmap,l=d.ac.clone(k.M),l.tNormal.value=a.ob,b.rl&&l.uNormalScale.value.set(b.rl,b.rl),a.map&&(l.tDiffuse.value=a.map,l.enableDiffuse.value=!0),a.Na&&(l.tSpecular.value=a.Na,l.enableSpecular.value=!0),a.Ua&&(l.tAO.value=a.Ua,l.enableAO.value=!0),kb(l.diffuse.value,a.color),kb(l.specular.value,
a.lc),kb(l.ambient.value,a.ta),l.shininess.value=a.ed,void 0!==a.opacity&&(l.opacity.value=a.opacity),k=new d.Fa({I:k.I,J:k.J,M:l,Wc:!0,L:!0}),a.eb&&(k.eb=!0)):k=new d[k](a);void 0!==b.ym&&(k.name=b.ym);return k}function bd(a){for(var b=0,c=a.length;b<c;b++)if(a[b]instanceof d.Fa)return!0;return!1}function cd(a,b,c){for(var e=[],f=0;f<b.length;++f)e[f]=ad(a,b[f],c);return e}
d.qf.Fm={jh:[],add:function(a,b){this.jh.push(a,b)},get:function(a){for(var b=0,c=this.jh.length;b<c;b+=2){var e=this.jh[b+1];if(this.jh[b].test(a))return e}return null}};d.Ng=function(a){this.Df=new d.Th;this.hc=void 0!==a?a:d.ve};
d.Ng.prototype={load:function(a,b,c,e){var f=this,g=f.Df.get(a);void 0!==g?b&&b(g):(g=new XMLHttpRequest,g.open("GET",a,!0),g.addEventListener("load",function(){f.Df.add(a,this.response);b&&b(this.response);f.hc.jl(a)},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),void 0!==e&&g.addEventListener("error",function(a){e(a)},!1),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),void 0!==this.responseType&&(g.responseType=this.responseType),g.send(null),f.hc.kl())},Xc:function(a){this.crossOrigin=
a}};d.pf=function(a){this.Df=new d.Th;this.hc=void 0!==a?a:d.ve};
d.pf.prototype={load:function(a,b,c,e){var f=this,g=f.Df.get(a);if(void 0!==g)b(g);else return g=document.createElement("img"),void 0!==b&&g.addEventListener("load",function(){f.Df.add(a,this);b(this);f.hc.jl(a)},!1),void 0!==c&&g.addEventListener("progress",function(a){c(a)},!1),void 0!==e&&g.addEventListener("error",function(a){e(a)},!1),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),g.src=a,f.hc.kl(),g},Xc:function(a){this.crossOrigin=a}};
d.Eg=function(a){d.qf.call(this,a);this.withCredentials=!1};d.Eg.prototype=Object.create(d.qf.prototype);d.Eg.prototype.load=function(a,b,c){c&&"string"===typeof c||(c=a.split("/"),1===c.length?c="./":(c.pop(),c=c.join("/")+"/"));dd(this,this,a,b,c)};
function dd(a,b,c,e,f){var g=new XMLHttpRequest;g.onreadystatechange=function(){if(g.readyState===g.DONE)if(200===g.status||0===g.status)if(g.responseText){var a=JSON.parse(g.responseText);void 0!==a.gp&&"scene"===a.gp.type?console.error('THREE.JSONLoader: "'+c+'" seems to be a Scene. Use THREE.SceneLoader instead.'):(a=b.parse(a,f),e(a.k,a.Va))}else console.error('THREE.JSONLoader: "'+c+'" seems to be unreachable or the file is empty.');else console.error("THREE.JSONLoader: Couldn't load \""+c+'" ('+
g.status+")")};g.open("GET",c,!0);g.withCredentials=a.withCredentials;g.send(null)}
d.Eg.prototype.parse=function(a,b){var c=new d.u,e=void 0!==a.scale?1/a.scale:1;(function(b){var e,h,k,l,n,q,r,s,u,w,v,y,z,x=a.j;q=a.e;var C=a.cg,E=a.ka,A=0;if(void 0!==a.Ed){for(e=0;e<a.Ed.length;e++)a.Ed[e].length&&A++;for(e=0;e<A;e++)c.D[e]=[]}l=0;for(n=q.length;l<n;)e=new d.b,e.x=q[l++]*b,e.y=q[l++]*b,e.z=q[l++]*b,c.e.push(e);l=0;for(n=x.length;l<n;)if(b=x[l++],u=b&1,k=b&2,e=b&8,r=b&16,w=b&32,q=b&64,b&=128,u){u=new d.P;u.N=x[l];u.i=x[l+1];u.O=x[l+3];v=new d.P;v.N=x[l+1];v.i=x[l+2];v.O=x[l+3];
l+=4;k&&(k=x[l++],u.Hb=k,v.Hb=k);k=c.j.length;if(e)for(e=0;e<A;e++)for(y=a.Ed[e],c.D[e][k]=[],c.D[e][k+1]=[],h=0;4>h;h++)s=x[l++],z=y[2*s],s=y[2*s+1],z=new d.g(z,s),2!==h&&c.D[e][k].push(z),0!==h&&c.D[e][k+1].push(z);r&&(r=3*x[l++],u.F.set(C[r++],C[r++],C[r]),v.F.c(u.F));if(w)for(e=0;4>e;e++)r=3*x[l++],w=new d.b(C[r++],C[r++],C[r]),2!==e&&u.na.push(w),0!==e&&v.na.push(w);q&&(q=x[l++],q=E[q],kb(u.color,q),kb(v.color,q));if(b)for(e=0;4>e;e++)q=x[l++],q=E[q],2!==e&&u.s.push(new d.q(q)),0!==e&&v.s.push(new d.q(q));
c.j.push(u);c.j.push(v)}else{u=new d.P;u.N=x[l++];u.i=x[l++];u.O=x[l++];k&&(k=x[l++],u.Hb=k);k=c.j.length;if(e)for(e=0;e<A;e++)for(y=a.Ed[e],c.D[e][k]=[],h=0;3>h;h++)s=x[l++],z=y[2*s],s=y[2*s+1],z=new d.g(z,s),c.D[e][k].push(z);r&&(r=3*x[l++],u.F.set(C[r++],C[r++],C[r]));if(w)for(e=0;3>e;e++)r=3*x[l++],w=new d.b(C[r++],C[r++],C[r]),u.na.push(w);q&&(q=x[l++],kb(u.color,E[q]));if(b)for(e=0;3>e;e++)q=x[l++],u.s.push(new d.q(E[q]));c.j.push(u)}})(e);(function(){var b=void 0!==a.To?a.To:2;if(a.Sb)for(var e=
0,h=a.Sb.length;e<h;e+=b)c.Sb.push(new d.bc(a.Sb[e],1<b?a.Sb[e+1]:0,2<b?a.Sb[e+2]:0,3<b?a.Sb[e+3]:0));if(a.Kb)for(e=0,h=a.Kb.length;e<h;e+=b)c.Kb.push(new d.bc(a.Kb[e],1<b?a.Kb[e+1]:0,2<b?a.Kb[e+2]:0,3<b?a.Kb[e+3]:0));c.Z=a.Z;c.Z&&0<c.Z.length&&(c.Sb.length!==c.Kb.length||c.Kb.length!==c.e.length)&&console.warn("When skinning, number of vertices ("+c.e.length+"), skinIndices ("+c.Kb.length+"), and skinWeights ("+c.Sb.length+") should match.");c.Sn=a.Sn;c.rd=a.rd})();(function(b){if(void 0!==a.w){var e,
h,k,l,n,q;e=0;for(h=a.w.length;e<h;e++)for(c.w[e]={},c.w[e].name=a.w[e].name,c.w[e].e=[],n=c.w[e].e,q=a.w[e].e,k=0,l=q.length;k<l;k+=3){var r=new d.b;r.x=q[k]*b;r.y=q[k+1]*b;r.z=q[k+2]*b;n.push(r)}}if(void 0!==a.Ad)for(e=0,h=a.Ad.length;e<h;e++)for(c.Ad[e]={},c.Ad[e].name=a.Ad[e].name,c.Ad[e].ka=[],l=c.Ad[e].ka,n=a.Ad[e].ka,b=0,k=n.length;b<k;b+=3)q=new d.q(16755200),cb(q,n[b],n[b+1],n[b+2]),l.push(q)})(e);c.kb();c.Ne();if(void 0===a.Va||0===a.Va.length)return{k:c};e=cd(this,a.Va,b);bd(e)&&c.Sk();
return{k:c,Va:e}};d.Lm=function(){var a=this,b=0,c=0;this.Cl=this.Bl=void 0;this.kl=function(){c++};this.jl=function(e){b++;void 0!==a.Cl&&a.Cl(e,b,c);b===c&&void 0!==a.Bl&&a.Bl()}};d.ve=new d.Lm;d.Fj=function(a){this.hc=void 0!==a?a:d.ve};
d.Fj.prototype={load:function(a,b,c,e){var f=this,g=new d.Ng;g.Xc(this.crossOrigin);g.load(a,function(a){b(f.parse(JSON.parse(a)))},c,e)},Xc:function(a){this.crossOrigin=a},parse:function(a){var b=new d.wa,c=a.attributes,e;for(e in c){var f=c[e];b.attributes[e]={Vc:f.Vc,d:new self[f.type](f.d)}}c=a.Qb;void 0!==c&&(b.Qb=JSON.parse(JSON.stringify(c)));a=a.Ra;void 0!==a&&(b.Ra=new d.$b((new d.b).Fb(void 0!==a.ia?a.ia:[0,0,0]),a.ea));return b}};d.Tj=function(a){this.hc=void 0!==a?a:d.ve};
d.Tj.prototype={load:function(a,b,c,e){var f=this,g=new d.Ng;g.Xc(this.crossOrigin);g.load(a,function(a){b(f.parse(JSON.parse(a)))},c,e)},Xc:function(a){this.crossOrigin=a},parse:function(a){var b=new d[a.type];void 0!==a.color&&kb(b.color,a.color);void 0!==a.ta&&kb(b.ta,a.ta);void 0!==a.Sa&&kb(b.Sa,a.Sa);void 0!==a.lc&&kb(b.lc,a.lc);void 0!==a.ed&&(b.ed=a.ed);void 0!==a.M&&(b.M=a.M);void 0!==a.J&&(b.J=a.J);void 0!==a.I&&(b.I=a.I);void 0!==a.s&&(b.s=a.s);void 0!==a.Pa&&(b.Pa=a.Pa);void 0!==a.Jb&&
(b.Jb=a.Jb);void 0!==a.opacity&&(b.opacity=a.opacity);void 0!==a.eb&&(b.eb=a.eb);void 0!==a.V&&(b.V=a.V);if(void 0!==a.Va)for(var c=0,e=a.Va.length;c<e;c++)b.Va.push(this.parse(a.Va[c]));return b}};d.Tm=function(a){this.hc=void 0!==a?a:d.ve};
d.Tm.prototype={load:function(a,b,c,e){var f=this,g=new d.Ng(f.hc);g.Xc(this.crossOrigin);g.load(a,function(a){b(f.parse(JSON.parse(a)))},c,e)},Xc:function(a){this.crossOrigin=a},parse:function(a){var b=a.We,c={};if(void 0!==b)for(var e=new d.Eg,f=new d.Fj,g=0,h=b.length;g<h;g++){var k,l=b[g];switch(l.type){case "PlaneGeometry":k=new d.bk(l.width,l.height,l.Qh,l.Vf);break;case "BoxGeometry":case "CubeGeometry":k=new d.yg(l.width,l.height,l.depth,l.Qh,l.Vf,l.Li);break;case "CircleGeometry":k=new d.Gj(l.ea,
l.zs);break;case "CylinderGeometry":k=new d.Cg(l.ss,l.rs,l.height,l.Ll,l.Vf,l.js);break;case "SphereGeometry":k=new d.Lg(l.ea,l.Qh,l.Vf,l.ms,l.ls,l.Fs,l.Es);break;case "IcosahedronGeometry":k=new d.Qj(l.ea,l.detail);break;case "TorusGeometry":k=new d.ok(l.ea,l.Yp,l.Ll,l.Zp,l.arc);break;case "TorusKnotGeometry":k=new d.pk(l.ea,l.Yp,l.Ll,l.Zp,l.wh,l.ps,l.tr);break;case "BufferGeometry":k=f.parse(l.data);break;case "Geometry":k=e.parse(l.data).k}k.Tb=l.Tb;void 0!==l.name&&(k.name=l.name);c[l.Tb]=k}b=
a.Va;e={};if(void 0!==b)for(f=new d.Tj,g=0,h=b.length;g<h;g++)k=b[g],l=f.parse(k),l.Tb=k.Tb,void 0!==k.name&&(l.name=k.name),e[k.Tb]=l;return this.Fl(a.object,c,e)},Fl:function(){var a=new d.S;return function(b,c,e){var f;switch(b.type){case "Scene":f=new d.Pd;break;case "PerspectiveCamera":f=new d.zb(b.Of,b.Xg,b.Xa,b.Ta);break;case "OrthographicCamera":f=new d.Ce(b.left,b.right,b.top,b.bottom,b.Xa,b.Ta);break;case "AmbientLight":f=new d.se(b.color);break;case "DirectionalLight":f=new d.vb(b.color,
b.ja);break;case "PointLight":f=new d.ld(b.color,b.ja,b.Da);break;case "SpotLight":f=new d.Oc(b.color,b.ja,b.Da,b.xf,b.eh);break;case "HemisphereLight":f=new d.xe(b.color,b.Uf,b.ja);break;case "Mesh":f=c[b.k];var g=e[b.r];void 0===f&&console.error("THREE.ObjectLoader: Undefined geometry "+b.k);void 0===g&&console.error("THREE.ObjectLoader: Undefined material "+b.r);f=new d.Y(f,g);break;case "Sprite":g=e[b.r];void 0===g&&console.error("THREE.ObjectLoader: Undefined material "+b.r);f=new d.Pc(g);break;
default:f=new d.A}f.Tb=b.Tb;void 0!==b.name&&(f.name=b.name);void 0!==b.da?(a.Fb(b.da),a.bh(f.position,f.cb,f.scale)):(void 0!==b.position&&f.position.Fb(b.position),void 0!==b.rotation&&f.rotation.Fb(b.rotation),void 0!==b.scale&&f.scale.Fb(b.scale));void 0!==b.visible&&(f.visible=b.visible);void 0!==b.xg&&(f.xg=b.xg);if(void 0!==b.children)for(var h in b.children)f.add(this.Fl(b.children[h],c,e));return f}}()};d.sn=function(a){this.hc=void 0!==a?a:d.ve};
d.sn.prototype={load:function(a,b,c,e){var f=new d.pf(this.hc);f.Xc(this.crossOrigin);f.load(a,function(a){a=new d.xa(a);a.H=!0;void 0!==b&&b(a)},c,e)},Xc:function(a){this.crossOrigin=a}};d.R=function(){this.id=d.Pm++;this.Tb=d.Math.Pf();this.name="";this.Jb=d.Nj;this.opacity=1;this.eb=!1;this.Pa=d.gi;this.ae=d.mk;this.$d=d.Zj;this.blendEquation=d.Aj;this.Ec=this.Dc=!0;this.polygonOffset=!1;this.$e=this.Wd=this.kg=this.jg=0;this.H=this.visible=!0};
d.R.prototype={clone:function(a){void 0===a&&(a=new d.R);a.name=this.name;a.Jb=this.Jb;a.opacity=this.opacity;a.eb=this.eb;a.Pa=this.Pa;a.ae=this.ae;a.$d=this.$d;a.blendEquation=this.blendEquation;a.Dc=this.Dc;a.Ec=this.Ec;a.polygonOffset=this.polygonOffset;a.jg=this.jg;a.kg=this.kg;a.Wd=this.Wd;a.$e=this.$e;a.visible=this.visible;return a}};
function ed(a,b){if(void 0!==b)for(var c in b){var e=b[c];if(void 0===e)console.warn("THREE.Material: '"+c+"' parameter is undefined.");else if(c in a){var f=a[c];f instanceof d.q?f.set(e):f instanceof d.b&&e instanceof d.b?f.c(e):a[c]="overdraw"==c?Number(e):e}}}d.Xb.prototype.apply(d.R.prototype);d.Pm=0;d.Ba=function(a){d.R.call(this);this.color=new d.q(16777215);this.nb=1;this.qh=this.ph="round";this.s=d.Ld;this.L=!0;ed(this,a)};d.Ba.prototype=Object.create(d.R.prototype);
d.Ba.prototype.clone=function(){var a=new d.Ba;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.nb=this.nb;a.ph=this.ph;a.qh=this.qh;a.s=this.s;a.L=this.L;return a};d.ze=function(a){d.R.call(this);this.color=new d.q(16777215);this.scale=this.nb=1;this.Pe=3;this.gh=1;this.s=!1;this.L=!0;ed(this,a)};d.ze.prototype=Object.create(d.R.prototype);
d.ze.prototype.clone=function(){var a=new d.ze;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.nb=this.nb;a.scale=this.scale;a.Pe=this.Pe;a.gh=this.gh;a.s=this.s;a.L=this.L;return a};d.xb=function(a){d.R.call(this);this.color=new d.q(16777215);this.qa=this.bb=this.Na=this.Ua=this.map=null;this.Ac=d.fi;this.Kc=1;this.Lc=.98;this.L=!0;this.Ma=d.Qd;this.V=!1;this.Aa=1;this.oc=this.nc="round";this.s=d.Ld;this.w=this.va=!1;ed(this,a)};d.xb.prototype=Object.create(d.R.prototype);
d.xb.prototype.clone=function(){var a=new d.xb;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.map=this.map;a.Ua=this.Ua;a.Na=this.Na;a.bb=this.bb;a.qa=this.qa;a.Ac=this.Ac;a.Kc=this.Kc;a.Lc=this.Lc;a.L=this.L;a.Ma=this.Ma;a.V=this.V;a.Aa=this.Aa;a.nc=this.nc;a.oc=this.oc;a.s=this.s;a.va=this.va;a.w=this.w;return a};
d.sc=function(a){d.R.call(this);this.color=new d.q(16777215);this.ta=new d.q(16777215);this.Sa=new d.q(0);this.pc=!1;this.gd=new d.b(1,1,1);this.qa=this.bb=this.Na=this.Ua=this.map=null;this.Ac=d.fi;this.Kc=1;this.Lc=.98;this.L=!0;this.Ma=d.Qd;this.V=!1;this.Aa=1;this.oc=this.nc="round";this.s=d.Ld;this.Ja=this.w=this.va=!1;ed(this,a)};d.sc.prototype=Object.create(d.R.prototype);
d.sc.prototype.clone=function(){var a=new d.sc;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.ta.c(this.ta);a.Sa.c(this.Sa);a.pc=this.pc;a.gd.c(this.gd);a.map=this.map;a.Ua=this.Ua;a.Na=this.Na;a.bb=this.bb;a.qa=this.qa;a.Ac=this.Ac;a.Kc=this.Kc;a.Lc=this.Lc;a.L=this.L;a.Ma=this.Ma;a.V=this.V;a.Aa=this.Aa;a.nc=this.nc;a.oc=this.oc;a.s=this.s;a.va=this.va;a.w=this.w;a.Ja=this.Ja;return a};
d.Yb=function(a){d.R.call(this);this.color=new d.q(16777215);this.ta=new d.q(16777215);this.Sa=new d.q(0);this.lc=new d.q(1118481);this.ed=30;this.pc=this.$f=!1;this.gd=new d.b(1,1,1);this.sb=this.Ua=this.map=null;this.Cf=1;this.ob=null;this.uh=new d.g(1,1);this.qa=this.bb=this.Na=null;this.Ac=d.fi;this.Kc=1;this.Lc=.98;this.L=!0;this.Ma=d.Qd;this.V=!1;this.Aa=1;this.oc=this.nc="round";this.s=d.Ld;this.Ja=this.w=this.va=!1;ed(this,a)};d.Yb.prototype=Object.create(d.R.prototype);
d.Yb.prototype.clone=function(){var a=new d.Yb;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.ta.c(this.ta);a.Sa.c(this.Sa);a.lc.c(this.lc);a.ed=this.ed;a.$f=this.$f;a.pc=this.pc;a.gd.c(this.gd);a.map=this.map;a.Ua=this.Ua;a.sb=this.sb;a.Cf=this.Cf;a.ob=this.ob;a.uh.c(this.uh);a.Na=this.Na;a.bb=this.bb;a.qa=this.qa;a.Ac=this.Ac;a.Kc=this.Kc;a.Lc=this.Lc;a.L=this.L;a.Ma=this.Ma;a.V=this.V;a.Aa=this.Aa;a.nc=this.nc;a.oc=this.oc;a.s=this.s;a.va=this.va;a.w=this.w;a.Ja=this.Ja;return a};
d.Kd=function(a){d.R.call(this);this.V=this.w=!1;this.Aa=1;ed(this,a)};d.Kd.prototype=Object.create(d.R.prototype);d.Kd.prototype.clone=function(){var a=new d.Kd;d.R.prototype.clone.call(this,a);a.V=this.V;a.Aa=this.Aa;return a};d.Ae=function(a){d.R.call(this);this.Ma=d.Wh;this.V=!1;this.Aa=1;this.w=!1;ed(this,a)};d.Ae.prototype=Object.create(d.R.prototype);d.Ae.prototype.clone=function(){var a=new d.Ae;d.R.prototype.clone.call(this,a);a.Ma=this.Ma;a.V=this.V;a.Aa=this.Aa;return a};
d.jd=function(a){this.Va=a instanceof Array?a:[]};d.jd.prototype.clone=function(){for(var a=new d.jd,b=0;b<this.Va.length;b++)a.Va.push(this.Va[b].clone());return a};d.uc=function(a){d.R.call(this);this.color=new d.q(16777215);this.map=null;this.size=1;this.vg=!0;this.s=d.Ld;this.L=!0;ed(this,a)};d.uc.prototype=Object.create(d.R.prototype);
d.uc.prototype.clone=function(){var a=new d.uc;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.map=this.map;a.size=this.size;a.vg=this.vg;a.s=this.s;a.L=this.L;return a};d.Eq=function(a){console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointCloudMaterial.");return new d.uc(a)};d.Hq=function(a){console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointCloudMaterial.");return new d.uc(a)};
d.Fa=function(a){d.R.call(this);this.Jf={};this.M={};this.attributes=null;this.J="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}";this.I="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";this.Ma=d.Qd;this.nb=1;this.V=!1;this.Aa=1;this.Wc=this.L=!1;this.s=d.Ld;this.Ja=this.w=this.va=!1;this.fc={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.So=void 0;ed(this,a)};d.Fa.prototype=Object.create(d.R.prototype);
d.Fa.prototype.clone=function(){var a=new d.Fa;d.R.prototype.clone.call(this,a);a.I=this.I;a.J=this.J;a.M=d.ac.clone(this.M);a.attributes=this.attributes;a.Jf=this.Jf;a.Ma=this.Ma;a.V=this.V;a.Aa=this.Aa;a.L=this.L;a.Wc=this.Wc;a.s=this.s;a.va=this.va;a.w=this.w;a.Ja=this.Ja;return a};d.Jg=function(a){d.Fa.call(this,a)};d.Jg.prototype=Object.create(d.Fa.prototype);d.Jg.prototype.clone=function(){var a=new d.Jg;d.Fa.prototype.clone.call(this,a);return a};
d.sf=function(a){d.R.call(this);this.color=new d.q(16777215);this.map=null;this.rotation=0;this.L=!1;ed(this,a)};d.sf.prototype=Object.create(d.R.prototype);d.sf.prototype.clone=function(){var a=new d.sf;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.map=this.map;a.rotation=this.rotation;a.L=this.L;return a};d.rf=function(a){d.R.call(this);this.color=new d.q(16777215);this.Ya=function(){};ed(this,a)};d.rf.prototype=Object.create(d.R.prototype);
d.rf.prototype.clone=function(){var a=new d.rf;d.R.prototype.clone.call(this,a);a.color.c(this.color);a.Ya=this.Ya;return a};d.Fq=d.rf;
d.xa=function(a,b,c,e,f,g,h,k,l){this.id=d.rn++;this.Tb=d.Math.Pf();this.name="";this.$=void 0!==a?a:d.xa.vm;this.ag=[];this.Ze=void 0!==b?b:d.xa.wm;this.qc=void 0!==c?c:d.kf;this.rc=void 0!==e?e:d.kf;this.Pb=void 0!==f?f:d.Jd;this.ub=void 0!==g?g:d.ci;this.dc=void 0!==l?l:1;this.format=void 0!==h?h:d.Nd;this.type=void 0!==k?k:d.qi;this.offset=new d.g(0,0);this.repeat=new d.g(1,1);this.Ob=!0;this.ej=!1;this.Ue=!0;this.yj=4;this.Hk=!1;this.vh=null};d.xa.vm=void 0;d.xa.wm=new d.qk;
d.xa.prototype={get H(){return this.Hk},set H(a){!0===a&&this.update();this.Hk=a},clone:function(a){void 0===a&&(a=new d.xa);a.$=this.$;a.ag=this.ag.slice(0);a.Ze=this.Ze;a.qc=this.qc;a.rc=this.rc;a.Pb=this.Pb;a.ub=this.ub;a.dc=this.dc;a.format=this.format;a.type=this.type;a.offset.c(this.offset);a.repeat.c(this.repeat);a.Ob=this.Ob;a.ej=this.ej;a.Ue=this.Ue;a.yj=this.yj;return a},update:function(){this.dispatchEvent({type:"update"})}};d.Xb.prototype.apply(d.xa.prototype);d.rn=0;
d.lf=function(a,b,c,e,f,g,h,k,l){d.xa.call(this,a,b,c,e,f,g,h,k,l);this.images=a};d.lf.prototype=Object.create(d.xa.prototype);d.lf.clone=function(a){void 0===a&&(a=new d.lf);d.xa.prototype.clone.call(this,a);a.images=this.images;return a};d.ue=function(a,b,c,e,f,g,h,k,l,n,q){d.xa.call(this,null,g,h,k,l,n,e,f,q);this.$={width:b,height:c};this.ag=a;this.Ob=!1};d.ue.prototype=Object.create(d.xa.prototype);d.ue.prototype.clone=function(){var a=new d.ue;d.xa.prototype.clone.call(this,a);return a};
d.Hd=function(a,b,c,e,f,g,h,k,l,n,q){d.xa.call(this,null,g,h,k,l,n,e,f,q);this.$={data:a,width:b,height:c}};d.Hd.prototype=Object.create(d.xa.prototype);d.Hd.prototype.clone=function(){var a=new d.Hd;d.xa.prototype.clone.call(this,a);return a};d.Ab=function(a,b){d.A.call(this);this.k=void 0!==a?a:new d.u;this.r=void 0!==b?b:new d.uc({color:16777215*Math.random()});this.qe=!1};d.Ab.prototype=Object.create(d.A.prototype);
d.Ab.prototype.clone=function(a){void 0===a&&(a=new d.Ab(this.k,this.r));a.qe=this.qe;d.A.prototype.clone.call(this,a);return a};d.Gq=function(a,b){console.warn("THREE.ParticleSystem has been renamed to THREE.PointCloud.");return new d.Ab(a,b)};d.U=function(a,b,c){d.A.call(this);this.k=void 0!==a?a:new d.u;this.r=void 0!==b?b:new d.Ba({color:16777215*Math.random()});this.type=void 0!==c?c:d.bi};d.bi=0;d.Mb=1;d.U.prototype=Object.create(d.A.prototype);
d.U.prototype.clone=function(a){void 0===a&&(a=new d.U(this.k,this.r,this.type));d.A.prototype.clone.call(this,a);return a};d.Y=function(a,b){d.A.call(this);this.k=void 0!==a?a:new d.u;this.r=void 0!==b?b:new d.xb({color:16777215*Math.random()});if(void 0!==this.k.w&&0<this.k.w.length){this.Zi=-1;this.yl=[];this.Wa=[];this.ip={};for(var c=0,e=this.k.w.length;c<e;c++)this.Wa.push(0),this.ip[this.k.w[c].name]=c}};d.Y.prototype=Object.create(d.A.prototype);
d.Y.prototype.clone=function(a,b){void 0===a&&(a=new d.Y(this.k,this.r));d.A.prototype.clone.call(this,a,b);return a};d.Vb=function(){d.A.call(this);this.Wg=this.Vd=this.Ke=0};d.Vb.prototype=Object.create(d.A.prototype);d.Vb.prototype.ra=function(a){d.A.prototype.ra.call(this,a);this.Wg=this.Vd=this.Ke=0};
d.jk=function(a,b,c){this.fd=void 0!==c?c:!0;this.Qo=new d.S;a=a||[];this.Z=a.slice(0);this.fd?(this.Af=this.Bf=a=256<this.Z.length?64:64<this.Z.length?32:16<this.Z.length?16:8,this.zf=new Float32Array(this.Bf*this.Af*4),this.sd=new d.Hd(this.zf,this.Bf,this.Af,d.Nd,d.Xh),this.sd.ub=d.Be,this.sd.Pb=d.Be,this.sd.Ob=!1,this.sd.Ue=!1):this.zf=new Float32Array(16*this.Z.length);if(void 0===b)for(this.yf=[],b=0,a=this.Z.length;b<a;b++)c=new d.S,this.Z[b]&&c.Gb(this.Z[b].m),this.yf.push(c);else if(this.Z.length===
b.length)this.yf=b.slice(0);else for(console.warn("THREE.Skeleton bonInverses is the wrong length."),this.yf=[],b=0,a=this.Z.length;b<a;b++)this.yf.push(new d.S)};d.jk.prototype.update=function(){for(var a=new d.S,b=0,c=this.Z.length;b<c;b++)cc(a,this.Z[b]?this.Z[b].m:this.Qo,this.yf[b]),a.fh(this.zf,16*b);this.fd&&(this.sd.H=!0)};
d.vc=function(a,b,c){d.Y.call(this,a,b);this.Di="attached";this.Me=new d.S;this.Zd=new d.S;a=[];if(this.k&&void 0!==this.k.Z){for(var e,f,g,h,k=0,l=this.k.Z.length;k<l;++k)e=this.k.Z[k],f=e.Hl,g=e.ys,h=e.Rl,b=new d.Vb,a.push(b),b.name=e.name,b.position.set(f[0],f[1],f[2]),b.cb.set(g[0],g[1],g[2],g[3]),void 0!==h?b.scale.set(h[0],h[1],h[2]):b.scale.set(1,1,1);k=0;for(l=this.k.Z.length;k<l;++k)e=this.k.Z[k],-1!==e.parent?a[e.parent].add(a[k]):this.add(a[k])}if(this.k instanceof d.u)for(b=0;b<this.k.Kb.length;b++)e=
this.k.Sb[b],f=1/e.nl(),Infinity!==f?e.G(f):e.set(1);this.ra(!0);this.bind(new d.jk(a,void 0,c))};d.vc.prototype=Object.create(d.Y.prototype);d.vc.prototype.bind=function(a,b){this.Za=a;void 0===b&&(this.ra(!0),b=this.m);this.Me.c(b);this.Zd.Gb(b)};d.vc.prototype.ra=function(){d.Y.prototype.ra.call(this,!0);"attached"===this.Di?this.Zd.Gb(this.m):"detached"===this.Di?this.Zd.Gb(this.Me):console.warn("THREE.SkinnedMesh unreckognized bindMode: "+this.Di)};
d.vc.prototype.clone=function(a){void 0===a&&(a=new d.vc(this.k,this.r,this.fd));d.Y.prototype.clone.call(this,a);return a};d.ei=function(a,b){d.Y.call(this,a,b);this.duration=1E3;this.sh=!1;this.Tk=this.ml=this.time=0;this.direction=1;this.Qe=!1;var c=this.k.w.length-1;this.Sp=0;this.yo=c;this.length=this.yo-this.Sp+1};d.ei.prototype=Object.create(d.Y.prototype);
d.ei.prototype.clone=function(a){void 0===a&&(a=new d.ei(this.k,this.r));a.duration=this.duration;a.sh=this.sh;a.time=this.time;a.ml=this.ml;a.Tk=this.Tk;a.direction=this.direction;a.Qe=this.Qe;d.Y.prototype.clone.call(this,a);return a};d.Fg=function(){d.A.call(this);this.La=[]};d.Fg.prototype=Object.create(d.A.prototype);
d.Fg.prototype.update=function(){var a=new d.b,b=new d.b;return function(c){if(1<this.La.length){Cb(a,c.m);Cb(b,this.m);c=a.mb(b);this.La[0].object.visible=!0;for(var e=1,f=this.La.length;e<f;e++)if(c>=this.La[e].Da)this.La[e-1].object.visible=!1,this.La[e].object.visible=!0;else break;for(;e<f;e++)this.La[e].object.visible=!1}}}();
d.Fg.prototype.clone=function(a){void 0===a&&(a=new d.Fg);d.A.prototype.clone.call(this,a);for(var b=0,c=this.La.length;b<c;b++){var e=this.La[b].object.clone();e.visible=0===b;var f=a,g=this.La[b].Da;void 0===g&&(g=0);for(var g=Math.abs(g),h=0;h<f.La.length&&!(g<f.La[h].Da);h++);f.La.splice(h,0,{Da:g,object:e});f.add(e)}return a};
d.Pc=function(){var a=new Float32Array([-.5,-.5,0,.5,-.5,0,.5,.5,0]),b=new d.wa;Zc(b,"position",new d.ab(a,3));return function(a){d.A.call(this);this.k=b;this.r=void 0!==a?a:new d.sf}}();d.Pc.prototype=Object.create(d.A.prototype);d.Pc.prototype.Dd=function(){qc(this.da,this.position,this.cb,this.scale);this.ic=!0};d.Pc.prototype.clone=function(a){void 0===a&&(a=new d.Pc(this.r));d.A.prototype.clone.call(this,a);return a};d.Dq=d.Pc;
d.Pd=function(){d.A.call(this);this.hg=this.L=null;this.Le=!0;this.oa=!1;this.Bb=[];this.Ge=[];this.He=[]};d.Pd.prototype=Object.create(d.A.prototype);
function Lc(a,b){if(b instanceof d.sa)-1===a.Bb.indexOf(b)&&a.Bb.push(b),b.target&&void 0===b.target.parent&&a.add(b.target);else if(!(b instanceof d.hb||b instanceof d.Vb)){a.Ge.push(b);var c=a.He.indexOf(b);-1!==c&&a.He.splice(c,1)}a.dispatchEvent({type:"objectAdded",object:b});b.dispatchEvent({type:"addedToScene",Cd:a});for(c=0;c<b.children.length;c++)Lc(a,b.children[c])}
function Mc(a,b){if(b instanceof d.sa){var c=a.Bb.indexOf(b);-1!==c&&a.Bb.splice(c,1);if(b.oe)for(c=0;c<b.oe.length;c++)Mc(a,b.oe[c])}else b instanceof d.hb||(a.He.push(b),c=a.Ge.indexOf(b),-1!==c&&a.Ge.splice(c,1));a.dispatchEvent({type:"objectRemoved",object:b});b.dispatchEvent({type:"removedFromScene",Cd:a});for(c=0;c<b.children.length;c++)Mc(a,b.children[c])}
d.Pd.prototype.clone=function(a){void 0===a&&(a=new d.Pd);d.A.prototype.clone.call(this,a);null!==this.L&&(a.L=this.L.clone());null!==this.hg&&(a.hg=this.hg.clone());a.Le=this.Le;a.oa=this.oa;return a};d.Dg=function(a,b,c){this.name="";this.color=new d.q(a);this.Xa=void 0!==b?b:1;this.Ta=void 0!==c?c:1E3};d.Dg.prototype.clone=function(){return new d.Dg(pb(this.color),this.Xa,this.Ta)};d.of=function(a,b){this.name="";this.color=new d.q(a);this.Ki=void 0!==b?b:2.5E-4};
d.of.prototype.clone=function(){return new d.of(pb(this.color),this.Ki)};
d.iq=function(a){function b(a,b,c,e){n(b);q(c);r(e);s(ob(a));Q.stroke();ta.Te(2*b)}function c(a){u(ob(a));Q.fill()}function e(a){f(a.target)}function f(a){if(!(a instanceof d.ue)){var b=a.qc===d.De,c=a.rc===d.De,e=a.$,f=document.createElement("canvas");f.width=e.width;f.height=e.height;var g=f.getContext("2d");g.setTransform(1,0,0,-1,0,e.height);g.drawImage(e,0,0);db[a.id]=Q.createPattern(f,!0===b&&!0===c?"repeat":!0===b&&!1===c?"repeat-x":!1===b&&!0===c?"repeat-y":"no-repeat")}}function g(a,b,c,
g,h,k,l,n,q,s,v,r,w){if(!(w instanceof d.Hd)){!1===w.kh("update",e)&&(void 0!==w.$&&0<w.$.width&&f(w),w.addEventListener("update",e));var x=db[w.id];if(void 0!==x){u(x);var x=w.offset.x/w.repeat.x,z=w.offset.y/w.repeat.y,y=w.$.width*w.repeat.x;w=w.$.height*w.repeat.y;l=(l+x)*y;n=(n+z)*w;c-=a;g-=b;h-=a;k-=b;q=(q+x)*y-l;s=(s+z)*w-n;v=(v+x)*y-l;r=(r+z)*w-n;w=q*r-v*s;0!==w&&(x=1/w,w=(r*c-s*h)*x,s=(r*g-s*k)*x,c=(q*h-v*c)*x,g=(q*k-v*g)*x,a=a-w*l-c*n,b=b-s*l-g*n,Q.save(),Q.transform(w,s,c,g,a,b),Q.fill(),
Q.restore())}else u("rgba(0,0,0,1)"),Q.fill()}}function h(a,b,c){var e=b.x-a.x,f=b.y-a.y,g=e*e+f*f;0!==g&&(c/=Math.sqrt(g),e*=c,f*=c,b.x+=e,b.y+=f,a.x-=e,a.y-=f)}function k(a){G!==a&&(G=Q.globalAlpha=a)}function l(a){K!==a&&(a===d.gi?Q.globalCompositeOperation="source-over":a===d.Bj?Q.globalCompositeOperation="lighter":a===d.nk&&(Q.globalCompositeOperation="darker"),K=a)}function n(a){R!==a&&(R=Q.lineWidth=a)}function q(a){V!==a&&(V=Q.lineCap=a)}function r(a){U!==a&&(U=Q.lineJoin=a)}function s(a){J!==
a&&(J=Q.strokeStyle=a)}function u(a){ba!==a&&(ba=Q.fillStyle=a)}function w(a){ca.length!==a.length&&(Q.setLineDash(a),ca=a)}console.log("THREE.CanvasRenderer",d.ek);var v=d.Math.Hp;a=a||{};var y=this,z,x,C,E=new d.hi,A=void 0!==a.canvas?a.canvas:document.createElement("canvas"),H=A.width,B=A.height,D=Math.floor(H/2),F=Math.floor(B/2),L=0,M=0,ea=H,T=B,Q=A.getContext("2d",{alpha:!0===a.alpha}),P=new d.q(0),G=1,K=0,J=null,ba=null,R=null,V=null,U=null,ca=[],S,Y,da,aa,ua,Ca,na,Ua,Ga,va,sa=new d.q;new d.q;
new d.q;new d.q;new d.q;var Va=new d.q,gb=new d.q,Ta=new d.q,db={},Aa,oa,N,La,Ea,pa,Ja,qa=new d.jf,la=new d.jf,ta=new d.jf,Ra=new d.q,Pa=new d.q,Ha=new d.q,$a=new d.b,Qa=new d.b,ga=new d.b,Da=new d.Nb;void 0===Q.setLineDash&&(Q.setLineDash=function(){});this.Yk=A;this.devicePixelRatio=void 0!==a.devicePixelRatio?a.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.Ip=this.Jh=this.yi=!0;this.info={t:{e:0,j:0}};this.vj=function(){};this.oj=function(a,b,c){H=a*this.devicePixelRatio;
B=b*this.devicePixelRatio;A.width=H;A.height=B;D=Math.floor(H/2);F=Math.floor(B/2);!1!==c&&(A.style.width=a+"px",A.style.height=b+"px");qa.min.set(-D,-F);qa.max.set(D,F);la.min.set(-D,-F);la.max.set(D,F);G=1;K=0;U=V=R=ba=J=null;this.pj(0,0,a,b)};this.pj=function(a,b,c,e){L=a*this.devicePixelRatio;M=b*this.devicePixelRatio;ea=c*this.devicePixelRatio;T=e*this.devicePixelRatio};this.Si=function(){return P};this.clear=function(){!1===la.empty()&&(la.hl(qa),la.Te(2),la.min.x+=D,la.min.y=-la.min.y+F,la.max.x+=
D,la.max.y=-la.max.y+F,Q.clearRect(la.min.x|0,la.min.y|0,la.max.x-la.min.x|0,la.max.y-la.min.y|0),la.zd())};this.clearColor=function(){};this.clearDepth=function(){};this.clearStencil=function(){};this.t=function(a,A){if(!1===A instanceof d.hb)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.yi&&this.clear();y.info.t.e=0;y.info.t.j=0;Q.setTransform(ea/H,0,0,-T/B,L,B-M);Q.translate(D,F);z=E.tp(a,A,this.Jh,this.Ip);x=z.elements;C=z.Wc;S=A;bc(Da,
A.Ea);cb(Ra,0,0,0);cb(Pa,0,0,0);cb(Ha,0,0,0);for(var J=0,K=C.length;J<K;J++){var G=C[J],P=G.color;G instanceof d.se?Ra.add(P):G instanceof d.vb?Pa.add(P):G instanceof d.ld&&Ha.add(P)}J=0;for(K=x.length;J<K;J++){var R=x[J],ba=R.r;if(void 0!==ba&&0!==ba.opacity){ta.zd();if(R instanceof d.hk){Y=R;Y.x*=D;Y.y*=F;var G=Y,W=R,P=ba;k(P.opacity);l(P.Pa);var U=W.scale.x*D,W=W.scale.y*F,R=.5*Math.sqrt(U*U+W*W);ta.min.set(G.x-R,G.y-R);ta.max.set(G.x+R,G.y+R);if(P instanceof d.sf){var V=P.map;if(null!==V&&void 0!==
V.$){!1===V.kh("update",e)&&(0<V.$.width&&f(V),V.addEventListener("update",e));R=db[V.id];void 0!==R?u(R):u("rgba( 0, 0, 0, 1 )");var ca=V.$,R=ca.width*V.offset.x,ba=ca.height*V.offset.y,Ia=ca.width*V.repeat.x,V=ca.height*V.repeat.y,ca=U/Ia,Pb=W/V;Q.save();Q.translate(G.x,G.y);0!==P.rotation&&Q.rotate(P.rotation);Q.translate(-U/2,-W/2);Q.scale(ca,Pb);Q.translate(-R,-ba);Q.fillRect(R,ba,Ia,V)}else u(ob(P.color)),Q.save(),Q.translate(G.x,G.y),0!==P.rotation&&Q.rotate(P.rotation),Q.scale(U,-W),Q.fillRect(-.5,
-.5,1,1);Q.restore()}else P instanceof d.rf&&(s(ob(P.color)),u(ob(P.color)),Q.save(),Q.translate(G.x,G.y),0!==P.rotation&&Q.rotate(P.rotation),Q.scale(U,W),P.Ya(Q),Q.restore())}else if(R instanceof d.gk){if(Y=R.X,da=R.ba,Y.l.x*=D,Y.l.y*=F,da.l.x*=D,da.l.y*=F,ta.Yc([Y.l,da.l]),!0===qa.Wf(ta))if(G=Y,P=da,U=R,W=ba,k(W.opacity),l(W.Pa),Q.beginPath(),Q.moveTo(G.l.x,G.l.y),Q.lineTo(P.l.x,P.l.y),W instanceof d.Ba){n(W.nb);q(W.ph);r(W.qh);if(W.s!==d.Rd)s(ob(W.color));else if(R=ob(U.s[0]),U=ob(U.s[1]),R===
U)s(R);else{try{var Eb=Q.createLinearGradient(G.l.x,G.l.y,P.l.x,P.l.y);Eb.addColorStop(0,R);Eb.addColorStop(1,U)}catch(wc){Eb=R}s(Eb)}Q.stroke();ta.Te(2*W.nb)}else W instanceof d.ze&&(n(W.nb),q(W.ph),r(W.qh),s(ob(W.color)),w([W.Pe,W.gh]),Q.stroke(),ta.Te(2*W.nb),w([]))}else if(R instanceof d.fk){Y=R.X;da=R.ba;aa=R.Ub;if(-1>Y.l.z||1<Y.l.z)continue;if(-1>da.l.z||1<da.l.z)continue;if(-1>aa.l.z||1<aa.l.z)continue;Y.l.x*=D;Y.l.y*=F;da.l.x*=D;da.l.y*=F;aa.l.x*=D;aa.l.y*=F;0<ba.$e&&(h(Y.l,da.l,ba.$e),h(da.l,
aa.l,ba.$e),h(aa.l,Y.l,ba.$e));ta.Yc([Y.l,da.l,aa.l]);if(!0===qa.Wf(ta)){P=Y;U=da;W=aa;G=ba;y.info.t.e+=3;y.info.t.j++;k(G.opacity);l(G.Pa);ua=P.l.x;Ca=P.l.y;na=U.l.x;Ua=U.l.y;Ga=W.l.x;va=W.l.y;var ba=ua,Ia=Ca,V=na,ca=Ua,Pb=Ga,Fa=va;Q.beginPath();Q.moveTo(ba,Ia);Q.lineTo(V,ca);Q.lineTo(Pb,Fa);Q.closePath();if((G instanceof d.sc||G instanceof d.Yb)&&null===G.map){Va.c(G.color);gb.c(G.Sa);G.s===d.nf&&Va.multiply(R.color);sa.c(Ra);Qa.c(P.cf).add(U.cf).add(W.cf).ud(3);P=Qa;U=R.bg;W=sa;R=0;for(ba=C.length;R<
ba;R++)Ia=C[R],Ta.c(Ia.color),Ia instanceof d.vb?(V=Cb($a,Ia.m).normalize(),ca=U.pa(V),0>=ca||(ca*=Ia.ja,W.add(Ta.G(ca)))):Ia instanceof d.ld&&(V=Cb($a,Ia.m),ca=U.pa($a.ca(V,P).normalize()),0>=ca||(ca*=0==Ia.Da?1:1-Math.min(P.mb(V)/Ia.Da,1),0!=ca&&(ca*=Ia.ja,W.add(Ta.G(ca)))));sa.multiply(Va).add(gb);!0===G.V?b(sa,G.Aa,G.nc,G.oc):c(sa)}else G instanceof d.xb||G instanceof d.sc||G instanceof d.Yb?null!==G.map?G.map.Ze instanceof d.qk&&(Aa=R.Ed,g(ua,Ca,na,Ua,Ga,va,Aa[0].x,Aa[0].y,Aa[1].x,Aa[1].y,Aa[2].x,
Aa[2].y,G.map)):null!==G.qa?G.qa.Ze instanceof d.jn?(Xb(ga.c(R.Fd[0]),Da),oa=.5*ga.x+.5,N=.5*ga.y+.5,Xb(ga.c(R.Fd[1]),Da),La=.5*ga.x+.5,Ea=.5*ga.y+.5,Xb(ga.c(R.Fd[2]),Da),pa=.5*ga.x+.5,Ja=.5*ga.y+.5,g(ua,Ca,na,Ua,Ga,va,oa,N,La,Ea,pa,Ja,G.qa)):G.qa.Ze instanceof d.kn&&(Xb(ga.c(R.Fd[0]),Da),oa=-.5*ga.x+.5,N=-.5*ga.y+.5,Xb(ga.c(R.Fd[1]),Da),La=-.5*ga.x+.5,Ea=-.5*ga.y+.5,Xb(ga.c(R.Fd[2]),Da),pa=-.5*ga.x+.5,Ja=-.5*ga.y+.5,g(ua,Ca,na,Ua,Ga,va,oa,N,La,Ea,pa,Ja,G.qa)):(sa.c(G.color),G.s===d.nf&&sa.multiply(R.color),
!0===G.V?b(sa,G.Aa,G.nc,G.oc):c(sa)):(G instanceof d.Kd?sa.C=sa.B=sa.i=1-v(P.l.z*P.l.f,S.Xa,S.Ta):G instanceof d.Ae?(Xb(ga.c(R.bg),Da),cb(sa,ga.x,ga.y,ga.z).G(.5).qd(.5)):cb(sa,1,1,1),!0===G.V?b(sa,G.Aa,G.nc,G.oc):c(sa))}}la.em(ta)}}Q.setTransform(1,0,0,1,0,0)}}};d.a={};d.a.alphatest_fragment="#ifdef ALPHATEST\n\n\tif ( gl_FragColor.a < ALPHATEST ) discard;\n\n#endif\n";d.a.lights_lambert_vertex="vLightFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vec3( 0.0 );\n\n#endif\n\ntransformedNormal = normalize( transformedNormal );\n\n#if MAX_DIR_LIGHTS > 0\n\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\tvec3 dirVector = normalize( lDirection.xyz );\n\n\tfloat dotProduct = dot( transformedNormal, dirVector );\n\tvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t#endif\n\n\t#endif\n\n\t#ifdef WRAP_AROUND\n\n\t\tvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\tdirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tdirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n\n\t\t#endif\n\n\t#endif\n\n\tvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n\n\t#endif\n\n}\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\tpointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tpointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t\tvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz - mvPosition.xyz;\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\tfloat lDistance = 1.0;\n\t\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\t\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n\t\t\tlVector = normalize( lVector );\n\n\t\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\t\t\tvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n\n\t\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\t\tvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\n\t\t\t\tspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n\n\t\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\t\tspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n\n\t\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t\tvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n\n\t\t\t#endif\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\tvec3 lVector = normalize( lDirection.xyz );\n\n\t\tfloat dotProduct = dot( transformedNormal, lVector );\n\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\tfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\n\n\t\tvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n\n\t\t#endif\n\n\t}\n\n#endif\n\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n\n#ifdef DOUBLE_SIDED\n\n\tvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n\n#endif";
d.a.map_particle_pars_fragment="#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";d.a.default_vertex="vec4 mvPosition;\n\n#ifdef USE_SKINNING\n\n\tmvPosition = modelViewMatrix * skinned;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\n\n\tmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\n\n\tmvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n#endif\n\ngl_Position = projectionMatrix * mvPosition;";
d.a.map_pars_fragment="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif";d.a.skinnormal_vertex="#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\t#ifdef USE_MORPHNORMALS\n\n\tvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n\n\t#else\n\n\tvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n\n\t#endif\n\n#endif\n";
d.a.logdepthbuf_pars_vertex="#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n\tuniform float logDepthBufFC;\n\n#endif";d.a.lightmap_pars_vertex="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\n#endif";d.a.lights_phong_fragment="vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n\n#ifdef DOUBLE_SIDED\n\n\tnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\n#endif\n\n#ifdef USE_NORMALMAP\n\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tvec3 pointDiffuse = vec3( 0.0 );\n\tvec3 pointSpecular = vec3( 0.0 );\n\n\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\n\t\t\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\tpointDiffuse += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\n\n\t\t\t\t// specular\n\n\t\tvec3 pointHalfVector = normalize( lVector + viewPosition );\n\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\tfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n\n\t}\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tvec3 spotDiffuse = vec3( 0.0 );\n\tvec3 spotSpecular = vec3( 0.0 );\n\n\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\n\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\tvec3 lVector = lPosition.xyz + vViewPosition.xyz;\n\n\t\tfloat lDistance = 1.0;\n\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\tlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\n\n\t\tlVector = normalize( lVector );\n\n\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\n\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\n\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\n\t\t\t\t\t// diffuse\n\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\n\t\t\t#ifdef WRAP_AROUND\n\n\t\t\t\tfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\n\t\t\t#else\n\n\t\t\t\tfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t\t#endif\n\n\t\t\tspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\n\n\t\t\t\t\t// specular\n\n\t\t\tvec3 spotHalfVector = normalize( lVector + viewPosition );\n\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\tfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n\n\t\t}\n\n\t}\n\n#endif\n\n#if MAX_DIR_LIGHTS > 0\n\n\tvec3 dirDiffuse = vec3( 0.0 );\n\tvec3 dirSpecular = vec3( 0.0 );\n\n\tfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\t\tvec3 dirVector = normalize( lDirection.xyz );\n\n\t\t\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, dirVector );\n\n\t\t#ifdef WRAP_AROUND\n\n\t\t\tfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\n\t\t\tfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\n\n\t\t\tvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n\n\t\t#else\n\n\t\t\tfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n\n\t\t#endif\n\n\t\tdirDiffuse += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\n\n\t\t// specular\n\n\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\tfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\n\t\t/*\n\t\t// fresnel term from skin shader\n\t\tconst float F0 = 0.128;\n\n\t\tfloat base = 1.0 - dot( viewPosition, dirHalfVector );\n\t\tfloat exponential = pow( base, 5.0 );\n\n\t\tfloat fresnel = exponential + F0 * ( 1.0 - exponential );\n\t\t*/\n\n\t\t/*\n\t\t// fresnel term from fresnel shader\n\t\tconst float mFresnelBias = 0.08;\n\t\tconst float mFresnelScale = 0.3;\n\t\tconst float mFresnelPower = 5.0;\n\n\t\tfloat fresnel = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( -viewPosition ), normal ), mFresnelPower );\n\t\t*/\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\t// \t\tdirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization * fresnel;\n\n\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\n\n\t}\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tvec3 hemiDiffuse = vec3( 0.0 );\n\tvec3 hemiSpecular = vec3( 0.0 );\n\n\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\n\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\tvec3 lVector = normalize( lDirection.xyz );\n\n\t\t// diffuse\n\n\t\tfloat dotProduct = dot( normal, lVector );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\n\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\n\t\themiDiffuse += diffuse * hemiColor;\n\n\t\t// specular (sky light)\n\n\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\tfloat hemiSpecularWeightSky = specularStrength * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\n\t\t// specular (ground light)\n\n\t\tvec3 lVectorGround = -lVector;\n\n\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\tfloat hemiSpecularWeightGround = specularStrength * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\n\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\n\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\n\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\n\t}\n\n#endif\n\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n\n#if MAX_DIR_LIGHTS > 0\n\n\ttotalDiffuse += dirDiffuse;\n\ttotalSpecular += dirSpecular;\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\ttotalDiffuse += hemiDiffuse;\n\ttotalSpecular += hemiSpecular;\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\ttotalDiffuse += pointDiffuse;\n\ttotalSpecular += pointSpecular;\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\ttotalDiffuse += spotDiffuse;\n\ttotalSpecular += spotSpecular;\n\n#endif\n\n#ifdef METAL\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\n#else\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\n#endif";
d.a.fog_pars_fragment="#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n\n#endif";d.a.morphnormal_vertex="#ifdef USE_MORPHNORMALS\n\n\tvec3 morphedNormal = vec3( 0.0 );\n\n\tmorphedNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tmorphedNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tmorphedNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tmorphedNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n\n\tmorphedNormal += normal;\n\n#endif";
d.a.envmap_pars_fragment="#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\tuniform samplerCube envMap;\n\tuniform float flipEnvMap;\n\tuniform int combine;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n\t\tuniform bool useRefract;\n\t\tuniform float refractionRatio;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\n\t#endif\n\n#endif";d.a.logdepthbuf_fragment="#if defined(USE_LOGDEPTHBUF) && defined(USE_LOGDEPTHBUF_EXT)\n\n\tgl_FragDepthEXT = log2(vFragDepth) * logDepthBufFC * 0.5;\n\n#endif";
d.a.normalmap_pars_fragment="#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n\t\t\t// Per-Pixel Tangent Space Normal Mapping\n\t\t\t// http://hacksoflife.blogspot.ch/2009/11/per-pixel-tangent-space-normal-mapping.html\n\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n";
d.a.lights_phong_pars_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n";d.a.lightmap_pars_fragment="#ifdef USE_LIGHTMAP\n\n\tvarying vec2 vUv2;\n\tuniform sampler2D lightMap;\n\n#endif";d.a.shadowmap_vertex="#ifdef USE_SHADOWMAP\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\n\t}\n\n#endif";d.a.lights_phong_vertex="#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvWorldPosition = worldPosition.xyz;\n\n#endif";
d.a.map_fragment="#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\t#ifdef GAMMA_INPUT\n\n\t\ttexelColor.xyz *= texelColor.xyz;\n\n\t#endif\n\n\tgl_FragColor = gl_FragColor * texelColor;\n\n#endif";d.a.lightmap_vertex="#ifdef USE_LIGHTMAP\n\n\tvUv2 = uv2;\n\n#endif";d.a.map_particle_fragment="#ifdef USE_MAP\n\n\tgl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n\n#endif";d.a.color_pars_fragment="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n";
d.a.color_vertex="#ifdef USE_COLOR\n\n\t#ifdef GAMMA_INPUT\n\n\t\tvColor = color * color;\n\n\t#else\n\n\t\tvColor = color;\n\n\t#endif\n\n#endif";d.a.skinning_vertex="#ifdef USE_SKINNING\n\n\t#ifdef USE_MORPHTARGETS\n\n\tvec4 skinVertex = bindMatrix * vec4( morphed, 1.0 );\n\n\t#else\n\n\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\tskinned  = bindMatrixInverse * skinned;\n\n#endif\n";
d.a.envmap_pars_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n\n\tvarying vec3 vReflect;\n\n\tuniform float refractionRatio;\n\tuniform bool useRefract;\n\n#endif\n";d.a.linear_to_gamma_fragment="#ifdef GAMMA_OUTPUT\n\n\tgl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n\n#endif";d.a.color_pars_vertex="#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif";d.a.lights_lambert_pars_vertex="uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\n\nuniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n";
d.a.map_pars_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvarying vec2 vUv;\n\tuniform vec4 offsetRepeat;\n\n#endif\n";d.a.envmap_fragment="#ifdef USE_ENVMAP\n\n\tvec3 reflectVec;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\n\t\t// http://en.wikibooks.org/wiki/GLSL_Programming/Applying_Matrix_Transformations\n\t\t// Transforming Normal Vectors with the Inverse Transformation\n\n\t\tvec3 worldNormal = normalize( vec3( vec4( normal, 0.0 ) * viewMatrix ) );\n\n\t\tif ( useRefract ) {\n\n\t\t\treflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t} else { \n\n\t\t\treflectVec = reflect( cameraToVertex, worldNormal );\n\n\t\t}\n\n\t#else\n\n\t\treflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n\t\tvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#else\n\n\t\tvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#endif\n\n\t#ifdef GAMMA_INPUT\n\n\t\tcubeColor.xyz *= cubeColor.xyz;\n\n\t#endif\n\n\tif ( combine == 1 ) {\n\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n\n\t} else if ( combine == 2 ) {\n\n\t\tgl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n\n\t} else {\n\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n\n\t}\n\n#endif";
d.a.specularmap_pars_fragment="#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif";d.a.logdepthbuf_vertex="#ifdef USE_LOGDEPTHBUF\n\n\tgl_Position.z = log2(max(1e-6, gl_Position.w + 1.0)) * logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\n#else\n\n\t\tgl_Position.z = (gl_Position.z - 1.0) * gl_Position.w;\n\n\t#endif\n\n#endif";d.a.morphtarget_pars_vertex="#ifdef USE_MORPHTARGETS\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif";
d.a.specularmap_fragment="float specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif";d.a.fog_fragment="#ifdef USE_FOG\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\n\t#else\n\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\n\t#endif\n\n\t#ifdef FOG_EXP2\n\n\t\tconst float LOG2 = 1.442695;\n\t\tfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\n\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n\n\t#endif\n\t\n\tgl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n\n#endif";
d.a.bumpmap_pars_fragment="#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\n\t\t\t// Derivative maps - bump mapping unparametrized surfaces by Morten Mikkelsen\n\t\t\t//\thttp://mmikkelsen3d.blogspot.sk/2011/07/derivative-maps.html\n\n\t\t\t// Evaluate the derivative of the height w.r.t. screen-space using forward differencing (listing 2)\n\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\n\t\tvec3 vSigmaX = dFdx( surf_pos );\n\t\tvec3 vSigmaY = dFdy( surf_pos );\n\t\tvec3 vN = surf_norm;\t\t// normalized\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif";
d.a.defaultnormal_vertex="vec3 objectNormal;\n\n#ifdef USE_SKINNING\n\n\tobjectNormal = skinnedNormal.xyz;\n\n#endif\n\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\n\n\tobjectNormal = morphedNormal;\n\n#endif\n\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\n\n\tobjectNormal = normal;\n\n#endif\n\n#ifdef FLIP_SIDED\n\n\tobjectNormal = -objectNormal;\n\n#endif\n\nvec3 transformedNormal = normalMatrix * objectNormal;";d.a.lights_phong_pars_fragment="uniform vec3 ambientLightColor;\n\n#if MAX_DIR_LIGHTS > 0\n\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n\n#endif\n\n#if MAX_HEMI_LIGHTS > 0\n\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n\n#endif\n\n#if MAX_POINT_LIGHTS > 0\n\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0\n\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n\n#endif\n\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP ) || defined( USE_ENVMAP )\n\n\tvarying vec3 vWorldPosition;\n\n#endif\n\n#ifdef WRAP_AROUND\n\n\tuniform vec3 wrapRGB;\n\n#endif\n\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;";
d.a.skinbase_vertex="#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif";d.a.map_vertex="#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP )\n\n\tvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n\n#endif";d.a.lightmap_fragment="#ifdef USE_LIGHTMAP\n\n\tgl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n\n#endif";
d.a.shadowmap_pars_vertex="#ifdef USE_SHADOWMAP\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\tuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n\n#endif";d.a.color_fragment="#ifdef USE_COLOR\n\n\tgl_FragColor = gl_FragColor * vec4( vColor, 1.0 );\n\n#endif";d.a.morphtarget_vertex="#ifdef USE_MORPHTARGETS\n\n\tvec3 morphed = vec3( 0.0 );\n\tmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\tmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\tmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\tmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\tmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\tmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\tmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\tmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n\tmorphed += position;\n\n#endif";
d.a.envmap_vertex="#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\n\n\tvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\n\tworldNormal = normalize( worldNormal );\n\n\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\tif ( useRefract ) {\n\n\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t} else {\n\n\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t}\n\n#endif";
d.a.shadowmap_fragment="#ifdef USE_SHADOWMAP\n\n\t#ifdef SHADOWMAP_DEBUG\n\n\t\tvec3 frustumColors[3];\n\t\tfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\n\t\tfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\n\t\tfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n\n\t#endif\n\n\t#ifdef SHADOWMAP_CASCADE\n\n\t\tint inFrustumCount = 0;\n\n\t#endif\n\n\tfloat fDepth;\n\tvec3 shadowColor = vec3( 1.0 );\n\n\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\n\t\tvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\n\n\t\t\t\t// if ( something && something ) breaks ATI OpenGL shader compiler\n\t\t\t\t// if ( all( something, something ) ) using this instead\n\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\t\t\t// don't shadow pixels outside of light frustum\n\t\t\t\t// use just first frustum (for cascades)\n\t\t\t\t// don't shadow pixels behind far plane of light frustum\n\n\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\tinFrustumCount += int( inFrustum );\n\t\t\tbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n\n\t\t#else\n\n\t\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\t#endif\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t\tshadowCoord.z += shadowBias[ i ];\n\n\t\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t/*\n\t\t\t\t\t\t// nested loops breaks shader compiler / validator on some ATI cards when using OpenGL\n\t\t\t\t\t\t// must enroll loop manually\n\n\t\t\t\tfor ( float y = -1.25; y <= 1.25; y += 1.25 )\n\t\t\t\t\tfor ( float x = -1.25; x <= 1.25; x += 1.25 ) {\n\n\t\t\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy );\n\n\t\t\t\t\t\t\t\t// doesn't seem to produce any noticeable visual difference compared to simple texture2D lookup\n\t\t\t\t\t\t\t\t//vec4 rgbaDepth = texture2DProj( shadowMap[ i ], vec4( vShadowCoord[ i ].w * ( vec2( x * xPixelOffset, y * yPixelOffset ) + shadowCoord.xy ), 0.05, vShadowCoord[ i ].w ) );\n\n\t\t\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\t\t\tif ( fDepth < shadowCoord.z )\n\t\t\t\t\t\t\tshadow += 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tshadow /= 9.0;\n\n\t\t*/\n\n\t\t\t\tconst float shadowDelta = 1.0 / 9.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.25 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.25 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.25 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.25 * yPixelOffset;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\t\t\t\tif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\t\t\t\t// Percentage-close filtering\n\t\t\t\t\t\t// (9 pixel kernel)\n\t\t\t\t\t\t// http://fabiensanglard.net/shadowmappingPCF/\n\n\t\t\t\tfloat shadow = 0.0;\n\n\t\t\t\tfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\n\t\t\t\tfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\n\n\t\t\t\tfloat dx0 = -1.0 * xPixelOffset;\n\t\t\t\tfloat dy0 = -1.0 * yPixelOffset;\n\t\t\t\tfloat dx1 = 1.0 * xPixelOffset;\n\t\t\t\tfloat dy1 = 1.0 * yPixelOffset;\n\n\t\t\t\tmat3 shadowKernel;\n\t\t\t\tmat3 depthKernel;\n\n\t\t\t\tdepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\n\t\t\t\tdepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\n\t\t\t\tdepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\n\t\t\t\tdepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\n\t\t\t\tdepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\n\t\t\t\tdepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\n\t\t\t\tdepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\n\t\t\t\tdepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\n\t\t\t\tdepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\n\n\t\t\t\tvec3 shadowZ = vec3( shadowCoord.z );\n\t\t\t\tshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\n\t\t\t\tshadowKernel[0] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\n\t\t\t\tshadowKernel[1] *= vec3(0.25);\n\n\t\t\t\tshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\n\t\t\t\tshadowKernel[2] *= vec3(0.25);\n\n\t\t\t\tvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\n\n\t\t\t\tshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\n\t\t\t\tshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\n\n\t\t\t\tvec4 shadowValues;\n\t\t\t\tshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\n\t\t\t\tshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\n\t\t\t\tshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\n\t\t\t\tshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\n\n\t\t\t\tshadow = dot( shadowValues, vec4( 1.0 ) );\n\n\t\t\t\tshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n\n\t\t\t#else\n\n\t\t\t\tvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\n\t\t\t\tfloat fDepth = unpackDepth( rgbaDepth );\n\n\t\t\t\tif ( fDepth < shadowCoord.z )\n\n\t\t// spot with multiple shadows is darker\n\n\t\t\t\t\tshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n\n\t\t// spot with multiple shadows has the same color as single shadow spot\n\n\t\t// \t\t\t\t\tshadowColor = min( shadowColor, vec3( shadowDarkness[ i ] ) );\n\n\t\t\t#endif\n\n\t\t}\n\n\n\t\t#ifdef SHADOWMAP_DEBUG\n\n\t\t\t#ifdef SHADOWMAP_CASCADE\n\n\t\t\t\tif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n\n\t\t\t#else\n\n\t\t\t\tif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n\n\t\t\t#endif\n\n\t\t#endif\n\n\t}\n\n\t#ifdef GAMMA_OUTPUT\n\n\t\tshadowColor *= shadowColor;\n\n\t#endif\n\n\tgl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n\n#endif\n";
d.a.worldpos_vertex="#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n\n\t#ifdef USE_SKINNING\n\n\t\tvec4 worldPosition = modelMatrix * skinned;\n\n\t#endif\n\n\t#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n\n\t#endif\n\n\t#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\n\n\t\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\n\t#endif\n\n#endif";
d.a.shadowmap_pars_fragment="#ifdef USE_SHADOWMAP\n\n\tuniform sampler2D shadowMap[ MAX_SHADOWS ];\n\tuniform vec2 shadowMapSize[ MAX_SHADOWS ];\n\n\tuniform float shadowDarkness[ MAX_SHADOWS ];\n\tuniform float shadowBias[ MAX_SHADOWS ];\n\n\tvarying vec4 vShadowCoord[ MAX_SHADOWS ];\n\n\tfloat unpackDepth( const in vec4 rgba_depth ) {\n\n\t\tconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\n\t\tfloat depth = dot( rgba_depth, bit_shift );\n\t\treturn depth;\n\n\t}\n\n#endif";
d.a.skinning_pars_vertex="#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureWidth;\n\t\tuniform int boneTextureHeight;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureWidth ) );\n\t\t\tfloat y = floor( j / float( boneTextureWidth ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureWidth );\n\t\t\tfloat dy = 1.0 / float( boneTextureHeight );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneGlobalMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneGlobalMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n";
d.a.logdepthbuf_pars_fragment="#ifdef USE_LOGDEPTHBUF\n\n\tuniform float logDepthBufFC;\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\t#extension GL_EXT_frag_depth : enable\n\t\tvarying float vFragDepth;\n\n\t#endif\n\n#endif";d.a.alphamap_fragment="#ifdef USE_ALPHAMAP\n\n\tgl_FragColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n";d.a.alphamap_pars_fragment="#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n";
d.ac={Jc:function(a){var b,c,e,f={};for(b=0;b<a.length;b++)for(c in e=this.clone(a[b]),e)f[c]=e[c];return f},clone:function(a){var b,c,e,f={};for(b in a)for(c in f[b]={},a[b])e=a[b][c],f[b][c]=e instanceof d.q||e instanceof d.g||e instanceof d.b||e instanceof d.bc||e instanceof d.S||e instanceof d.xa?e.clone():e instanceof Array?e.slice():e;return f}};
d.Ca={br:{diffuse:{type:"c",value:new d.q(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new d.bc(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},alphaMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},Yq:{bumpMap:{type:"t",
value:null},bumpScale:{type:"f",value:1}},hs:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new d.g(1,1)}},L:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new d.q(16777215)}},Wc:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",value:[]},hemisphereLightGroundColor:{type:"fv",
value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},ks:{psColor:{type:"c",value:new d.q(15658734)},opacity:{type:"f",value:1},size:{type:"f",value:1},scale:{type:"f",value:1},map:{type:"t",
value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new d.q(16777215)}},As:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
d.Kg={basic:{M:d.ac.Jc([d.Ca.common,d.Ca.fog,d.Ca.shadowmap]),J:[d.a.map_pars_vertex,d.a.lightmap_pars_vertex,d.a.envmap_pars_vertex,d.a.color_pars_vertex,d.a.morphtarget_pars_vertex,d.a.skinning_pars_vertex,d.a.shadowmap_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.map_vertex,d.a.lightmap_vertex,d.a.color_vertex,d.a.skinbase_vertex,"\t#ifdef USE_ENVMAP",d.a.morphnormal_vertex,d.a.skinnormal_vertex,d.a.defaultnormal_vertex,"\t#endif",d.a.morphtarget_vertex,d.a.skinning_vertex,d.a.default_vertex,
d.a.logdepthbuf_vertex,d.a.worldpos_vertex,d.a.envmap_vertex,d.a.shadowmap_vertex,"}"].join("\n"),I:["uniform vec3 diffuse;\nuniform float opacity;",d.a.color_pars_fragment,d.a.map_pars_fragment,d.a.alphamap_pars_fragment,d.a.lightmap_pars_fragment,d.a.envmap_pars_fragment,d.a.fog_pars_fragment,d.a.shadowmap_pars_fragment,d.a.specularmap_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( diffuse, opacity );",d.a.logdepthbuf_fragment,d.a.map_fragment,d.a.alphamap_fragment,
d.a.alphatest_fragment,d.a.specularmap_fragment,d.a.lightmap_fragment,d.a.color_fragment,d.a.envmap_fragment,d.a.shadowmap_fragment,d.a.linear_to_gamma_fragment,d.a.fog_fragment,"}"].join("\n")},lambert:{M:d.ac.Jc([d.Ca.common,d.Ca.fog,d.Ca.lights,d.Ca.shadowmap,{ambient:{type:"c",value:new d.q(16777215)},emissive:{type:"c",value:new d.q(0)},wrapRGB:{type:"v3",value:new d.b(1,1,1)}}]),J:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",d.a.map_pars_vertex,
d.a.lightmap_pars_vertex,d.a.envmap_pars_vertex,d.a.lights_lambert_pars_vertex,d.a.color_pars_vertex,d.a.morphtarget_pars_vertex,d.a.skinning_pars_vertex,d.a.shadowmap_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.map_vertex,d.a.lightmap_vertex,d.a.color_vertex,d.a.morphnormal_vertex,d.a.skinbase_vertex,d.a.skinnormal_vertex,d.a.defaultnormal_vertex,d.a.morphtarget_vertex,d.a.skinning_vertex,d.a.default_vertex,d.a.logdepthbuf_vertex,d.a.worldpos_vertex,d.a.envmap_vertex,d.a.lights_lambert_vertex,
d.a.shadowmap_vertex,"}"].join("\n"),I:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif",d.a.color_pars_fragment,d.a.map_pars_fragment,d.a.alphamap_pars_fragment,d.a.lightmap_pars_fragment,d.a.envmap_pars_fragment,d.a.fog_pars_fragment,d.a.shadowmap_pars_fragment,d.a.specularmap_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( vec3( 1.0 ), opacity );",d.a.logdepthbuf_fragment,d.a.map_fragment,d.a.alphamap_fragment,
d.a.alphatest_fragment,d.a.specularmap_fragment,"\t#ifdef DOUBLE_SIDED\n\t\tif ( gl_FrontFacing )\n\t\t\tgl_FragColor.xyz *= vLightFront;\n\t\telse\n\t\t\tgl_FragColor.xyz *= vLightBack;\n\t#else\n\t\tgl_FragColor.xyz *= vLightFront;\n\t#endif",d.a.lightmap_fragment,d.a.color_fragment,d.a.envmap_fragment,d.a.shadowmap_fragment,d.a.linear_to_gamma_fragment,d.a.fog_fragment,"}"].join("\n")},phong:{M:d.ac.Jc([d.Ca.common,d.Ca.bump,d.Ca.normalmap,d.Ca.fog,d.Ca.lights,d.Ca.shadowmap,{ambient:{type:"c",
value:new d.q(16777215)},emissive:{type:"c",value:new d.q(0)},specular:{type:"c",value:new d.q(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new d.b(1,1,1)}}]),J:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",d.a.map_pars_vertex,d.a.lightmap_pars_vertex,d.a.envmap_pars_vertex,d.a.lights_phong_pars_vertex,d.a.color_pars_vertex,d.a.morphtarget_pars_vertex,d.a.skinning_pars_vertex,d.a.shadowmap_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.map_vertex,
d.a.lightmap_vertex,d.a.color_vertex,d.a.morphnormal_vertex,d.a.skinbase_vertex,d.a.skinnormal_vertex,d.a.defaultnormal_vertex,"\tvNormal = normalize( transformedNormal );",d.a.morphtarget_vertex,d.a.skinning_vertex,d.a.default_vertex,d.a.logdepthbuf_vertex,"\tvViewPosition = -mvPosition.xyz;",d.a.worldpos_vertex,d.a.envmap_vertex,d.a.lights_phong_vertex,d.a.shadowmap_vertex,"}"].join("\n"),I:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",
d.a.color_pars_fragment,d.a.map_pars_fragment,d.a.alphamap_pars_fragment,d.a.lightmap_pars_fragment,d.a.envmap_pars_fragment,d.a.fog_pars_fragment,d.a.lights_phong_pars_fragment,d.a.shadowmap_pars_fragment,d.a.bumpmap_pars_fragment,d.a.normalmap_pars_fragment,d.a.specularmap_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( vec3( 1.0 ), opacity );",d.a.logdepthbuf_fragment,d.a.map_fragment,d.a.alphamap_fragment,d.a.alphatest_fragment,d.a.specularmap_fragment,d.a.lights_phong_fragment,
d.a.lightmap_fragment,d.a.color_fragment,d.a.envmap_fragment,d.a.shadowmap_fragment,d.a.linear_to_gamma_fragment,d.a.fog_fragment,"}"].join("\n")},particle_basic:{M:d.ac.Jc([d.Ca.particle,d.Ca.shadowmap]),J:["uniform float size;\nuniform float scale;",d.a.color_pars_vertex,d.a.shadowmap_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.color_vertex,"\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\tgl_Position = projectionMatrix * mvPosition;",
d.a.logdepthbuf_vertex,d.a.worldpos_vertex,d.a.shadowmap_vertex,"}"].join("\n"),I:["uniform vec3 psColor;\nuniform float opacity;",d.a.color_pars_fragment,d.a.map_particle_pars_fragment,d.a.fog_pars_fragment,d.a.shadowmap_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( psColor, opacity );",d.a.logdepthbuf_fragment,d.a.map_particle_fragment,d.a.alphatest_fragment,d.a.color_fragment,d.a.shadowmap_fragment,d.a.fog_fragment,"}"].join("\n")},dashed:{M:d.ac.Jc([d.Ca.common,
d.Ca.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),J:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",d.a.color_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.color_vertex,"\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",d.a.logdepthbuf_vertex,"}"].join("\n"),I:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",
d.a.color_pars_fragment,d.a.fog_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tgl_FragColor = vec4( diffuse, opacity );",d.a.logdepthbuf_fragment,d.a.color_fragment,d.a.fog_fragment,"}"].join("\n")},depth:{M:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",value:1}},J:[d.a.morphtarget_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.morphtarget_vertex,d.a.default_vertex,d.a.logdepthbuf_vertex,
"}"].join("\n"),I:["uniform float mNear;\nuniform float mFar;\nuniform float opacity;",d.a.logdepthbuf_pars_fragment,"void main() {",d.a.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;\n\t#else\n\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n\t#endif\n\tfloat color = 1.0 - smoothstep( mNear, mFar, depth );\n\tgl_FragColor = vec4( vec3( color ), opacity );\n}"].join("\n")},normal:{M:{opacity:{type:"f",value:1}},J:["varying vec3 vNormal;",
d.a.morphtarget_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {\n\tvNormal = normalize( normalMatrix * normal );",d.a.morphtarget_vertex,d.a.default_vertex,d.a.logdepthbuf_vertex,"}"].join("\n"),I:["uniform float opacity;\nvarying vec3 vNormal;",d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );",d.a.logdepthbuf_fragment,"}"].join("\n")},normalmap:{M:d.ac.Jc([d.Ca.fog,d.Ca.lights,d.Ca.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",
value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new d.g(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},diffuse:{type:"c",value:new d.q(16777215)},specular:{type:"c",value:new d.q(1118481)},
ambient:{type:"c",value:new d.q(16777215)},shininess:{type:"f",value:30},opacity:{type:"f",value:1},useRefract:{type:"i",value:0},refractionRatio:{type:"f",value:.98},reflectivity:{type:"f",value:.5},uOffset:{type:"v2",value:new d.g(0,0)},uRepeat:{type:"v2",value:new d.g(1,1)},wrapRGB:{type:"v3",value:new d.b(1,1,1)}}]),I:["uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float refractionRatio;\nuniform float reflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\n\tuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\n\tuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\n\tuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\n\tuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\n\tuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n\tuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\n\tuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\n\tuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\n\tuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n\tuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\n\tuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
d.a.shadowmap_pars_fragment,d.a.fog_pars_fragment,d.a.logdepthbuf_pars_fragment,"void main() {",d.a.logdepthbuf_fragment,"\tgl_FragColor = vec4( vec3( 1.0 ), opacity );\n\tvec3 specularTex = vec3( 1.0 );\n\tvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\n\tnormalTex.xy *= uNormalScale;\n\tnormalTex = normalize( normalTex );\n\tif( enableDiffuse ) {\n\t\t#ifdef GAMMA_INPUT\n\t\t\tvec4 texelColor = texture2D( tDiffuse, vUv );\n\t\t\ttexelColor.xyz *= texelColor.xyz;\n\t\t\tgl_FragColor = gl_FragColor * texelColor;\n\t\t#else\n\t\t\tgl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n\t\t#endif\n\t}\n\tif( enableAO ) {\n\t\t#ifdef GAMMA_INPUT\n\t\t\tvec4 aoColor = texture2D( tAO, vUv );\n\t\t\taoColor.xyz *= aoColor.xyz;\n\t\t\tgl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n\t\t#else\n\t\t\tgl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n\t\t#endif\n\t}",
d.a.alphatest_fragment,"\tif( enableSpecular )\n\t\tspecularTex = texture2D( tSpecular, vUv ).xyz;\n\tmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\n\tvec3 finalNormal = tsb * normalTex;\n\t#ifdef FLIP_SIDED\n\t\tfinalNormal = -finalNormal;\n\t#endif\n\tvec3 normal = normalize( finalNormal );\n\tvec3 viewPosition = normalize( vViewPosition );\n\t#if MAX_POINT_LIGHTS > 0\n\t\tvec3 pointDiffuse = vec3( 0.0 );\n\t\tvec3 pointSpecular = vec3( 0.0 );\n\t\tfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n\t\t\tvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\n\t\t\tvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\n\t\t\tfloat pointDistance = 1.0;\n\t\t\tif ( pointLightDistance[ i ] > 0.0 )\n\t\t\t\tpointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\n\t\t\tpointVector = normalize( pointVector );\n\t\t\t#ifdef WRAP_AROUND\n\t\t\t\tfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\n\t\t\t\tfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\n\t\t\t\tvec3 pointDiffuseWeight = mix( vec3( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n\t\t\t#else\n\t\t\t\tfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n\t\t\t#endif\n\t\t\tpointDiffuse += pointDistance * pointLightColor[ i ] * diffuse * pointDiffuseWeight;\n\t\t\tvec3 pointHalfVector = normalize( pointVector + viewPosition );\n\t\t\tfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\n\t\t\tfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( pointVector, pointHalfVector ), 0.0 ), 5.0 );\n\t\t\tpointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n\t\t}\n\t#endif\n\t#if MAX_SPOT_LIGHTS > 0\n\t\tvec3 spotDiffuse = vec3( 0.0 );\n\t\tvec3 spotSpecular = vec3( 0.0 );\n\t\tfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n\t\t\tvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\n\t\t\tvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\n\t\t\tfloat spotDistance = 1.0;\n\t\t\tif ( spotLightDistance[ i ] > 0.0 )\n\t\t\t\tspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\n\t\t\tspotVector = normalize( spotVector );\n\t\t\tfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\n\t\t\tif ( spotEffect > spotLightAngleCos[ i ] ) {\n\t\t\t\tspotEffect = max( pow( max( spotEffect, 0.0 ), spotLightExponent[ i ] ), 0.0 );\n\t\t\t\t#ifdef WRAP_AROUND\n\t\t\t\t\tfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\n\t\t\t\t\tfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\n\t\t\t\t\tvec3 spotDiffuseWeight = mix( vec3( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n\t\t\t\t#else\n\t\t\t\t\tfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n\t\t\t\t#endif\n\t\t\t\tspotDiffuse += spotDistance * spotLightColor[ i ] * diffuse * spotDiffuseWeight * spotEffect;\n\t\t\t\tvec3 spotHalfVector = normalize( spotVector + viewPosition );\n\t\t\t\tfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\n\t\t\t\tfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n\t\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( spotVector, spotHalfVector ), 0.0 ), 5.0 );\n\t\t\t\tspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n\t\t\t}\n\t\t}\n\t#endif\n\t#if MAX_DIR_LIGHTS > 0\n\t\tvec3 dirDiffuse = vec3( 0.0 );\n\t\tvec3 dirSpecular = vec3( 0.0 );\n\t\tfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\n\t\t\tvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\n\t\t\tvec3 dirVector = normalize( lDirection.xyz );\n\t\t\t#ifdef WRAP_AROUND\n\t\t\t\tfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\n\t\t\t\tfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\n\t\t\t\tvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n\t\t\t#else\n\t\t\t\tfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n\t\t\t#endif\n\t\t\tdirDiffuse += directionalLightColor[ i ] * diffuse * dirDiffuseWeight;\n\t\t\tvec3 dirHalfVector = normalize( dirVector + viewPosition );\n\t\t\tfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\n\t\t\tfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlick = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( dirVector, dirHalfVector ), 0.0 ), 5.0 );\n\t\t\tdirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n\t\t}\n\t#endif\n\t#if MAX_HEMI_LIGHTS > 0\n\t\tvec3 hemiDiffuse = vec3( 0.0 );\n\t\tvec3 hemiSpecular = vec3( 0.0 );\n\t\tfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\n\t\t\tvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\n\t\t\tvec3 lVector = normalize( lDirection.xyz );\n\t\t\tfloat dotProduct = dot( normal, lVector );\n\t\t\tfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\n\t\t\tvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n\t\t\themiDiffuse += diffuse * hemiColor;\n\t\t\tvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\n\t\t\tfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\n\t\t\tfloat hemiSpecularWeightSky = specularTex.r * max( pow( max( hemiDotNormalHalfSky, 0.0 ), shininess ), 0.0 );\n\t\t\tvec3 lVectorGround = -lVector;\n\t\t\tvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\n\t\t\tfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\n\t\t\tfloat hemiSpecularWeightGround = specularTex.r * max( pow( max( hemiDotNormalHalfGround, 0.0 ), shininess ), 0.0 );\n\t\t\tfloat dotProductGround = dot( normal, lVectorGround );\n\t\t\tfloat specularNormalization = ( shininess + 2.0 ) / 8.0;\n\t\t\tvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVector, hemiHalfVectorSky ), 0.0 ), 5.0 );\n\t\t\tvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( max( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 0.0 ), 5.0 );\n\t\t\themiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n\t\t}\n\t#endif\n\tvec3 totalDiffuse = vec3( 0.0 );\n\tvec3 totalSpecular = vec3( 0.0 );\n\t#if MAX_DIR_LIGHTS > 0\n\t\ttotalDiffuse += dirDiffuse;\n\t\ttotalSpecular += dirSpecular;\n\t#endif\n\t#if MAX_HEMI_LIGHTS > 0\n\t\ttotalDiffuse += hemiDiffuse;\n\t\ttotalSpecular += hemiSpecular;\n\t#endif\n\t#if MAX_POINT_LIGHTS > 0\n\t\ttotalDiffuse += pointDiffuse;\n\t\ttotalSpecular += pointSpecular;\n\t#endif\n\t#if MAX_SPOT_LIGHTS > 0\n\t\ttotalDiffuse += spotDiffuse;\n\t\ttotalSpecular += spotSpecular;\n\t#endif\n\t#ifdef METAL\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient + totalSpecular );\n\t#else\n\t\tgl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n\t#endif\n\tif ( enableReflection ) {\n\t\tvec3 vReflect;\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tif ( useRefract ) {\n\t\t\tvReflect = refract( cameraToVertex, normal, refractionRatio );\n\t\t} else {\n\t\t\tvReflect = reflect( cameraToVertex, normal );\n\t\t}\n\t\tvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n\t\t#ifdef GAMMA_INPUT\n\t\t\tcubeColor.xyz *= cubeColor.xyz;\n\t\t#endif\n\t\tgl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * reflectivity );\n\t}",
d.a.shadowmap_fragment,d.a.linear_to_gamma_fragment,d.a.fog_fragment,"}"].join("\n"),J:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\n\tuniform sampler2D tDisplacement;\n\tuniform float uDisplacementScale;\n\tuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",d.a.skinning_pars_vertex,
d.a.shadowmap_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.skinbase_vertex,d.a.skinnormal_vertex,"\t#ifdef USE_SKINNING\n\t\tvNormal = normalize( normalMatrix * skinnedNormal.xyz );\n\t\tvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\n\t\tvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n\t#else\n\t\tvNormal = normalize( normalMatrix * normal );\n\t\tvTangent = normalize( normalMatrix * tangent.xyz );\n\t#endif\n\tvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\n\tvUv = uv * uRepeat + uOffset;\n\tvec3 displacedPosition;\n\t#ifdef VERTEX_TEXTURES\n\t\tif ( enableDisplacement ) {\n\t\t\tvec3 dv = texture2D( tDisplacement, uv ).xyz;\n\t\t\tfloat df = uDisplacementScale * dv.x + uDisplacementBias;\n\t\t\tdisplacedPosition = position + normalize( normal ) * df;\n\t\t} else {\n\t\t\t#ifdef USE_SKINNING\n\t\t\t\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\t\t\t\tvec4 skinned = vec4( 0.0 );\n\t\t\t\tskinned += boneMatX * skinVertex * skinWeight.x;\n\t\t\t\tskinned += boneMatY * skinVertex * skinWeight.y;\n\t\t\t\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\t\t\t\tskinned += boneMatW * skinVertex * skinWeight.w;\n\t\t\t\tskinned  = bindMatrixInverse * skinned;\n\t\t\t\tdisplacedPosition = skinned.xyz;\n\t\t\t#else\n\t\t\t\tdisplacedPosition = position;\n\t\t\t#endif\n\t\t}\n\t#else\n\t\t#ifdef USE_SKINNING\n\t\t\tvec4 skinVertex = bindMatrix * vec4( position, 1.0 );\n\t\t\tvec4 skinned = vec4( 0.0 );\n\t\t\tskinned += boneMatX * skinVertex * skinWeight.x;\n\t\t\tskinned += boneMatY * skinVertex * skinWeight.y;\n\t\t\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\t\t\tskinned += boneMatW * skinVertex * skinWeight.w;\n\t\t\tskinned  = bindMatrixInverse * skinned;\n\t\t\tdisplacedPosition = skinned.xyz;\n\t\t#else\n\t\t\tdisplacedPosition = position;\n\t\t#endif\n\t#endif\n\tvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\n\tvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;",
d.a.logdepthbuf_vertex,"\tvWorldPosition = worldPosition.xyz;\n\tvViewPosition = -mvPosition.xyz;\n\t#ifdef USE_SHADOWMAP\n\t\tfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\n\t\t\tvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n\t\t}\n\t#endif\n}"].join("\n")},cube:{M:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},J:["varying vec3 vWorldPosition;",d.a.logdepthbuf_pars_vertex,"void main() {\n\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n\tvWorldPosition = worldPosition.xyz;\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );",
d.a.logdepthbuf_vertex,"}"].join("\n"),I:["uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;",d.a.logdepthbuf_pars_fragment,"void main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );",d.a.logdepthbuf_fragment,"}"].join("\n")},depthRGBA:{M:{},J:[d.a.morphtarget_pars_vertex,d.a.skinning_pars_vertex,d.a.logdepthbuf_pars_vertex,"void main() {",d.a.skinbase_vertex,d.a.morphtarget_vertex,d.a.skinning_vertex,d.a.default_vertex,
d.a.logdepthbuf_vertex,"}"].join("\n"),I:[d.a.logdepthbuf_pars_fragment,"vec4 pack_depth( const in float depth ) {\n\tconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\n\tconst vec4 bit_mask = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\n\tvec4 res = mod( depth * bit_shift * vec4( 255 ), vec4( 256 ) ) / vec4( 255 );\n\tres -= res.xxyz * bit_mask;\n\treturn res;\n}\nvoid main() {",d.a.logdepthbuf_fragment,"\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragDepthEXT );\n\t#else\n\t\tgl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n\t#endif\n}"].join("\n")}};
d.yn=function(){function a(a){a.wc||(a.wc={},a.nd=[]);for(;a.Ge.length;){var b=a.Ge[0],c=a,e=void 0,f=void 0;void 0===b.md&&(b.md=!0,b.xc=new d.S,b.Ik=new d.Nb);e=b.k;if(void 0!==e&&void 0===e.md)if(e.md=!0,e.addEventListener("dispose",h),e instanceof d.wa)u(e);else if(b instanceof d.Y)void 0!==b.tf&&Q(b,c),L(c,b,e);else if(b instanceof d.U){if(!e.ib){f=e;f.ib=p.createBuffer();f.cc=p.createBuffer();f.Qg=p.createBuffer();N.info.memory.We++;var f=e,g=b,k=f.e.length;f.Ie=new Float32Array(3*k);f.Fe=new Float32Array(3*
k);f.Cn=new Float32Array(1*k);f.ti=k;l(f,g);e.Oa=!0;e.Eb=!0;e.oh=!0}}else b instanceof d.Ab&&!e.ib&&(f=e,f.ib=p.createBuffer(),f.cc=p.createBuffer(),N.info.memory.We++,f=e,g=b,k=f.e.length,f.Ie=new Float32Array(3*k),f.Fe=new Float32Array(3*k),f.Gn=[],f.Fk=k,l(f,g),e.Oa=!0,e.Eb=!0);if(void 0===b.tf){if(b instanceof d.Y)if(e=b.k,e instanceof d.wa)M(c.wc,e,b);else{if(e instanceof d.u)for(g=0,k=e.Hc.length;g<k;g++)f=e.Hc[g],M(c.wc,f,b)}else b instanceof d.U||b instanceof d.Ab?(e=b.k,M(c.wc,e,b)):(b instanceof
d.Zh||b.Wi)&&c.nd.push({id:null,object:b,Dl:null,eb:null,z:0});b.tf=!0}a.Ge.splice(0,1)}for(;a.He.length;)Q(a.He[0],a),a.He.splice(0,1)}function b(a){var b=a.Ya.Ya;if(void 0!==b){a.Ya=void 0;var c,e,f=!1;a=0;for(c=La.length;a<c;a++)if(e=La[a],e.Ya===b){e.zj--;0===e.zj&&(f=!0);break}if(!0===f){f=[];a=0;for(c=La.length;a<c;a++)e=La[a],e.Ya!==b&&f.push(e);La=f;p.deleteProgram(b);N.info.memory.Il--}}}function c(a){void 0!==a.ib&&p.deleteBuffer(a.ib);void 0!==a.Td&&p.deleteBuffer(a.Td);void 0!==a.Tg&&
p.deleteBuffer(a.Tg);void 0!==a.cc&&p.deleteBuffer(a.cc);void 0!==a.Vg&&p.deleteBuffer(a.Vg);void 0!==a.Ug&&p.deleteBuffer(a.Ug);void 0!==a.Rg&&p.deleteBuffer(a.Rg);void 0!==a.Sg&&p.deleteBuffer(a.Sg);void 0!==a.Og&&p.deleteBuffer(a.Og);void 0!==a.Pg&&p.deleteBuffer(a.Pg);void 0!==a.Qg&&p.deleteBuffer(a.Qg);if(void 0!==a.rb)for(var b in a.rb)p.deleteBuffer(a.rb[b].buffer);N.info.memory.We--}function e(a){a=a.target;a.removeEventListener("dispose",e);b(a)}function f(a){a=a.target;a.removeEventListener("dispose",
f);if(a&&a.Cb)if(p.deleteTexture(a.Cb),a instanceof d.Sd)for(var b=0;6>b;b++)p.deleteFramebuffer(a.Rc[b]),p.deleteRenderbuffer(a.Sc[b]);else p.deleteFramebuffer(a.Rc),p.deleteRenderbuffer(a.Sc);N.info.memory.wg--}function g(a){a=a.target;a.removeEventListener("dispose",g);a.$&&a.$.wf?p.deleteTexture(a.$.wf):a.md&&(a.md=!1,p.deleteTexture(a.Cb));N.info.memory.wg--}function h(a){a=a.target;a.removeEventListener("dispose",h);a.md=void 0;if(a instanceof d.wa){a=a.attributes;for(var b in a)void 0!==a[b].buffer&&
p.deleteBuffer(a[b].buffer);N.info.memory.We--}else if(void 0!==a.Gc){b=0;for(var e=a.Hc.length;b<e;b++){var f=a.Hc[b];if(void 0!==f.fg)for(var g=0,k=f.fg;g<k;g++)p.deleteBuffer(f.Je[g]);if(void 0!==f.eg)for(g=0,k=f.eg;g<k;g++)p.deleteBuffer(f.uf[g]);c(f)}}else c(a)}var k;function l(a,b){var c=a.e.length,e=b.r;if(e.attributes){void 0===a.rb&&(a.rb=[]);for(var f in e.attributes){var g=e.attributes[f];if(!g.si||g.ro){g.si=!0;var h=1;"v2"===g.type?h=2:"v3"===g.type?h=3:"v4"===g.type?h=4:"c"===g.type&&
(h=3);g.size=h;g.d=new Float32Array(c*h);g.buffer=p.createBuffer();g.buffer.Yg=f;g.H=!0}a.rb.push(g)}}}function n(a,b){var c=b.k,e=a.$k,f=3*e.length,g=1*e.length,h=3*e.length,e=q(b,a),k=s(e),l=r(e),n=e.s?e.s:!1;a.Ie=new Float32Array(3*f);l&&(a.zk=new Float32Array(3*f));c.Ui&&(a.Ck=new Float32Array(4*f));n&&(a.Fe=new Float32Array(3*f));k&&(0<c.D.length&&(a.Ek=new Float32Array(2*f)),1<c.D.length&&(a.Dk=new Float32Array(2*f)));b.k.Sb.length&&b.k.Kb.length&&(a.Ak=new Float32Array(4*f),a.Bk=new Float32Array(4*
f));c=null!==Qb&&21845<g?Uint32Array:Uint16Array;a.Hn=c;a.uk=new c(3*g);a.wk=new c(2*h);if(a.fg)for(a.yk=[],c=0,k=a.fg;c<k;c++)a.yk.push(new Float32Array(3*f));if(a.eg)for(a.xk=[],c=0,k=a.eg;c<k;c++)a.xk.push(new Float32Array(3*f));a.ri=3*g;a.ti=2*h;if(e.attributes){void 0===a.rb&&(a.rb=[]);for(var u in e.attributes){var g=e.attributes[u],h={},v;for(v in g)h[v]=g[v];if(!h.si||h.ro)h.si=!0,c=1,"v2"===h.type?c=2:"v3"===h.type?c=3:"v4"===h.type?c=4:"c"===h.type&&(c=3),h.size=c,h.d=new Float32Array(f*
c),h.buffer=p.createBuffer(),h.buffer.Yg=u,g.H=!0,h.En=g;a.rb.push(h)}}a.vk=!0}function q(a,b){return a.r instanceof d.jd?a.r.Va[b.Hb]:a.r}function r(a){return a instanceof d.xb&&!a.qa||a instanceof d.Kd?!1:a&&void 0!==a.Ma&&a.Ma===d.Qd?d.Qd:d.Wh}function s(a){return a.map||a.Ua||a.sb||a.ob||a.Na||a.bb||a instanceof d.Fa?!0:!1}function u(a){for(var b in a.attributes){var c="index"===b?p.ELEMENT_ARRAY_BUFFER:p.ARRAY_BUFFER,e=a.attributes[b];e.buffer=p.createBuffer();p.bindBuffer(c,e.buffer);p.bufferData(c,
e.d,p.STATIC_DRAW)}}function w(a,b,c,e){for(var f in b){var g=b[f],h=c[f];if(0<=g)if(h){var k=h.Vc;p.bindBuffer(p.ARRAY_BUFFER,h.buffer);y(g);p.vertexAttribPointer(g,k,p.FLOAT,!1,0,e*k*4)}else a.fc&&(2===a.fc[f].length?p.vertexAttrib2fv(g,a.fc[f]):3===a.fc[f].length&&p.vertexAttrib3fv(g,a.fc[f]))}z()}function v(){for(var a=0,b=Zb.length;a<b;a++)Zb[a]=0}function y(a){Zb[a]=1;0===Ia[a]&&(p.enableVertexAttribArray(a),Ia[a]=1)}function z(){for(var a=0,b=Ia.length;a<b;a++)Ia[a]!==Zb[a]&&(p.disableVertexAttribArray(a),
Ia[a]=0)}function x(a,b){return a.z!==b.z?b.z-a.z:a.id-b.id}function C(a,b){return a.z!==b.z?a.z-b.z:a.id-b.id}function E(a,b){return b[0]-a[0]}function A(a,b,c){if(!1!==b.visible){var e=a.wc[b.id];if(e&&(!1===b.Ve||!0===Pb.lh(b))){var f=b.k,g,h,k;if(f instanceof d.wa){var l=p.DYNAMIC_DRAW,v=f.attributes,w,x;for(w in v)x=v[w],x.H&&("index"===w?(p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,x.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,x.d,l)):(p.bindBuffer(p.ARRAY_BUFFER,x.buffer),p.bufferData(p.ARRAY_BUFFER,
x.d,l)),x.H=!1)}else if(b instanceof d.Y){if(f.Fi||f.ih)f instanceof d.wa?u(f):b instanceof d.Y&&L(a,b,f);for(var z=0,y=f.Hc.length;z<y;z++)if(g=f.Hc[z],k=q(b,g),(f.Fi||f.ih)&&n(g,b),h=k.attributes&&ea(k),f.Oa||f.$i||f.dh||f.Oh||f.dg||f.Eb||f.Kh||h){var C=g,D=p.DYNAMIC_DRAW,H=!f.xo,G=k;if(C.vk){var F=r(G),J=G.s?G.s:!1,R=s(G),P=F===d.Qd,B=void 0,K=void 0,Q=void 0,M=void 0,S=void 0,ua=void 0,ba=void 0,V=void 0,U=void 0,aa=void 0,ca=void 0,ia=void 0,ja=void 0,ka=void 0,na=void 0,Y=void 0,sa=void 0,da=
void 0,Ga=void 0,X=void 0,Ca=void 0,W=void 0,ga=void 0,la=void 0,Va=void 0,gb=void 0,qa=void 0,Ua=void 0,ta=void 0,va=void 0,La=void 0,Ea=void 0,Ia=void 0,Ja=void 0,pa=void 0,Qa=void 0,za=void 0,Ta=void 0,Pa=void 0,Ra=void 0,Da=0,Ha=0,db=0,$a=0,fb=0,qb=0,eb=0,Kb=0,lb=0,Ba=0,Ma=0,O=0,ab=void 0,rb=C.Ie,zb=C.Ek,Hb=C.Dk,Rb=C.zk,hb=C.Ck,sb=C.Fe,ib=C.Ak,jb=C.Bk,Mb=C.yk,Ob=C.xk,Jb=C.rb,I=void 0,Db=C.uk,Sb=C.wk,Wa=b.k,Zb=Wa.dh,Qb=Wa.Oh,mc=Wa.dg,oc=Wa.Kh,pc=Wa.Eb,vc=Wa.$i,Oc=Wa.e,ma=C.$k,tb=Wa.j,ec=Wa.D[0],
fc=Wa.D[1],Pc=Wa.Kb,xc=Wa.Sb,yc=Wa.w,gc=Wa.Ja;if(Wa.Oa){B=0;for(K=ma.length;B<K;B++)M=tb[ma[B]],ia=Oc[M.N],ja=Oc[M.i],ka=Oc[M.O],rb[Ha]=ia.x,rb[Ha+1]=ia.y,rb[Ha+2]=ia.z,rb[Ha+3]=ja.x,rb[Ha+4]=ja.y,rb[Ha+5]=ja.z,rb[Ha+6]=ka.x,rb[Ha+7]=ka.y,rb[Ha+8]=ka.z,Ha+=9;p.bindBuffer(p.ARRAY_BUFFER,C.ib);p.bufferData(p.ARRAY_BUFFER,rb,D)}if(vc)for(pa=0,Qa=yc.length;pa<Qa;pa++){B=Ma=0;for(K=ma.length;B<K;B++)Pa=ma[B],M=tb[Pa],ia=yc[pa].e[M.N],ja=yc[pa].e[M.i],ka=yc[pa].e[M.O],za=Mb[pa],za[Ma]=ia.x,za[Ma+1]=ia.y,
za[Ma+2]=ia.z,za[Ma+3]=ja.x,za[Ma+4]=ja.y,za[Ma+5]=ja.z,za[Ma+6]=ka.x,za[Ma+7]=ka.y,za[Ma+8]=ka.z,G.Ja&&(P?(Ra=gc[pa].na[Pa],da=Ra.N,Ga=Ra.i,X=Ra.O):X=Ga=da=gc[pa].hr[Pa],Ta=Ob[pa],Ta[Ma]=da.x,Ta[Ma+1]=da.y,Ta[Ma+2]=da.z,Ta[Ma+3]=Ga.x,Ta[Ma+4]=Ga.y,Ta[Ma+5]=Ga.z,Ta[Ma+6]=X.x,Ta[Ma+7]=X.y,Ta[Ma+8]=X.z),Ma+=9;p.bindBuffer(p.ARRAY_BUFFER,C.Je[pa]);p.bufferData(p.ARRAY_BUFFER,Mb[pa],D);G.Ja&&(p.bindBuffer(p.ARRAY_BUFFER,C.uf[pa]),p.bufferData(p.ARRAY_BUFFER,Ob[pa],D))}if(xc.length){B=0;for(K=ma.length;B<
K;B++)M=tb[ma[B]],la=xc[M.N],Va=xc[M.i],gb=xc[M.O],jb[Ba]=la.x,jb[Ba+1]=la.y,jb[Ba+2]=la.z,jb[Ba+3]=la.f,jb[Ba+4]=Va.x,jb[Ba+5]=Va.y,jb[Ba+6]=Va.z,jb[Ba+7]=Va.f,jb[Ba+8]=gb.x,jb[Ba+9]=gb.y,jb[Ba+10]=gb.z,jb[Ba+11]=gb.f,qa=Pc[M.N],Ua=Pc[M.i],ta=Pc[M.O],ib[Ba]=qa.x,ib[Ba+1]=qa.y,ib[Ba+2]=qa.z,ib[Ba+3]=qa.f,ib[Ba+4]=Ua.x,ib[Ba+5]=Ua.y,ib[Ba+6]=Ua.z,ib[Ba+7]=Ua.f,ib[Ba+8]=ta.x,ib[Ba+9]=ta.y,ib[Ba+10]=ta.z,ib[Ba+11]=ta.f,Ba+=12;0<Ba&&(p.bindBuffer(p.ARRAY_BUFFER,C.Rg),p.bufferData(p.ARRAY_BUFFER,ib,D),
p.bindBuffer(p.ARRAY_BUFFER,C.Sg),p.bufferData(p.ARRAY_BUFFER,jb,D))}if(pc&&J){B=0;for(K=ma.length;B<K;B++)M=tb[ma[B]],ba=M.s,V=M.color,3===ba.length&&J===d.Rd?(Ca=ba[0],W=ba[1],ga=ba[2]):ga=W=Ca=V,sb[lb]=Ca.C,sb[lb+1]=Ca.B,sb[lb+2]=Ca.i,sb[lb+3]=W.C,sb[lb+4]=W.B,sb[lb+5]=W.i,sb[lb+6]=ga.C,sb[lb+7]=ga.B,sb[lb+8]=ga.i,lb+=9;0<lb&&(p.bindBuffer(p.ARRAY_BUFFER,C.cc),p.bufferData(p.ARRAY_BUFFER,sb,D))}if(oc&&Wa.Ui){B=0;for(K=ma.length;B<K;B++)M=tb[ma[B]],U=M.Gd,na=U[0],Y=U[1],sa=U[2],hb[eb]=na.x,hb[eb+
1]=na.y,hb[eb+2]=na.z,hb[eb+3]=na.f,hb[eb+4]=Y.x,hb[eb+5]=Y.y,hb[eb+6]=Y.z,hb[eb+7]=Y.f,hb[eb+8]=sa.x,hb[eb+9]=sa.y,hb[eb+10]=sa.z,hb[eb+11]=sa.f,eb+=12;p.bindBuffer(p.ARRAY_BUFFER,C.Tg);p.bufferData(p.ARRAY_BUFFER,hb,D)}if(mc&&F){B=0;for(K=ma.length;B<K;B++)if(M=tb[ma[B]],S=M.na,ua=M.F,3===S.length&&P)for(va=0;3>va;va++)Ea=S[va],Rb[qb]=Ea.x,Rb[qb+1]=Ea.y,Rb[qb+2]=Ea.z,qb+=3;else for(va=0;3>va;va++)Rb[qb]=ua.x,Rb[qb+1]=ua.y,Rb[qb+2]=ua.z,qb+=3;p.bindBuffer(p.ARRAY_BUFFER,C.Td);p.bufferData(p.ARRAY_BUFFER,
Rb,D)}if(Qb&&ec&&R){B=0;for(K=ma.length;B<K;B++)if(Q=ma[B],aa=ec[Q],void 0!==aa)for(va=0;3>va;va++)Ia=aa[va],zb[db]=Ia.x,zb[db+1]=Ia.y,db+=2;0<db&&(p.bindBuffer(p.ARRAY_BUFFER,C.Vg),p.bufferData(p.ARRAY_BUFFER,zb,D))}if(Qb&&fc&&R){B=0;for(K=ma.length;B<K;B++)if(Q=ma[B],ca=fc[Q],void 0!==ca)for(va=0;3>va;va++)Ja=ca[va],Hb[$a]=Ja.x,Hb[$a+1]=Ja.y,$a+=2;0<$a&&(p.bindBuffer(p.ARRAY_BUFFER,C.Ug),p.bufferData(p.ARRAY_BUFFER,Hb,D))}if(Zb){B=0;for(K=ma.length;B<K;B++)Db[fb]=Da,Db[fb+1]=Da+1,Db[fb+2]=Da+2,
fb+=3,Sb[Kb]=Da,Sb[Kb+1]=Da+1,Sb[Kb+2]=Da,Sb[Kb+3]=Da+2,Sb[Kb+4]=Da+1,Sb[Kb+5]=Da+2,Kb+=6,Da+=3;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,C.Og);p.bufferData(p.ELEMENT_ARRAY_BUFFER,Db,D);p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,C.Pg);p.bufferData(p.ELEMENT_ARRAY_BUFFER,Sb,D)}if(Jb)for(va=0,La=Jb.length;va<La;va++)if(I=Jb[va],I.En.H){O=0;if(1===I.size)if(void 0===I.Ha||"vertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)M=tb[ma[B]],I.d[O]=I.value[M.N],I.d[O+1]=I.value[M.i],I.d[O+2]=I.value[M.O],O+=3;else{if("faces"===
I.Ha)for(B=0,K=ma.length;B<K;B++)ab=I.value[ma[B]],I.d[O]=ab,I.d[O+1]=ab,I.d[O+2]=ab,O+=3}else if(2===I.size)if(void 0===I.Ha||"vertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)M=tb[ma[B]],ia=I.value[M.N],ja=I.value[M.i],ka=I.value[M.O],I.d[O]=ia.x,I.d[O+1]=ia.y,I.d[O+2]=ja.x,I.d[O+3]=ja.y,I.d[O+4]=ka.x,I.d[O+5]=ka.y,O+=6;else{if("faces"===I.Ha)for(B=0,K=ma.length;B<K;B++)ka=ja=ia=ab=I.value[ma[B]],I.d[O]=ia.x,I.d[O+1]=ia.y,I.d[O+2]=ja.x,I.d[O+3]=ja.y,I.d[O+4]=ka.x,I.d[O+5]=ka.y,O+=6}else if(3===I.size){var ya;
ya="c"===I.type?["r","g","b"]:["x","y","z"];if(void 0===I.Ha||"vertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)M=tb[ma[B]],ia=I.value[M.N],ja=I.value[M.i],ka=I.value[M.O],I.d[O]=ia[ya[0]],I.d[O+1]=ia[ya[1]],I.d[O+2]=ia[ya[2]],I.d[O+3]=ja[ya[0]],I.d[O+4]=ja[ya[1]],I.d[O+5]=ja[ya[2]],I.d[O+6]=ka[ya[0]],I.d[O+7]=ka[ya[1]],I.d[O+8]=ka[ya[2]],O+=9;else if("faces"===I.Ha)for(B=0,K=ma.length;B<K;B++)ka=ja=ia=ab=I.value[ma[B]],I.d[O]=ia[ya[0]],I.d[O+1]=ia[ya[1]],I.d[O+2]=ia[ya[2]],I.d[O+3]=ja[ya[0]],I.d[O+4]=
ja[ya[1]],I.d[O+5]=ja[ya[2]],I.d[O+6]=ka[ya[0]],I.d[O+7]=ka[ya[1]],I.d[O+8]=ka[ya[2]],O+=9;else if("faceVertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)ab=I.value[ma[B]],ia=ab[0],ja=ab[1],ka=ab[2],I.d[O]=ia[ya[0]],I.d[O+1]=ia[ya[1]],I.d[O+2]=ia[ya[2]],I.d[O+3]=ja[ya[0]],I.d[O+4]=ja[ya[1]],I.d[O+5]=ja[ya[2]],I.d[O+6]=ka[ya[0]],I.d[O+7]=ka[ya[1]],I.d[O+8]=ka[ya[2]],O+=9}else if(4===I.size)if(void 0===I.Ha||"vertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)M=tb[ma[B]],ia=I.value[M.N],ja=I.value[M.i],ka=I.value[M.O],
I.d[O]=ia.x,I.d[O+1]=ia.y,I.d[O+2]=ia.z,I.d[O+3]=ia.f,I.d[O+4]=ja.x,I.d[O+5]=ja.y,I.d[O+6]=ja.z,I.d[O+7]=ja.f,I.d[O+8]=ka.x,I.d[O+9]=ka.y,I.d[O+10]=ka.z,I.d[O+11]=ka.f,O+=12;else if("faces"===I.Ha)for(B=0,K=ma.length;B<K;B++)ka=ja=ia=ab=I.value[ma[B]],I.d[O]=ia.x,I.d[O+1]=ia.y,I.d[O+2]=ia.z,I.d[O+3]=ia.f,I.d[O+4]=ja.x,I.d[O+5]=ja.y,I.d[O+6]=ja.z,I.d[O+7]=ja.f,I.d[O+8]=ka.x,I.d[O+9]=ka.y,I.d[O+10]=ka.z,I.d[O+11]=ka.f,O+=12;else if("faceVertices"===I.Ha)for(B=0,K=ma.length;B<K;B++)ab=I.value[ma[B]],
ia=ab[0],ja=ab[1],ka=ab[2],I.d[O]=ia.x,I.d[O+1]=ia.y,I.d[O+2]=ia.z,I.d[O+3]=ia.f,I.d[O+4]=ja.x,I.d[O+5]=ja.y,I.d[O+6]=ja.z,I.d[O+7]=ja.f,I.d[O+8]=ka.x,I.d[O+9]=ka.y,I.d[O+10]=ka.z,I.d[O+11]=ka.f,O+=12;p.bindBuffer(p.ARRAY_BUFFER,I.buffer);p.bufferData(p.ARRAY_BUFFER,I.d,D)}H&&(delete C.vk,delete C.Fe,delete C.zk,delete C.Ck,delete C.Ek,delete C.Dk,delete C.uk,delete C.Ie,delete C.wk,delete C.Ak,delete C.Bk)}}f.Oa=!1;f.$i=!1;f.dh=!1;f.Oh=!1;f.dg=!1;f.Eb=!1;f.Kh=!1;f.Fi=!1;k.attributes&&T(k)}else if(b instanceof
d.U){k=q(b,f);h=k.attributes&&ea(k);if(f.Oa||f.Eb||f.oh||h){var zc=p.DYNAMIC_DRAW,jc,kc,lc,Ac,xa,Bc,hc=f.e,ic=f.ka,nc=f.Xo,Hc=hc.length,Ic=ic.length,Jc=nc.length,Cc=f.Ie,Dc=f.Fe,md=f.Cn,Vc=f.Eb,Wc=f.oh,Qc=f.rb,Ec,nd,Na,$b,Xa,wa;if(f.Oa){for(jc=0;jc<Hc;jc++)Ac=hc[jc],xa=3*jc,Cc[xa]=Ac.x,Cc[xa+1]=Ac.y,Cc[xa+2]=Ac.z;p.bindBuffer(p.ARRAY_BUFFER,f.ib);p.bufferData(p.ARRAY_BUFFER,Cc,zc)}if(Vc){for(kc=0;kc<Ic;kc++)Bc=ic[kc],xa=3*kc,Dc[xa]=Bc.C,Dc[xa+1]=Bc.B,Dc[xa+2]=Bc.i;p.bindBuffer(p.ARRAY_BUFFER,f.cc);
p.bufferData(p.ARRAY_BUFFER,Dc,zc)}if(Wc){for(lc=0;lc<Jc;lc++)md[lc]=nc[lc];p.bindBuffer(p.ARRAY_BUFFER,f.Qg);p.bufferData(p.ARRAY_BUFFER,md,zc)}if(Qc)for(Ec=0,nd=Qc.length;Ec<nd;Ec++)if(wa=Qc[Ec],wa.H&&(void 0===wa.Ha||"vertices"===wa.Ha)){xa=0;$b=wa.value.length;if(1===wa.size)for(Na=0;Na<$b;Na++)wa.d[Na]=wa.value[Na];else if(2===wa.size)for(Na=0;Na<$b;Na++)Xa=wa.value[Na],wa.d[xa]=Xa.x,wa.d[xa+1]=Xa.y,xa+=2;else if(3===wa.size)if("c"===wa.type)for(Na=0;Na<$b;Na++)Xa=wa.value[Na],wa.d[xa]=Xa.C,
wa.d[xa+1]=Xa.B,wa.d[xa+2]=Xa.i,xa+=3;else for(Na=0;Na<$b;Na++)Xa=wa.value[Na],wa.d[xa]=Xa.x,wa.d[xa+1]=Xa.y,wa.d[xa+2]=Xa.z,xa+=3;else if(4===wa.size)for(Na=0;Na<$b;Na++)Xa=wa.value[Na],wa.d[xa]=Xa.x,wa.d[xa+1]=Xa.y,wa.d[xa+2]=Xa.z,wa.d[xa+3]=Xa.f,xa+=4;p.bindBuffer(p.ARRAY_BUFFER,wa.buffer);p.bufferData(p.ARRAY_BUFFER,wa.d,zc)}}f.Oa=!1;f.Eb=!1;f.oh=!1;k.attributes&&T(k)}else if(b instanceof d.Ab){k=q(b,f);h=k.attributes&&ea(k);if(f.Oa||f.Eb||b.qe||h){var Rc=p.DYNAMIC_DRAW,Ya,ub,vb,$,wb,Lb,Fc=f.e,
Sc=Fc.length,Tc=f.ka,od=Tc.length,Tb=f.Ie,Ub=f.Fe,Fb=f.Gn,pd=f.Oa,qd=f.Eb,Gb=f.rb,mb,ac,ha,nb,ra,Z;if(b.qe){wc.c(Eb);wc.multiply(b.m);for(Ya=0;Ya<Sc;Ya++)vb=Fc[Ya],Fa.c(vb),Wb(Fa,wc),Fb[Ya]=[Fa.z,Ya];Fb.sort(E);for(Ya=0;Ya<Sc;Ya++)vb=Fc[Fb[Ya][1]],$=3*Ya,Tb[$]=vb.x,Tb[$+1]=vb.y,Tb[$+2]=vb.z;for(ub=0;ub<od;ub++)$=3*ub,Lb=Tc[Fb[ub][1]],Ub[$]=Lb.C,Ub[$+1]=Lb.B,Ub[$+2]=Lb.i;if(Gb)for(mb=0,ac=Gb.length;mb<ac;mb++)if(Z=Gb[mb],void 0===Z.Ha||"vertices"===Z.Ha)if($=0,nb=Z.value.length,1===Z.size)for(ha=0;ha<
nb;ha++)wb=Fb[ha][1],Z.d[ha]=Z.value[wb];else if(2===Z.size)for(ha=0;ha<nb;ha++)wb=Fb[ha][1],ra=Z.value[wb],Z.d[$]=ra.x,Z.d[$+1]=ra.y,$+=2;else if(3===Z.size)if("c"===Z.type)for(ha=0;ha<nb;ha++)wb=Fb[ha][1],ra=Z.value[wb],Z.d[$]=ra.C,Z.d[$+1]=ra.B,Z.d[$+2]=ra.i,$+=3;else for(ha=0;ha<nb;ha++)wb=Fb[ha][1],ra=Z.value[wb],Z.d[$]=ra.x,Z.d[$+1]=ra.y,Z.d[$+2]=ra.z,$+=3;else if(4===Z.size)for(ha=0;ha<nb;ha++)wb=Fb[ha][1],ra=Z.value[wb],Z.d[$]=ra.x,Z.d[$+1]=ra.y,Z.d[$+2]=ra.z,Z.d[$+3]=ra.f,$+=4}else{if(pd)for(Ya=
0;Ya<Sc;Ya++)vb=Fc[Ya],$=3*Ya,Tb[$]=vb.x,Tb[$+1]=vb.y,Tb[$+2]=vb.z;if(qd)for(ub=0;ub<od;ub++)Lb=Tc[ub],$=3*ub,Ub[$]=Lb.C,Ub[$+1]=Lb.B,Ub[$+2]=Lb.i;if(Gb)for(mb=0,ac=Gb.length;mb<ac;mb++)if(Z=Gb[mb],Z.H&&(void 0===Z.Ha||"vertices"===Z.Ha))if(nb=Z.value.length,$=0,1===Z.size)for(ha=0;ha<nb;ha++)Z.d[ha]=Z.value[ha];else if(2===Z.size)for(ha=0;ha<nb;ha++)ra=Z.value[ha],Z.d[$]=ra.x,Z.d[$+1]=ra.y,$+=2;else if(3===Z.size)if("c"===Z.type)for(ha=0;ha<nb;ha++)ra=Z.value[ha],Z.d[$]=ra.C,Z.d[$+1]=ra.B,Z.d[$+
2]=ra.i,$+=3;else for(ha=0;ha<nb;ha++)ra=Z.value[ha],Z.d[$]=ra.x,Z.d[$+1]=ra.y,Z.d[$+2]=ra.z,$+=3;else if(4===Z.size)for(ha=0;ha<nb;ha++)ra=Z.value[ha],Z.d[$]=ra.x,Z.d[$+1]=ra.y,Z.d[$+2]=ra.z,Z.d[$+3]=ra.f,$+=4}if(pd||b.qe)p.bindBuffer(p.ARRAY_BUFFER,f.ib),p.bufferData(p.ARRAY_BUFFER,Tb,Rc);if(qd||b.qe)p.bindBuffer(p.ARRAY_BUFFER,f.cc),p.bufferData(p.ARRAY_BUFFER,Ub,Rc);if(Gb)for(mb=0,ac=Gb.length;mb<ac;mb++)if(Z=Gb[mb],Z.H||b.qe)p.bindBuffer(p.ARRAY_BUFFER,Z.buffer),p.bufferData(p.ARRAY_BUFFER,Z.d,
Rc)}f.Oa=!1;f.Eb=!1;k.attributes&&T(k)}for(var Vb=0,Uc=e.length;Vb<Uc;Vb++){var Gc=e[Vb],xb=Gc,rd=xb.object,Xc=xb.buffer,Yc=rd.k,yb=rd.r;yb instanceof d.jd?(yb=yb.Va[Yc instanceof d.wa?0:Xc.Hb],yb.eb?(xb.r=yb,oa.push(xb)):(xb.r=yb,Aa.push(xb))):yb&&(yb.eb?(xb.r=yb,oa.push(xb)):(xb.r=yb,Aa.push(xb)));Gc.t=!0;!0===N.Jh&&(null!==b.df?Gc.z=b.df:(Cb(Fa,b.m),Wb(Fa,Eb),Gc.z=Fa.z))}}Vb=0;for(Uc=b.children.length;Vb<Uc;Vb++)A(a,b.children[Vb],c)}}function H(a,b,c){if(0!==a.length)for(var e=0,f=a.length;e<
f;e++)la=Ea=null,Ja=qa=Pa=Ra=Mb=Da=Ha=-1,Hb=!0,a[e].t(b,c,hc,ic),la=Ea=null,Ja=qa=Pa=Ra=Mb=Da=Ha=-1,Hb=!0}function B(a,b,c,e,f,g){for(var h,k,p,l=a.length-1;-1!==l;l--){h=a[l];k=h.object;p=h.buffer;J(k,b);if(g)h=g;else{h=h.r;if(!h)continue;f&&N.ef(h.Pa,h.blendEquation,h.ae,h.$d);N.ne(h.Dc);N.mg(h.Ec);U(h.polygonOffset,h.jg,h.kg)}N.Bh(h);p instanceof d.wa?N.jj(b,c,e,h,p,k):N.ij(b,c,e,h,p,k)}}function D(a,b,c,e,f,g,h){for(var k,p,l=0,n=a.length;l<n;l++)if(k=a[l],p=k.object,p.visible){if(h)k=h;else{k=
k[b];if(!k)continue;g&&N.ef(k.Pa,k.blendEquation,k.ae,k.$d);N.ne(k.Dc);N.mg(k.Ec);U(k.polygonOffset,k.jg,k.kg)}N.kj(c,e,f,k,p)}}function F(a){var b=a.object.r;b.eb?(a.eb=b,a.Dl=null):(a.Dl=b,a.eb=null)}function L(a,b,c){var e,f=!1;e=b.r;if(void 0===c.Gc||c.ih)delete a.wc[b.id],c.Yo(e instanceof d.jd,Qb?4294967296:65535),c.ih=!1;for(var g=0,h=c.Hc.length;g<h;g++){e=c.Hc[g];if(e.ib)f=!1;else{f=e;f.ib=p.createBuffer();f.Td=p.createBuffer();f.Tg=p.createBuffer();f.cc=p.createBuffer();f.Vg=p.createBuffer();
f.Ug=p.createBuffer();f.Rg=p.createBuffer();f.Sg=p.createBuffer();f.Og=p.createBuffer();f.Pg=p.createBuffer();var k=void 0,l=void 0;if(f.fg)for(f.Je=[],k=0,l=f.fg;k<l;k++)f.Je.push(p.createBuffer());if(f.eg)for(f.uf=[],k=0,l=f.eg;k<l;k++)f.uf.push(p.createBuffer());N.info.memory.We++;n(e,b);c.Oa=!0;c.$i=!0;c.dh=!0;c.Oh=!0;c.dg=!0;c.Kh=!0;f=c.Eb=!0}(f||void 0===b.tf)&&M(a.wc,e,b)}b.tf=!0}function M(a,b,c){var e=c.id;a[e]=a[e]||[];a[e].push({id:e,buffer:b,object:c,r:null,z:0})}function ea(a){for(var b in a.attributes)if(a.attributes[b].H)return!0;
return!1}function T(a){for(var b in a.attributes)a.attributes[b].H=!1}function Q(a,b){if(a instanceof d.Y||a instanceof d.Ab||a instanceof d.U)delete b.wc[a.id];else if(a instanceof d.Zh||a.Wi)for(var c=b.nd,e=c.length-1;0<=e;e--)c[e].object===a&&c.splice(e,1);delete a.tf}function P(a,c,e,f,h){ta=0;f.H&&(f.Ya&&b(f),N.Uo(f,c,e,h),f.H=!1);f.w&&!h.vf&&(h.vf=new Float32Array(N.Zf));var k=!1,l=!1,n=!1,q=f.Ya,s=q.M,u=f.Ud.M;q.id!==Ea&&(p.useProgram(q.Ya),Ea=q.id,n=l=k=!0);f.id!==Ja&&(-1===Ja&&(n=!0),Ja=
f.id,l=!0);if(k||a!==la)p.uniformMatrix4fv(s.za,!1,a.za.elements),Ta&&p.uniform1f(s.Ar,2/(Math.log(a.Ta+1)/Math.LN2)),a!==la&&(la=a),(f instanceof d.Fa||f instanceof d.Yb||f.qa)&&null!==s.io&&(Cb(Fa,a.m),p.uniform3f(s.io,Fa.x,Fa.y,Fa.z)),(f instanceof d.Yb||f instanceof d.sc||f instanceof d.Fa||f.va)&&null!==s.cq&&p.uniformMatrix4fv(s.cq,!1,a.Ea.elements);f.va&&(h.Me&&null!==s.Me&&p.uniformMatrix4fv(s.Me,!1,h.Me.elements),h.Zd&&null!==s.Zd&&p.uniformMatrix4fv(s.Zd,!1,h.Zd.elements),mc&&h.Za&&h.Za.fd?
(null!==s.sd&&(k=K(),p.uniform1i(s.sd,k),N.ff(h.Za.sd,k)),null!==s.Bf&&p.uniform1i(s.Bf,h.Za.Bf),null!==s.Af&&p.uniform1i(s.Af,h.Za.Af)):h.Za&&h.Za.zf&&null!==s.ho&&p.uniformMatrix4fv(s.ho,!1,h.Za.zf));if(l){e&&f.L&&(u.kr.value=e.color,e instanceof d.Dg?(u.nr.value=e.Xa,u.mr.value=e.Ta):e instanceof d.of&&(u.lr.value=e.Ki));if(f instanceof d.Yb||f instanceof d.sc||f.Wc){if(Hb){var n=!0,v,w=k=0,r=0,x,z,y,A=nc,C=A.Lf.ka,E=A.Lf.jc,D=A.le.ka,B=A.le.jc,H=A.le.Mf,F=A.Lb.ka,J=A.Lb.jc,M=A.Lb.Mf,P=A.Lb.Xk,
L=A.Lb.Ok,Q=A.Lb.Zk,S=A.fe.Xl,T=A.fe.gl,ea=A.fe.jc,U=0,V=0,na=0,Y=0,sa=0,da=0,Ga=0,Ca=0,W=v=0;e=y=W=0;for(l=c.length;e<l;e++)v=c[e],v.Bd||(x=v.color,z=v.ja,y=v.Da,v instanceof d.se?v.visible&&(N.Fc?(k+=x.C*x.C,w+=x.B*x.B,r+=x.i*x.i):(k+=x.C,w+=x.B,r+=x.i)):v instanceof d.vb?(sa+=1,v.visible&&(Cb(za,v.m),Cb(Fa,v.target.m),za.sub(Fa),za.normalize(),v=3*U,E[v]=za.x,E[v+1]=za.y,E[v+2]=za.z,N.Fc?ba(C,v,x,z*z):R(C,v,x,z),U+=1)):v instanceof d.ld?(da+=1,v.visible&&(W=3*V,N.Fc?ba(D,W,x,z*z):R(D,W,x,z),Cb(Fa,
v.m),B[W]=Fa.x,B[W+1]=Fa.y,B[W+2]=Fa.z,H[V]=y,V+=1)):v instanceof d.Oc?(Ga+=1,v.visible&&(W=3*na,N.Fc?ba(F,W,x,z*z):R(F,W,x,z),Cb(Fa,v.m),J[W]=Fa.x,J[W+1]=Fa.y,J[W+2]=Fa.z,M[na]=y,za.c(Fa),Cb(Fa,v.target.m),za.sub(Fa),za.normalize(),P[W]=za.x,P[W+1]=za.y,P[W+2]=za.z,L[na]=Math.cos(v.xf),Q[na]=v.eh,na+=1)):v instanceof d.xe&&(Ca+=1,v.visible&&(Cb(za,v.m),za.normalize(),y=3*Y,ea[y]=za.x,ea[y+1]=za.y,ea[y+2]=za.z,x=v.color,v=v.Uf,N.Fc?(z*=z,ba(S,y,x,z),ba(T,y,v,z)):(R(S,y,x,z),R(T,y,v,z)),Y+=1)));e=
3*U;for(l=Math.max(C.length,3*sa);e<l;e++)C[e]=0;e=3*V;for(l=Math.max(D.length,3*da);e<l;e++)D[e]=0;e=3*na;for(l=Math.max(F.length,3*Ga);e<l;e++)F[e]=0;e=3*Y;for(l=Math.max(S.length,3*Ca);e<l;e++)S[e]=0;e=3*Y;for(l=Math.max(T.length,3*Ca);e<l;e++)T[e]=0;A.Lf.length=U;A.le.length=V;A.Lb.length=na;A.fe.length=Y;A.ta[0]=k;A.ta[1]=w;A.ta[2]=r;Hb=!1}n?(n=nc,u.Rn.value=n.ta,u.to.value=n.Lf.ka,u.uo.value=n.Lf.jc,u.pp.value=n.le.ka,u.rp.value=n.le.jc,u.qp.value=n.le.Mf,u.Mp.value=n.Lb.ka,u.Qp.value=n.Lb.jc,
u.Op.value=n.Lb.Mf,u.Np.value=n.Lb.Xk,u.Lp.value=n.Lb.Ok,u.Pp.value=n.Lb.Zk,u.Po.value=n.fe.Xl,u.Oo.value=n.fe.gl,u.No.value=n.fe.jc,G(u,!0)):G(u,!1)}if(f instanceof d.xb||f instanceof d.sc||f instanceof d.Yb){u.opacity.value=f.opacity;N.Fc?Ab(u.Mi.value,f.color):u.Mi.value=f.color;u.map.value=f.map;u.Ua.value=f.Ua;u.Na.value=f.Na;u.bb.value=f.bb;f.sb&&(u.sb.value=f.sb,u.Cf.value=f.Cf);f.ob&&(u.ob.value=f.ob,u.uh.value.c(f.uh));var X;f.map?X=f.map:f.Na?X=f.Na:f.ob?X=f.ob:f.sb?X=f.sb:f.bb&&(X=f.bb);
void 0!==X&&(n=X.offset,X=X.repeat,u.is.value.set(n.x,n.y,X.x,X.y));u.qa.value=f.qa;u.jr.value=f.qa instanceof d.Sd?1:-1;u.Kc.value=f.Kc;u.Lc.value=f.Lc;u.Ac.value=f.Ac;u.Js.value=f.qa&&f.qa.Ze instanceof d.um}f instanceof d.Ba?(u.Mi.value=f.color,u.opacity.value=f.opacity):f instanceof d.ze?(u.Mi.value=f.color,u.opacity.value=f.opacity,u.Pe.value=f.Pe,u.Hs.value=f.Pe+f.gh,u.scale.value=f.scale):f instanceof d.uc?(u.os.value=f.color,u.opacity.value=f.opacity,u.size.value=f.size,u.scale.value=ua.height/
2,u.map.value=f.map):f instanceof d.Yb?(u.ed.value=f.ed,N.Fc?(Ab(u.ta.value,f.ta),Ab(u.Sa.value,f.Sa),Ab(u.lc.value,f.lc)):(u.ta.value=f.ta,u.Sa.value=f.Sa,u.lc.value=f.lc),f.pc&&u.gd.value.c(f.gd)):f instanceof d.sc?(N.Fc?(Ab(u.ta.value,f.ta),Ab(u.Sa.value,f.Sa)):(u.ta.value=f.ta,u.Sa.value=f.Sa),f.pc&&u.gd.value.c(f.gd)):f instanceof d.Kd?(u.Cr.value=a.Xa,u.Br.value=a.Ta,u.opacity.value=f.opacity):f instanceof d.Ae&&(u.opacity.value=f.opacity);if(h.xh&&!f.pd&&u.hf)for(X=a=0,n=c.length;X<n;X++)e=
c[X],e.tb&&(e instanceof d.Oc||e instanceof d.vb&&!e.sg)&&(u.gf.value[a]=e.gf,u.Hh.value[a]=e.Hh,u.hf.value[a]=e.hf,u.kc.value[a]=e.kc,u.Zc.value[a]=e.Zc,a++);c=f.dm;f=0;for(u=c.length;f<u;f++)if(a=c[f][0],!1!==a.H)switch(e=a.type,n=a.value,X=c[f][1],e){case "1i":p.uniform1i(X,n);break;case "1f":p.uniform1f(X,n);break;case "2f":p.uniform2f(X,n[0],n[1]);break;case "3f":p.uniform3f(X,n[0],n[1],n[2]);break;case "4f":p.uniform4f(X,n[0],n[1],n[2],n[3]);break;case "1iv":p.uniform1iv(X,n);break;case "3iv":p.uniform3iv(X,
n);break;case "1fv":p.uniform1fv(X,n);break;case "2fv":p.uniform2fv(X,n);break;case "3fv":p.uniform3fv(X,n);break;case "4fv":p.uniform4fv(X,n);break;case "Matrix3fv":p.uniformMatrix3fv(X,!1,n);break;case "Matrix4fv":p.uniformMatrix4fv(X,!1,n);break;case "i":p.uniform1i(X,n);break;case "f":p.uniform1f(X,n);break;case "v2":p.uniform2f(X,n.x,n.y);break;case "v3":p.uniform3f(X,n.x,n.y,n.z);break;case "v4":p.uniform4f(X,n.x,n.y,n.z,n.f);break;case "c":p.uniform3f(X,n.C,n.B,n.i);break;case "iv1":p.uniform1iv(X,
n);break;case "iv":p.uniform3iv(X,n);break;case "fv1":p.uniform1fv(X,n);break;case "fv":p.uniform3fv(X,n);break;case "v2v":void 0===a.aa&&(a.aa=new Float32Array(2*n.length));e=0;for(l=n.length;e<l;e++)k=2*e,a.aa[k]=n[e].x,a.aa[k+1]=n[e].y;p.uniform2fv(X,a.aa);break;case "v3v":void 0===a.aa&&(a.aa=new Float32Array(3*n.length));e=0;for(l=n.length;e<l;e++)k=3*e,a.aa[k]=n[e].x,a.aa[k+1]=n[e].y,a.aa[k+2]=n[e].z;p.uniform3fv(X,a.aa);break;case "v4v":void 0===a.aa&&(a.aa=new Float32Array(4*n.length));e=
0;for(l=n.length;e<l;e++)k=4*e,a.aa[k]=n[e].x,a.aa[k+1]=n[e].y,a.aa[k+2]=n[e].z,a.aa[k+3]=n[e].f;p.uniform4fv(X,a.aa);break;case "m3":p.uniformMatrix3fv(X,!1,n.elements);break;case "m3v":void 0===a.aa&&(a.aa=new Float32Array(9*n.length));e=0;for(l=n.length;e<l;e++)n[e].fh(a.aa,9*e);p.uniformMatrix3fv(X,!1,a.aa);break;case "m4":p.uniformMatrix4fv(X,!1,n.elements);break;case "m4v":void 0===a.aa&&(a.aa=new Float32Array(16*n.length));e=0;for(l=n.length;e<l;e++)n[e].fh(a.aa,16*e);p.uniformMatrix4fv(X,
!1,a.aa);break;case "t":k=n;n=K();p.uniform1i(X,n);if(!k)continue;if(k instanceof d.lf||k.$ instanceof Array&&6===k.$.length){if(a=k,X=n,6===a.$.length)if(a.H){a.$.wf||(a.addEventListener("dispose",g),a.$.wf=p.createTexture(),N.info.memory.wg++);p.activeTexture(p.TEXTURE0+X);p.bindTexture(p.TEXTURE_CUBE_MAP,a.$.wf);p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,a.Ue);X=a instanceof d.ue;n=[];for(e=0;6>e;e++)l=e,N.Wn&&!X?(k=a.$[e],r=Vc,k.width<=r&&k.height<=r||(A=Math.max(k.width,k.height),w=Math.floor(k.width*
r/A),r=Math.floor(k.height*r/A),A=document.createElement("canvas"),A.width=w,A.height=r,A.getContext("2d").drawImage(k,0,0,k.width,k.height,0,0,w,r),k=A)):k=a.$[e],n[l]=k;e=n[0];l=d.Math.yd(e.width)&&d.Math.yd(e.height);k=aa(a.format);w=aa(a.type);ca(p.TEXTURE_CUBE_MAP,a,l);for(e=0;6>e;e++)if(X)for(A=n[e].ag,C=0,E=A.length;C<E;C++)r=A[C],a.format!==d.Nd?p.compressedTexImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+e,C,k,r.width,r.height,0,r.data):p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+e,C,k,r.width,r.height,
0,k,w,r.data);else p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,k,k,w,n[e]);a.Ob&&l&&p.generateMipmap(p.TEXTURE_CUBE_MAP);a.H=!1;a.vh&&a.vh()}else p.activeTexture(p.TEXTURE0+X),p.bindTexture(p.TEXTURE_CUBE_MAP,a.$.wf)}else k instanceof d.Sd?(a=k,p.activeTexture(p.TEXTURE0+n),p.bindTexture(p.TEXTURE_CUBE_MAP,a.Cb)):N.ff(k,n);break;case "tv":void 0===a.aa&&(a.aa=[]);e=0;for(l=a.value.length;e<l;e++)a.aa[e]=K();p.uniform1iv(X,a.aa);e=0;for(l=a.value.length;e<l;e++)k=a.value[e],n=a.aa[e],k&&N.ff(k,
n);break;default:console.warn("THREE.WebGLRenderer: Unknown uniform type: "+e)}}p.uniformMatrix4fv(s.gs,!1,h.xc.elements);s.je&&p.uniformMatrix3fv(s.je,!1,h.Ik.elements);null!==s.hp&&p.uniformMatrix4fv(s.hp,!1,h.m.elements);return q}function G(a,b){a.Rn.H=b;a.to.H=b;a.uo.H=b;a.pp.H=b;a.rp.H=b;a.qp.H=b;a.Mp.H=b;a.Qp.H=b;a.Op.H=b;a.Np.H=b;a.Lp.H=b;a.Pp.H=b;a.Po.H=b;a.Oo.H=b;a.No.H=b}function K(){var a=ta;a>=Hc&&console.warn("WebGLRenderer: trying to use "+a+" texture units while this GPU supports only "+
Hc);ta+=1;return a}function J(a,b){cc(a.xc,b.Ea,a.m);bc(a.Ik,a.xc)}function ba(a,b,c,e){a[b]=c.C*c.C*e;a[b+1]=c.B*c.B*e;a[b+2]=c.i*c.i*e}function R(a,b,c,e){a[b]=c.C*e;a[b+1]=c.B*e;a[b+2]=c.i*e}function V(a){a!==gc&&(p.lineWidth(a),gc=a)}function U(a,b,c){vc!==a&&(a?p.enable(p.POLYGON_OFFSET_FILL):p.disable(p.POLYGON_OFFSET_FILL),vc=a);!a||ec===b&&fc===c||(p.polygonOffset(b,c),ec=b,fc=c)}function ca(a,b,c){c?(p.texParameteri(a,p.TEXTURE_WRAP_S,aa(b.qc)),p.texParameteri(a,p.TEXTURE_WRAP_T,aa(b.rc)),
p.texParameteri(a,p.TEXTURE_MAG_FILTER,aa(b.Pb)),p.texParameteri(a,p.TEXTURE_MIN_FILTER,aa(b.ub))):(p.texParameteri(a,p.TEXTURE_WRAP_S,p.CLAMP_TO_EDGE),p.texParameteri(a,p.TEXTURE_WRAP_T,p.CLAMP_TO_EDGE),p.texParameteri(a,p.TEXTURE_MAG_FILTER,da(b.Pb)),p.texParameteri(a,p.TEXTURE_MIN_FILTER,da(b.ub)));zb&&b.type!==d.Xh&&(1<b.dc||b.Dn)&&(p.texParameterf(a,zb.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(b.dc,Wc)),b.Dn=b.dc)}function S(a,b){p.bindRenderbuffer(p.RENDERBUFFER,a);b.Cc&&!b.Nc?(p.renderbufferStorage(p.RENDERBUFFER,
p.DEPTH_COMPONENT16,b.width,b.height),p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,a)):b.Cc&&b.Nc?(p.renderbufferStorage(p.RENDERBUFFER,p.DEPTH_STENCIL,b.width,b.height),p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,a)):p.renderbufferStorage(p.RENDERBUFFER,p.RGBA4,b.width,b.height)}function Y(a){a instanceof d.Sd?(p.bindTexture(p.TEXTURE_CUBE_MAP,a.Cb),p.generateMipmap(p.TEXTURE_CUBE_MAP),p.bindTexture(p.TEXTURE_CUBE_MAP,null)):(p.bindTexture(p.TEXTURE_2D,
a.Cb),p.generateMipmap(p.TEXTURE_2D),p.bindTexture(p.TEXTURE_2D,null))}function da(a){return a===d.Be||a===d.Xj||a===d.Wj?p.NEAREST:p.LINEAR}function aa(a){if(a===d.De)return p.REPEAT;if(a===d.kf)return p.CLAMP_TO_EDGE;if(a===d.Uj)return p.MIRRORED_REPEAT;if(a===d.Be)return p.NEAREST;if(a===d.Xj)return p.NEAREST_MIPMAP_NEAREST;if(a===d.Wj)return p.NEAREST_MIPMAP_LINEAR;if(a===d.Jd)return p.LINEAR;if(a===d.Km)return p.LINEAR_MIPMAP_NEAREST;if(a===d.ci)return p.LINEAR_MIPMAP_LINEAR;if(a===d.qi)return p.UNSIGNED_BYTE;
if(a===d.un)return p.UNSIGNED_SHORT_4_4_4_4;if(a===d.vn)return p.UNSIGNED_SHORT_5_5_5_1;if(a===d.wn)return p.UNSIGNED_SHORT_5_6_5;if(a===d.pm)return p.BYTE;if(a===d.hn)return p.SHORT;if(a===d.xn)return p.UNSIGNED_SHORT;if(a===d.Gm)return p.INT;if(a===d.tn)return p.UNSIGNED_INT;if(a===d.Xh)return p.FLOAT;if(a===d.km)return p.ALPHA;if(a===d.ii)return p.RGB;if(a===d.Nd)return p.RGBA;if(a===d.Nm)return p.LUMINANCE;if(a===d.Mm)return p.LUMINANCE_ALPHA;if(a===d.Aj)return p.FUNC_ADD;if(a===d.on)return p.FUNC_SUBTRACT;
if(a===d.fn)return p.FUNC_REVERSE_SUBTRACT;if(a===d.An)return p.ZERO;if(a===d.Vm)return p.ONE;if(a===d.nn)return p.SRC_COLOR;if(a===d.Ym)return p.ONE_MINUS_SRC_COLOR;if(a===d.mk)return p.SRC_ALPHA;if(a===d.Zj)return p.ONE_MINUS_SRC_ALPHA;if(a===d.Am)return p.DST_ALPHA;if(a===d.Wm)return p.ONE_MINUS_DST_ALPHA;if(a===d.Bm)return p.DST_COLOR;if(a===d.Xm)return p.ONE_MINUS_DST_COLOR;if(a===d.mn)return p.SRC_ALPHA_SATURATE;if(void 0!==fb){if(a===d.cn)return fb.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===d.$m)return fb.COMPRESSED_RGBA_S3TC_DXT1_EXT;
if(a===d.an)return fb.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===d.bn)return fb.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",d.ek);k=k||{};var ua=void 0!==k.canvas?k.canvas:document.createElement("canvas"),Ca=void 0!==k.td?k.td:null,na=void 0!==k.precision?k.precision:"highp",Ua=void 0!==k.alpha?k.alpha:!1,Ga=void 0!==k.depth?k.depth:!0,va=void 0!==k.stencil?k.stencil:!0,sa=void 0!==k.antialias?k.antialias:!1,Va=void 0!==k.premultipliedAlpha?k.premultipliedAlpha:!0,gb=void 0!==
k.preserveDrawingBuffer?k.preserveDrawingBuffer:!1,Ta=void 0!==k.Yf?k.Yf:!1,db=new d.q(0),Aa=[],oa=[];this.Yk=ua;this.td=null;this.devicePixelRatio=void 0!==k.devicePixelRatio?k.devicePixelRatio:void 0!==self.devicePixelRatio?self.devicePixelRatio:1;this.Jh=this.Vn=this.Un=this.Tn=this.yi=!0;this.pe=this.bl=this.Fc=!1;this.Dp=!0;this.tg=d.$j;this.Ul=d.Vh;this.Fh=this.Gh=!1;this.Zf=8;this.rh=4;this.Wn=!0;this.Nl=[];this.Ml=[];this.info={memory:{Il:0,We:0,wg:0},t:{ec:0,e:0,j:0,ma:0}};var N=this,La=
[],Ea=null,pa=null,Ja=-1,qa=null,la=null,ta=0,Ra=-1,Pa=-1,Ha=-1,$a=-1,Qa=-1,ga=-1,Da=-1,Mb=-1,vc=null,ec=null,fc=null,gc=null,Ob=0,Jb=0,Db=ua.width,W=ua.height,hc=0,ic=0,Zb=new Uint8Array(16),Ia=new Uint8Array(16),Pb=new d.we,Eb=new d.S,wc=new d.S,Fa=new d.b,za=new d.b,Hb=!0,nc={ta:[0,0,0],Lf:{length:0,ka:[],jc:[]},le:{length:0,ka:[],jc:[],Mf:[]},Lb:{length:0,ka:[],jc:[],Mf:[],Xk:[],Ok:[],Zk:[]},fe:{length:0,Xl:[],gl:[],jc:[]}},p,oc,Ic,zb,fb,Qb;(function(){try{var a={alpha:Ua,depth:Ga,stencil:va,
antialias:sa,premultipliedAlpha:Va,preserveDrawingBuffer:gb};p=Ca||ua.getContext("webgl",a)||ua.getContext("experimental-webgl",a);if(null===p)throw"Error creating WebGL context.";}catch(b){console.error(b)}oc=p.getExtension("OES_texture_float");p.getExtension("OES_texture_float_linear");Ic=p.getExtension("OES_standard_derivatives");zb=p.getExtension("EXT_texture_filter_anisotropic")||p.getExtension("MOZ_EXT_texture_filter_anisotropic")||p.getExtension("WEBKIT_EXT_texture_filter_anisotropic");fb=
p.getExtension("WEBGL_compressed_texture_s3tc")||p.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||p.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");Qb=p.getExtension("OES_element_index_uint");null===oc&&console.log("THREE.WebGLRenderer: Float textures not supported.");null===Ic&&console.log("THREE.WebGLRenderer: Standard derivatives not supported.");null===zb&&console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");null===fb&&console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");
null===Qb&&console.log("THREE.WebGLRenderer: elementindex as unsigned integer not supported.");void 0===p.getShaderPrecisionFormat&&(p.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});Ta&&p.getExtension("EXT_frag_depth")})();p.clearColor(0,0,0,1);p.clearDepth(1);p.clearStencil(0);p.enable(p.DEPTH_TEST);p.depthFunc(p.LEQUAL);p.frontFace(p.CCW);p.cullFace(p.BACK);p.enable(p.CULL_FACE);p.enable(p.BLEND);p.blendEquation(p.FUNC_ADD);p.blendFunc(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA);
p.viewport(Ob,Jb,Db,W);p.clearColor(db.C,db.B,db.i,0);this.td=p;var Hc=p.getParameter(p.MAX_TEXTURE_IMAGE_UNITS),Xc=p.getParameter(p.MAX_VERTEX_TEXTURE_IMAGE_UNITS);p.getParameter(p.MAX_TEXTURE_SIZE);var Vc=p.getParameter(p.MAX_CUBE_MAP_TEXTURE_SIZE),Wc=zb?p.getParameter(zb.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,pc=0<Xc,mc=pc&&oc;fb&&p.getParameter(p.COMPRESSED_TEXTURE_FORMATS);var Yc=p.getShaderPrecisionFormat(p.FRAGMENT_SHADER,p.HIGH_FLOAT),Gd=p.getShaderPrecisionFormat(p.FRAGMENT_SHADER,p.MEDIUM_FLOAT),
Hd=0<p.getShaderPrecisionFormat(p.VERTEX_SHADER,p.HIGH_FLOAT).precision&&0<Yc.precision,Jc=0<p.getShaderPrecisionFormat(p.VERTEX_SHADER,p.MEDIUM_FLOAT).precision&&0<Gd.precision;"highp"!==na||Hd||(Jc?(na="mediump",console.warn("THREE.WebGLRenderer: highp not supported, using mediump.")):(na="lowp",console.warn("THREE.WebGLRenderer: highp and mediump not supported, using lowp.")));"mediump"!==na||Jc||(na="lowp",console.warn("THREE.WebGLRenderer: mediump not supported, using lowp."));this.getContext=
function(){return p};this.vj=function(){return pc};this.Ti=function(){return na};this.oj=function(a,b,c){ua.width=a*this.devicePixelRatio;ua.height=b*this.devicePixelRatio;!1!==c&&(ua.style.width=a+"px",ua.style.height=b+"px");this.pj(0,0,a,b)};this.pj=function(a,b,c,e){Ob=a*this.devicePixelRatio;Jb=b*this.devicePixelRatio;Db=c*this.devicePixelRatio;W=e*this.devicePixelRatio;p.viewport(Ob,Jb,Db,W)};this.Si=function(){return db};this.clear=function(a,b,c){var e=0;if(void 0===a||a)e|=p.COLOR_BUFFER_BIT;
if(void 0===b||b)e|=p.DEPTH_BUFFER_BIT;if(void 0===c||c)e|=p.STENCIL_BUFFER_BIT;p.clear(e)};this.clearColor=function(){p.clear(p.COLOR_BUFFER_BIT)};this.clearDepth=function(){p.clear(p.DEPTH_BUFFER_BIT)};this.clearStencil=function(){p.clear(p.STENCIL_BUFFER_BIT)};this.Lk=function(a){a.vd(this);this.Ml.push(a)};this.Qn=function(a){a.vd(this);this.Nl.push(a)};this.yp=function(a,b,c){v();a.Ko&&!a.ib&&(a.ib=p.createBuffer());a.Jo&&!a.Td&&(a.Td=p.createBuffer());a.Mo&&!a.Gk&&(a.Gk=p.createBuffer());a.Io&&
!a.cc&&(a.cc=p.createBuffer());a.Ko&&(p.bindBuffer(p.ARRAY_BUFFER,a.ib),p.bufferData(p.ARRAY_BUFFER,a.ns,p.DYNAMIC_DRAW),y(b.attributes.position),p.vertexAttribPointer(b.attributes.position,3,p.FLOAT,!1,0,0));if(a.Jo){p.bindBuffer(p.ARRAY_BUFFER,a.Td);if(c.Ma===d.Wh){var e,f,g,h,k,l,n,u,q,s,r,w=3*a.count;for(r=0;r<w;r+=9)s=a.kp,e=s[r],f=s[r+1],g=s[r+2],h=s[r+3],l=s[r+4],u=s[r+5],k=s[r+6],n=s[r+7],q=s[r+8],e=(e+h+k)/3,f=(f+l+n)/3,g=(g+u+q)/3,s[r]=e,s[r+1]=f,s[r+2]=g,s[r+3]=e,s[r+4]=f,s[r+5]=g,s[r+
6]=e,s[r+7]=f,s[r+8]=g}p.bufferData(p.ARRAY_BUFFER,a.kp,p.DYNAMIC_DRAW);y(b.attributes.F);p.vertexAttribPointer(b.attributes.F,3,p.FLOAT,!1,0,0)}a.Mo&&c.map&&(p.bindBuffer(p.ARRAY_BUFFER,a.Gk),p.bufferData(p.ARRAY_BUFFER,a.Ls,p.DYNAMIC_DRAW),y(b.attributes.pb),p.vertexAttribPointer(b.attributes.pb,2,p.FLOAT,!1,0,0));a.Io&&c.s!==d.Ld&&(p.bindBuffer(p.ARRAY_BUFFER,a.cc),p.bufferData(p.ARRAY_BUFFER,a.ar,p.DYNAMIC_DRAW),y(b.attributes.color),p.vertexAttribPointer(b.attributes.color,3,p.FLOAT,!1,0,0));
z();p.drawArrays(p.TRIANGLES,0,a.count);a.count=0};this.jj=function(a,b,c,e,f,g){if(!1!==e.visible){var h=P(a,b,c,e,g);a=h.attributes;b=f.attributes;c=!1;h=16777215*f.id+2*h.id+(e.V?1:0);h!==qa&&(qa=h,c=!0);c&&v();if(g instanceof d.Y)if(h=b.index){var k,l;h.d instanceof Uint32Array?(k=p.UNSIGNED_INT,l=4):(k=p.UNSIGNED_SHORT,l=2);f=f.Qb;if(0===f.length)c&&(w(e,a,b,0),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,h.buffer)),p.drawElements(p.TRIANGLES,h.d.length,k,0),N.info.t.ec++,N.info.t.e+=h.d.length,N.info.t.j+=
h.d.length/3;else{c=!0;for(var n=0,u=f.length;n<u;n++){var s=f[n].index;c&&(w(e,a,b,s),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,h.buffer));p.drawElements(p.TRIANGLES,f[n].count,k,f[n].start*l);N.info.t.ec++;N.info.t.e+=f[n].count;N.info.t.j+=f[n].count/3}}}else c&&w(e,a,b,0),e=f.attributes.position,p.drawArrays(p.TRIANGLES,0,e.d.length/3),N.info.t.ec++,N.info.t.e+=e.d.length/3,N.info.t.j+=e.d.length/9;else if(g instanceof d.Ab)c&&w(e,a,b,0),e=b.position,p.drawArrays(p.POINTS,0,e.d.length/3),N.info.t.ec++,
N.info.t.ma+=e.d.length/3;else if(g instanceof d.U)if(g=g.type===d.bi?p.LINE_STRIP:p.LINES,V(e.nb),h=b.index)if(h.d instanceof Uint32Array?(k=p.UNSIGNED_INT,l=4):(k=p.UNSIGNED_SHORT,l=2),f=f.Qb,0===f.length)c&&(w(e,a,b,0),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,h.buffer)),p.drawElements(g,h.d.length,k,0),N.info.t.ec++,N.info.t.e+=h.d.length;else for(1<f.length&&(c=!0),n=0,u=f.length;n<u;n++)s=f[n].index,c&&(w(e,a,b,s),p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,h.buffer)),p.drawElements(g,f[n].count,k,f[n].start*
l),N.info.t.ec++,N.info.t.e+=f[n].count;else c&&w(e,a,b,0),e=b.position,p.drawArrays(g,0,e.d.length/3),N.info.t.ec++,N.info.t.ma+=e.d.length/3}};this.ij=function(a,b,c,e,f,g){if(!1!==e.visible){var h,k;c=P(a,b,c,e,g);b=c.attributes;a=!1;c=16777215*f.id+2*c.id+(e.V?1:0);c!==qa&&(qa=c,a=!0);a&&v();if(!e.w&&0<=b.position)a&&(p.bindBuffer(p.ARRAY_BUFFER,f.ib),y(b.position),p.vertexAttribPointer(b.position,3,p.FLOAT,!1,0,0));else if(g.Zi){c=e.Ya.attributes;-1!==g.Zi&&0<=c.position?(p.bindBuffer(p.ARRAY_BUFFER,
f.Je[g.Zi]),y(c.position),p.vertexAttribPointer(c.position,3,p.FLOAT,!1,0,0)):0<=c.position&&(p.bindBuffer(p.ARRAY_BUFFER,f.ib),y(c.position),p.vertexAttribPointer(c.position,3,p.FLOAT,!1,0,0));if(g.yl.length){var l=0;k=g.yl;for(h=g.Wa;l<e.gg&&l<k.length;)0<=c["morphTarget"+l]&&(p.bindBuffer(p.ARRAY_BUFFER,f.Je[k[l]]),y(c["morphTarget"+l]),p.vertexAttribPointer(c["morphTarget"+l],3,p.FLOAT,!1,0,0)),0<=c["morphNormal"+l]&&e.Ja&&(p.bindBuffer(p.ARRAY_BUFFER,f.uf[k[l]]),y(c["morphNormal"+l]),p.vertexAttribPointer(c["morphNormal"+
l],3,p.FLOAT,!1,0,0)),g.vf[l]=h[k[l]],l++}else{k=[];h=g.Wa;var n,u=h.length;for(n=0;n<u;n++)l=h[n],0<l&&k.push([l,n]);k.length>e.gg?(k.sort(E),k.length=e.gg):k.length>e.Al?k.sort(E):0===k.length&&k.push([0,0]);for(l=0;l<e.gg;)k[l]?(n=k[l][1],0<=c["morphTarget"+l]&&(p.bindBuffer(p.ARRAY_BUFFER,f.Je[n]),y(c["morphTarget"+l]),p.vertexAttribPointer(c["morphTarget"+l],3,p.FLOAT,!1,0,0)),0<=c["morphNormal"+l]&&e.Ja&&(p.bindBuffer(p.ARRAY_BUFFER,f.uf[n]),y(c["morphNormal"+l]),p.vertexAttribPointer(c["morphNormal"+
l],3,p.FLOAT,!1,0,0)),g.vf[l]=h[n]):g.vf[l]=0,l++}null!==e.Ya.M.Wa&&p.uniform1fv(e.Ya.M.Wa,g.vf)}if(a){if(f.rb)for(h=0,k=f.rb.length;h<k;h++)c=f.rb[h],0<=b[c.buffer.Yg]&&(p.bindBuffer(p.ARRAY_BUFFER,c.buffer),y(b[c.buffer.Yg]),p.vertexAttribPointer(b[c.buffer.Yg],c.size,p.FLOAT,!1,0,0));0<=b.color&&(0<g.k.ka.length||0<g.k.j.length?(p.bindBuffer(p.ARRAY_BUFFER,f.cc),y(b.color),p.vertexAttribPointer(b.color,3,p.FLOAT,!1,0,0)):e.fc&&p.vertexAttrib3fv(b.color,e.fc.color));0<=b.F&&(p.bindBuffer(p.ARRAY_BUFFER,
f.Td),y(b.F),p.vertexAttribPointer(b.F,3,p.FLOAT,!1,0,0));0<=b.Yl&&(p.bindBuffer(p.ARRAY_BUFFER,f.Tg),y(b.Yl),p.vertexAttribPointer(b.Yl,4,p.FLOAT,!1,0,0));0<=b.pb&&(g.k.D[0]?(p.bindBuffer(p.ARRAY_BUFFER,f.Vg),y(b.pb),p.vertexAttribPointer(b.pb,2,p.FLOAT,!1,0,0)):e.fc&&p.vertexAttrib2fv(b.pb,e.fc.pb));0<=b.Nh&&(g.k.D[1]?(p.bindBuffer(p.ARRAY_BUFFER,f.Ug),y(b.Nh),p.vertexAttribPointer(b.Nh,2,p.FLOAT,!1,0,0)):e.fc&&p.vertexAttrib2fv(b.Nh,e.fc.Nh));e.va&&0<=b.Vl&&0<=b.Wl&&(p.bindBuffer(p.ARRAY_BUFFER,
f.Rg),y(b.Vl),p.vertexAttribPointer(b.Vl,4,p.FLOAT,!1,0,0),p.bindBuffer(p.ARRAY_BUFFER,f.Sg),y(b.Wl),p.vertexAttribPointer(b.Wl,4,p.FLOAT,!1,0,0));0<=b.ol&&(p.bindBuffer(p.ARRAY_BUFFER,f.Qg),y(b.ol),p.vertexAttribPointer(b.ol,1,p.FLOAT,!1,0,0))}z();g instanceof d.Y?(g=f.Hn===Uint32Array?p.UNSIGNED_INT:p.UNSIGNED_SHORT,e.V?(V(e.Aa),a&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,f.Pg),p.drawElements(p.LINES,f.ti,g,0)):(a&&p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,f.Og),p.drawElements(p.TRIANGLES,f.ri,g,0)),N.info.t.ec++,
N.info.t.e+=f.ri,N.info.t.j+=f.ri/3):g instanceof d.U?(g=g.type===d.bi?p.LINE_STRIP:p.LINES,V(e.nb),p.drawArrays(g,0,f.ti),N.info.t.ec++):g instanceof d.Ab&&(p.drawArrays(p.POINTS,0,f.Fk),N.info.t.ec++,N.info.t.ma+=f.Fk)}};this.t=function(b,c,e,f){function g(a){a instanceof d.vc&&a.Za.update();for(var b=0,c=a.children.length;b<c;b++)g(a.children[b])}if(!1===c instanceof d.hb)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var h,k,l,p,n=b.Bb,u=b.L;Ja=-1;
la=null;Hb=!0;!0===b.Le&&b.ra();void 0===c.parent&&c.ra();g(b);c.Ea.Gb(c.m);cc(Eb,c.za,c.Ea);uc(Pb,Eb);a(b);Aa.length=0;oa.length=0;A(b,b,c);!0===N.Jh&&(Aa.sort(x),oa.sort(C));H(this.Nl,b,c);N.info.t.ec=0;N.info.t.e=0;N.info.t.j=0;N.info.t.ma=0;this.nj(e);(this.yi||f)&&this.clear(this.Tn,this.Un,this.Vn);p=b.nd;f=0;for(h=p.length;f<h;f++)k=p[f],l=k.object,l.visible&&(J(l,c),F(k));b.hg?(f=b.hg,this.ef(f.Pa,f.blendEquation,f.ae,f.$d),this.ne(f.Dc),this.mg(f.Ec),U(f.polygonOffset,f.jg,f.kg),B(Aa,c,n,
u,!0,f),B(oa,c,n,u,!0,f),D(b.nd,"",c,n,u,!1,f)):(f=null,this.ef(d.Yj),B(Aa,c,n,u,!1,f),D(b.nd,"opaque",c,n,u,!1,f),B(oa,c,n,u,!0,f),D(b.nd,"transparent",c,n,u,!0,f));H(this.Ml,b,c);e&&e.Ob&&e.ub!==d.Be&&e.ub!==d.Jd&&Y(e);this.ne(!0);this.mg(!0)}};this.kj=function(a,b,c,e,f){var g=P(a,b,c,e,f);qa=-1;N.Bh(e);f.Wi?f.Wi(g,p,Pb):f.t(function(a){N.yp(a,g,e)})};this.Uo=function(a,b,c,f){var g,h,k,l;a.addEventListener("dispose",e);var n,u,s,q;a instanceof d.Kd?q="depth":a instanceof d.Ae?q="normal":a instanceof
d.xb?q="basic":a instanceof d.sc?q="lambert":a instanceof d.Yb?q="phong":a instanceof d.Ba?q="basic":a instanceof d.ze?q="dashed":a instanceof d.uc&&(q="particle_basic");q?(g=d.Kg[q],a.Ud={M:d.ac.clone(g.M),J:g.J,I:g.I}):a.Ud={M:a.M,J:a.J,I:a.I};s=l=k=h=g=0;for(var v=b.length;s<v;s++){var r=b[s];r.Bd||!1===r.visible||(r instanceof d.vb&&g++,r instanceof d.ld&&h++,r instanceof d.Oc&&k++,r instanceof d.xe&&l++)}v=s=0;for(r=b.length;v<r;v++){var w=b[v];w.tb&&(w instanceof d.Oc&&s++,w instanceof d.vb&&
!w.sg&&s++)}b=s;mc&&f&&f.Za&&f.Za.fd?s=1024:(s=p.getParameter(p.MAX_VERTEX_UNIFORM_VECTORS),s=Math.floor((s-20)/4),void 0!==f&&f instanceof d.vc&&(s=Math.min(f.Za.Z.length,s),s<f.Za.Z.length&&console.warn("WebGLRenderer: too many bones - "+f.Za.Z.length+", this GPU supports just "+s+" (try OpenGL instead of ANGLE)")));c={precision:na,vj:pc,map:!!a.map,qa:!!a.qa,Ua:!!a.Ua,sb:!!a.sb,ob:!!a.ob,Na:!!a.Na,bb:!!a.bb,s:a.s,L:c,gm:a.L,Co:c instanceof d.of,vg:a.vg,Yf:Ta,va:a.va,ep:s,fd:mc&&f&&f.Za&&f.Za.fd,
w:a.w,Ja:a.Ja,Zf:this.Zf,rh:this.rh,tl:g,vl:h,xl:k,ul:l,wl:b,pe:this.pe&&f.xh&&0<b,tg:this.tg,Gh:this.Gh,Fh:this.Fh,Wd:a.Wd,$f:a.$f,pc:a.pc,Oi:a.Jb===d.Id,Qi:a.Jb===d.te};f=[];q?f.push(q):(f.push(a.I),f.push(a.J));for(var x in a.Jf)f.push(x),f.push(a.Jf[x]);for(u in c)f.push(u),f.push(c[u]);q=f.join();var z;u=0;for(x=La.length;u<x;u++)if(f=La[u],f.code===q){z=f;z.zj++;break}void 0===z&&(z=new d.WebGLProgram(this,q,a,c),La.push(z),N.info.memory.Il=La.length);a.Ya=z;z=a.Ya.attributes;if(a.w)for(a.gg=
0,x="morphTarget",u=0;u<this.Zf;u++)q=x+u,0<=z[q]&&a.gg++;if(a.Ja)for(a.Al=0,x="morphNormal",u=0;u<this.rh;u++)q=x+u,0<=z[q]&&a.Al++;a.dm=[];for(n in a.Ud.M)(u=a.Ya.M[n])&&a.dm.push([a.Ud.M[n],u])};this.Bh=function(a){var b=a.Jb===d.Id;a=a.Jb===d.te;Ra!==b&&(b?p.disable(p.CULL_FACE):p.enable(p.CULL_FACE),Ra=b);Pa!==a&&(a?p.frontFace(p.CW):p.frontFace(p.CCW),Pa=a)};this.ne=function(a){Da!==a&&(a?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),Da=a)};this.mg=function(a){Mb!==a&&(p.depthMask(a),Mb=a)};
this.ef=function(a,b,c,e){a!==Ha&&(a===d.Yj?p.disable(p.BLEND):a===d.Bj?(p.enable(p.BLEND),p.blendEquation(p.FUNC_ADD),p.blendFunc(p.SRC_ALPHA,p.ONE)):a===d.nk?(p.enable(p.BLEND),p.blendEquation(p.FUNC_ADD),p.blendFunc(p.ZERO,p.ONE_MINUS_SRC_COLOR)):a===d.Rm?(p.enable(p.BLEND),p.blendEquation(p.FUNC_ADD),p.blendFunc(p.ZERO,p.SRC_COLOR)):a===d.Hj?p.enable(p.BLEND):(p.enable(p.BLEND),p.blendEquationSeparate(p.FUNC_ADD,p.FUNC_ADD),p.blendFuncSeparate(p.SRC_ALPHA,p.ONE_MINUS_SRC_ALPHA,p.ONE,p.ONE_MINUS_SRC_ALPHA)),
Ha=a);if(a===d.Hj){if(b!==$a&&(p.blendEquation(aa(b)),$a=b),c!==Qa||e!==ga)p.blendFunc(aa(c),aa(e)),Qa=c,ga=e}else ga=Qa=$a=null};this.ff=function(a,b){if(a.H){a.md||(a.md=!0,a.addEventListener("dispose",g),a.Cb=p.createTexture(),N.info.memory.wg++);p.activeTexture(p.TEXTURE0+b);p.bindTexture(p.TEXTURE_2D,a.Cb);p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,a.Ue);p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.ej);p.pixelStorei(p.UNPACK_ALIGNMENT,a.yj);var c=a.$,e=d.Math.yd(c.width)&&d.Math.yd(c.height),f=
aa(a.format),h=aa(a.type);ca(p.TEXTURE_2D,a,e);var k=a.ag;if(a instanceof d.Hd)if(0<k.length&&e){for(var l=0,n=k.length;l<n;l++)c=k[l],p.texImage2D(p.TEXTURE_2D,l,f,c.width,c.height,0,f,h,c.data);a.Ob=!1}else p.texImage2D(p.TEXTURE_2D,0,f,c.width,c.height,0,f,h,c.data);else if(a instanceof d.ue)for(l=0,n=k.length;l<n;l++)c=k[l],a.format!==d.Nd?p.compressedTexImage2D(p.TEXTURE_2D,l,f,c.width,c.height,0,c.data):p.texImage2D(p.TEXTURE_2D,l,f,c.width,c.height,0,f,h,c.data);else if(0<k.length&&e){l=0;
for(n=k.length;l<n;l++)c=k[l],p.texImage2D(p.TEXTURE_2D,l,f,f,h,c);a.Ob=!1}else p.texImage2D(p.TEXTURE_2D,0,f,f,h,a.$);a.Ob&&e&&p.generateMipmap(p.TEXTURE_2D);a.H=!1;a.vh&&a.vh()}else p.activeTexture(p.TEXTURE0+b),p.bindTexture(p.TEXTURE_2D,a.Cb)};this.nj=function(a){var b=a instanceof d.Sd;if(a&&!a.Rc){void 0===a.Cc&&(a.Cc=!0);void 0===a.Nc&&(a.Nc=!0);a.addEventListener("dispose",f);a.Cb=p.createTexture();N.info.memory.wg++;var c=d.Math.yd(a.width)&&d.Math.yd(a.height),e=aa(a.format),g=aa(a.type);
if(b){a.Rc=[];a.Sc=[];p.bindTexture(p.TEXTURE_CUBE_MAP,a.Cb);ca(p.TEXTURE_CUBE_MAP,a,c);for(var h=0;6>h;h++){a.Rc[h]=p.createFramebuffer();a.Sc[h]=p.createRenderbuffer();p.texImage2D(p.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,e,a.width,a.height,0,e,g,null);var k=a,l=p.TEXTURE_CUBE_MAP_POSITIVE_X+h;p.bindFramebuffer(p.FRAMEBUFFER,a.Rc[h]);p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,l,k.Cb,0);S(a.Sc[h],a)}c&&p.generateMipmap(p.TEXTURE_CUBE_MAP)}else a.Rc=p.createFramebuffer(),a.Sc=a.ug?a.ug.Sc:
p.createRenderbuffer(),p.bindTexture(p.TEXTURE_2D,a.Cb),ca(p.TEXTURE_2D,a,c),p.texImage2D(p.TEXTURE_2D,0,e,a.width,a.height,0,e,g,null),e=p.TEXTURE_2D,p.bindFramebuffer(p.FRAMEBUFFER,a.Rc),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,e,a.Cb,0),a.ug?a.Cc&&!a.Nc?p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,a.Sc):a.Cc&&a.Nc&&p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_STENCIL_ATTACHMENT,p.RENDERBUFFER,a.Sc):S(a.Sc,a),c&&p.generateMipmap(p.TEXTURE_2D);b?p.bindTexture(p.TEXTURE_CUBE_MAP,
null):p.bindTexture(p.TEXTURE_2D,null);p.bindRenderbuffer(p.RENDERBUFFER,null);p.bindFramebuffer(p.FRAMEBUFFER,null)}a?(b=b?a.Rc[a.Pn]:a.Rc,c=a.width,a=a.height,g=e=0):(b=null,c=Db,a=W,e=Ob,g=Jb);b!==pa&&(p.bindFramebuffer(p.FRAMEBUFFER,b),p.viewport(e,g,c,a),pa=b);hc=c;ic=a};this.Ep=new d.ki;this.Qn(this.Ep);this.Lk(new d.ln);this.Lk(new d.Jm)};
d.Ee=function(a,b,c){this.width=a;this.height=b;c=c||{};this.qc=void 0!==c.qc?c.qc:d.kf;this.rc=void 0!==c.rc?c.rc:d.kf;this.Pb=void 0!==c.Pb?c.Pb:d.Jd;this.ub=void 0!==c.ub?c.ub:d.ci;this.dc=void 0!==c.dc?c.dc:1;this.offset=new d.g(0,0);this.repeat=new d.g(1,1);this.format=void 0!==c.format?c.format:d.Nd;this.type=void 0!==c.type?c.type:d.qi;this.Cc=void 0!==c.Cc?c.Cc:!0;this.Nc=void 0!==c.Nc?c.Nc:!0;this.Ob=!0;this.ug=null};
d.Ee.prototype={oj:function(a,b){this.width=a;this.height=b},clone:function(){var a=new d.Ee(this.width,this.height);a.qc=this.qc;a.rc=this.rc;a.Pb=this.Pb;a.ub=this.ub;a.dc=this.dc;a.offset.c(this.offset);a.repeat.c(this.repeat);a.format=this.format;a.type=this.type;a.Cc=this.Cc;a.Nc=this.Nc;a.Ob=this.Ob;a.ug=this.ug;return a}};d.Xb.prototype.apply(d.Ee.prototype);d.Sd=function(a,b,c){d.Ee.call(this,a,b,c);this.Pn=0};d.Sd.prototype=Object.create(d.Ee.prototype);
d.WebGLProgram=function(){var a=0;return function(b,c,e,f){var g=b.td,h=e.Jf,k=e.Ud.M,l=e.attributes,n=e.Ud.J,q=e.Ud.I,r=e.So;void 0===r&&!0===f.w&&(r="position");var s="SHADOWMAP_TYPE_BASIC";f.tg===d.$j?s="SHADOWMAP_TYPE_PCF":f.tg===d.ak&&(s="SHADOWMAP_TYPE_PCF_SOFT");var u,w;u=[];for(var v in h)w=h[v],!1!==w&&(w="#define "+v+" "+w,u.push(w));u=u.join("\n");h=g.createProgram();e instanceof d.Jg?b=e="":(e=["precision "+f.precision+" float;","precision "+f.precision+" int;",u,f.vj?"#define VERTEX_TEXTURES":
"",b.Fc?"#define GAMMA_INPUT":"",b.bl?"#define GAMMA_OUTPUT":"","#define MAX_DIR_LIGHTS "+f.tl,"#define MAX_POINT_LIGHTS "+f.vl,"#define MAX_SPOT_LIGHTS "+f.xl,"#define MAX_HEMI_LIGHTS "+f.ul,"#define MAX_SHADOWS "+f.wl,"#define MAX_BONES "+f.ep,f.map?"#define USE_MAP":"",f.qa?"#define USE_ENVMAP":"",f.Ua?"#define USE_LIGHTMAP":"",f.sb?"#define USE_BUMPMAP":"",f.ob?"#define USE_NORMALMAP":"",f.Na?"#define USE_SPECULARMAP":"",f.bb?"#define USE_ALPHAMAP":"",f.s?"#define USE_COLOR":"",f.va?"#define USE_SKINNING":
"",f.fd?"#define BONE_TEXTURE":"",f.w?"#define USE_MORPHTARGETS":"",f.Ja?"#define USE_MORPHNORMALS":"",f.pc?"#define WRAP_AROUND":"",f.Oi?"#define DOUBLE_SIDED":"",f.Qi?"#define FLIP_SIDED":"",f.pe?"#define USE_SHADOWMAP":"",f.pe?"#define "+s:"",f.Gh?"#define SHADOWMAP_DEBUG":"",f.Fh?"#define SHADOWMAP_CASCADE":"",f.vg?"#define USE_SIZEATTENUATION":"",f.Yf?"#define USE_LOGDEPTHBUF":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\n\tattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\n\tattribute vec3 morphTarget0;\n\tattribute vec3 morphTarget1;\n\tattribute vec3 morphTarget2;\n\tattribute vec3 morphTarget3;\n\t#ifdef USE_MORPHNORMALS\n\t\tattribute vec3 morphNormal0;\n\t\tattribute vec3 morphNormal1;\n\t\tattribute vec3 morphNormal2;\n\t\tattribute vec3 morphNormal3;\n\t#else\n\t\tattribute vec3 morphTarget4;\n\t\tattribute vec3 morphTarget5;\n\t\tattribute vec3 morphTarget6;\n\t\tattribute vec3 morphTarget7;\n\t#endif\n#endif\n#ifdef USE_SKINNING\n\tattribute vec4 skinIndex;\n\tattribute vec4 skinWeight;\n#endif\n"].join("\n"),
b=["precision "+f.precision+" float;","precision "+f.precision+" int;",f.sb||f.ob?"#extension GL_OES_standard_derivatives : enable":"",u,"#define MAX_DIR_LIGHTS "+f.tl,"#define MAX_POINT_LIGHTS "+f.vl,"#define MAX_SPOT_LIGHTS "+f.xl,"#define MAX_HEMI_LIGHTS "+f.ul,"#define MAX_SHADOWS "+f.wl,f.Wd?"#define ALPHATEST "+f.Wd:"",b.Fc?"#define GAMMA_INPUT":"",b.bl?"#define GAMMA_OUTPUT":"",f.gm&&f.L?"#define USE_FOG":"",f.gm&&f.Co?"#define FOG_EXP2":"",f.map?"#define USE_MAP":"",f.qa?"#define USE_ENVMAP":
"",f.Ua?"#define USE_LIGHTMAP":"",f.sb?"#define USE_BUMPMAP":"",f.ob?"#define USE_NORMALMAP":"",f.Na?"#define USE_SPECULARMAP":"",f.bb?"#define USE_ALPHAMAP":"",f.s?"#define USE_COLOR":"",f.$f?"#define METAL":"",f.pc?"#define WRAP_AROUND":"",f.Oi?"#define DOUBLE_SIDED":"",f.Qi?"#define FLIP_SIDED":"",f.pe?"#define USE_SHADOWMAP":"",f.pe?"#define "+s:"",f.Gh?"#define SHADOWMAP_DEBUG":"",f.Fh?"#define SHADOWMAP_CASCADE":"",f.Yf?"#define USE_LOGDEPTHBUF":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n"));
n=new d.WebGLShader(g,g.VERTEX_SHADER,e+n);q=new d.WebGLShader(g,g.FRAGMENT_SHADER,b+q);g.attachShader(h,n);g.attachShader(h,q);void 0!==r&&g.bindAttribLocation(h,0,r);g.linkProgram(h);!1===g.getProgramParameter(h,g.LINK_STATUS)&&(console.error("THREE.WebGLProgram: Could not initialise shader."),console.error("gl.VALIDATE_STATUS",g.getProgramParameter(h,g.VALIDATE_STATUS)),console.error("gl.getError()",g.getError()));""!==g.getProgramInfoLog(h)&&console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",
g.getProgramInfoLog(h));g.deleteShader(n);g.deleteShader(q);r="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences bindMatrix bindMatrixInverse".split(" ");f.fd?(r.push("boneTexture"),r.push("boneTextureWidth"),r.push("boneTextureHeight")):r.push("boneGlobalMatrices");f.Yf&&r.push("logDepthBufFC");for(var y in k)r.push(y);k=r;y={};r=0;for(b=k.length;r<b;r++)s=k[r],y[s]=g.getUniformLocation(h,s);this.M=y;r="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");
for(k=0;k<f.Zf;k++)r.push("morphTarget"+k);for(k=0;k<f.rh;k++)r.push("morphNormal"+k);for(var z in l)r.push(z);f=r;l={};z=0;for(k=f.length;z<k;z++)y=f[z],l[y]=g.getAttribLocation(h,y);this.attributes=l;this.id=a++;this.code=c;this.zj=1;this.Ya=h;this.J=n;this.I=q;return this}}();
d.WebGLShader=function(){function a(a){a=a.split("\n");for(var c=0;c<a.length;c++)a[c]=c+1+": "+a[c];return a.join("\n")}return function(b,c,e){c=b.createShader(c);b.shaderSource(c,e);b.compileShader(c);!1===b.getShaderParameter(c,b.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");""!==b.getShaderInfoLog(c)&&(console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",b.getShaderInfoLog(c)),console.warn(a(e)));return c}}();
d.Od=function(){this.position=new d.b;this.cf=new d.b;this.l=new d.bc;this.visible=!0};d.Od.prototype.c=function(a){this.cf.c(a.cf);this.l.c(a.l)};d.fk=function(){this.id=0;this.X=new d.Od;this.ba=new d.Od;this.Ub=new d.Od;this.bg=new d.b;this.Fd=[new d.b,new d.b,new d.b];this.im=0;this.color=new d.q;this.r=null;this.Ed=[new d.g,new d.g,new d.g];this.z=0};d.en=function(){this.id=0;this.object=null;this.z=0};
d.hk=function(){this.id=0;this.object=null;this.rotation=this.z=this.y=this.x=0;this.scale=new d.g;this.r=null};d.gk=function(){this.id=0;this.X=new d.Od;this.ba=new d.Od;this.s=[new d.q,new d.q];this.r=null;this.z=0};
d.vq={Jc:function(a,b,c){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var e;b instanceof d.Y&&(b.oa&&b.Dd(),e=b.da,b=b.k);a.Jc(b,e,c)},ia:function(a){console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead.");return a.ia()}};
d.wq={crossOrigin:void 0,yr:function(a,b,c,e){var f=new d.pf;f.crossOrigin=this.crossOrigin;var g=new d.xa(void 0,b);f.load(a,function(a){g.$=a;g.H=!0;c&&c(g)},void 0,function(a){e&&e(a)});g.Jp=a;return g},zr:function(a,b,c){function e(b){f.load(a[b],function(a){g.images[b]=a;h+=1;6===h&&(g.H=!0,c&&c(g))})}var f=new d.pf;f.crossOrigin=this.crossOrigin;var g=new d.lf([],b);g.Ue=!1;var h=0;b=0;for(var k=a.length;b<k;++b)e(b);return g},wr:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},
xr:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},rr:function(a,b){b|=1;var c=a.width,e=a.height,f=document.createElement("canvas");f.width=c;f.height=e;var g=f.getContext("2d");g.drawImage(a,0,0);for(var h=g.getImageData(0,0,c,e).data,k=g.createImageData(c,e),l=k.data,n=0;n<c;n++)for(var q=0;q<e;q++){var r=0>q-1?0:q-1,s=q+1>e-1?e-1:q+1,u=0>n-1?0:n-1,w=n+1>c-1?c-1:n+1,v=[],y=[0,0,h[4*(q*c+n)]/255*b];v.push([-1,0,h[4*(q*c+u)]/
255*b]);v.push([-1,-1,h[4*(r*c+u)]/255*b]);v.push([0,-1,h[4*(r*c+n)]/255*b]);v.push([1,-1,h[4*(r*c+w)]/255*b]);v.push([1,0,h[4*(q*c+w)]/255*b]);v.push([1,1,h[4*(s*c+w)]/255*b]);v.push([0,1,h[4*(s*c+n)]/255*b]);v.push([-1,1,h[4*(s*c+u)]/255*b]);r=[];u=v.length;for(s=0;s<u;s++){var w=v[s],z=v[(s+1)%u],w=[w[0]-y[0],w[1]-y[1],w[2]-y[2]],z=[z[0]-y[0],z[1]-y[1],z[2]-y[2]],w=[w[1]*z[2]-w[2]*z[1],w[2]*z[0]-w[0]*z[2],w[0]*z[1]-w[1]*z[0]],z=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]);r.push([w[0]/z,w[1]/z,w[2]/
z])}v=[0,0,0];for(s=0;s<r.length;s++)v[0]+=r[s][0],v[1]+=r[s][1],v[2]+=r[s][2];v[0]/=r.length;v[1]/=r.length;v[2]/=r.length;y=4*(q*c+n);l[y]=(v[0]+1)/2*255|0;l[y+1]=(v[1]+1)/2*255|0;l[y+2]=255*v[2]|0;l[y+3]=255}g.putImageData(k,0,0);return f},qr:function(a,b,c){var e=a*b,f=new Uint8Array(3*e),g=Math.floor(255*c.C),h=Math.floor(255*c.B);c=Math.floor(255*c.i);for(var k=0;k<e;k++)f[3*k]=g,f[3*k+1]=h,f[3*k+2]=c;a=new d.Hd(f,a,b,d.ii);a.H=!0;return a}};
d.Kq={cr:function(a,b){for(var c=new d.A,e=0,f=b.length;e<f;e++)c.add(new d.Y(a,b[e]));return c},detach:function(a,b,c){a.Tc(b.m);b.remove(a);c.add(a)},Xq:function(a,b,c){var e=new d.S;e.Gb(c.m);a.Tc(e);b.remove(a);c.add(a)}};
d.wb={j:{},face:"helvetiker",weight:"normal",style:"normal",size:150,Ni:10,Fo:function(){try{return this.j[this.face][this.weight][this.style]}catch(a){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing.";}},pl:function(a){var b=a.ir.toLowerCase();this.j[b]=this.j[b]||{};this.j[b][a.Ji]=this.j[b][a.Ji]||{};this.j[b][a.Ji][a.so]=a;return this.j[b][a.Ji][a.so]=a},vo:function(a){var b=this.Fo(),c=this.size/b.xs,e=0,f=String(a).split(""),g=f.length,h=[];for(a=
0;a<g;a++){var k=new d.Md,k=this.Ao(f[a],b,c,e,k),e=e+k.offset;h.push(k.path)}return{op:h,offset:e/2}},Ao:function(a,b,c,e,f){var g=[],h,k,l,n,q,r,s,u=b.Go[a]||b.Go["?"];if(u){if(u.lp)for(b=u.In||(u.In=u.lp.split(" ")),l=b.length,a=0;a<l;)switch(h=b[a++],h){case "m":h=b[a++]*c+e;k=b[a++]*c;f.moveTo(h,k);break;case "l":h=b[a++]*c+e;k=b[a++]*c;f.lineTo(h,k);break;case "q":h=b[a++]*c+e;k=b[a++]*c;n=b[a++]*c+e;q=b[a++]*c;f.quadraticCurveTo(n,q,h,k);if(h=g[g.length-1])for(h=1,k=this.Ni;h<=k;h++);break;
case "b":if(h=b[a++]*c+e,k=b[a++]*c,n=b[a++]*c+e,q=b[a++]*c,r=b[a++]*c+e,s=b[a++]*c,f.bezierCurveTo(n,q,r,s,h,k),h=g[g.length-1])for(h=1,k=this.Ni;h<=k;h++);}return{offset:u.sr*c,path:f}}}};
d.wb.Do=function(a,b){b=b||{};var c=void 0!==b.If?b.If:4,e=void 0!==b.font?b.font:"helvetiker",f=void 0!==b.weight?b.weight:"normal",g=void 0!==b.style?b.style:"normal";d.wb.size=void 0!==b.size?b.size:100;d.wb.Ni=c;d.wb.face=e;d.wb.weight=f;d.wb.style=g;c=d.wb.vo(a).op;e=[];f=0;for(g=c.length;f<g;f++)Array.prototype.push.apply(e,fd(c[f]));return e};
(function(a){function b(a){for(var b=a.length,f=0,g=b-1,h=0;h<b;g=h++)f+=a[g].x*a[h].y-a[h].x*a[g].y;return.5*f}a.ni=function(a,e){var f=a.length;if(3>f)return null;var g=[],h=[],k=[],l,n,q;if(0<b(a))for(n=0;n<f;n++)h[n]=n;else for(n=0;n<f;n++)h[n]=f-1-n;var r=2*f;for(n=f-1;2<f;){if(0>=r--){console.log("Warning, unable to triangulate polygon!");break}l=n;f<=l&&(l=0);n=l+1;f<=n&&(n=0);q=n+1;f<=q&&(q=0);var s;a:{var u=s=void 0,w=void 0,v=void 0,y=void 0,z=void 0,x=void 0,C=void 0,E=void 0,u=a[h[l]].x,
w=a[h[l]].y,v=a[h[n]].x,y=a[h[n]].y,z=a[h[q]].x,x=a[h[q]].y;if(1E-10>(v-u)*(x-w)-(y-w)*(z-u))s=!1;else{var A=void 0,H=void 0,B=void 0,D=void 0,F=void 0,L=void 0,M=void 0,ea=void 0,T=void 0,Q=void 0,T=ea=M=E=C=void 0,A=z-v,H=x-y,B=u-z,D=w-x,F=v-u,L=y-w;for(s=0;s<f;s++)if(C=a[h[s]].x,E=a[h[s]].y,!(C===u&&E===w||C===v&&E===y||C===z&&E===x)&&(M=C-u,ea=E-w,T=C-v,Q=E-y,C-=z,E-=x,T=A*Q-H*T,M=F*ea-L*M,ea=B*E-D*C,-1E-10<=T&&-1E-10<=ea&&-1E-10<=M)){s=!1;break a}s=!0}}if(s){g.push([a[h[l]],a[h[n]],a[h[q]]]);
k.push([h[l],h[n],h[q]]);l=n;for(q=n+1;q<f;l++,q++)h[l]=h[q];f--;r=2*f}}return e?k:g};a.ni.Qk=b;return a})(d.wb);self.Jn={j:d.wb.j,pl:d.wb.pl};d.Is=self.Jn;d.fa=function(){};fa=d.fa.prototype;fa.ya=function(){console.log("Warning, getPoint() not implemented!");return null};fa.Rf=function(a){a=gd(this,a);return this.ya(a)};fa.Sf=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.ya(b/a));return c};fa.hh=function(a){a||(a=5);var b,c=[];for(b=0;b<=a;b++)c.push(this.Rf(b/a));return c};
fa.Qf=function(){var a=hd(this);return a[a.length-1]};function hd(a){var b;b||(b=a.Bn?a.Bn:200);if(a.Gi&&a.Gi.length==b+1&&!a.H)return a.Gi;a.H=!1;var c=[],e,f=a.ya(0),g,h=0;c.push(0);for(g=1;g<=b;g++)e=a.ya(g/b),h+=e.mb(f),c.push(h),f=e;return a.Gi=c}function gd(a,b,c){a=hd(a);var e=0,f=a.length;b=c?c:b*a[f-1];c=0;for(var g=f-1,h;c<=g;)if(e=Math.floor(c+(g-c)/2),h=a[e]-b,0>h)c=e+1;else if(0<h)g=e-1;else{g=e;break}e=g;if(a[e]==b)return e/(f-1);c=a[e];return a=(e+(b-c)/(a[e+1]-c))/(f-1)}
fa.Tf=function(a){var b=a-1E-4;a+=1E-4;0>b&&(b=0);1<a&&(a=1);b=this.ya(b);return this.ya(a).clone().sub(b).normalize()};d.fa.T={$l:function(a,b,c,e){return 2*(1-a)*(c-b)+2*a*(e-c)},Zl:function(a,b,c,e,f){return-3*b*(1-a)*(1-a)+3*c*(1-a)*(1-a)-6*a*c*(1-a)+6*a*e*(1-a)-3*a*a*e+3*a*a*f},Ds:function(a){return 6*a*a-6*a+(3*a*a-4*a+1)+(-6*a*a+6*a)+(3*a*a-2*a)},wd:function(a,b,c,e,f){a=.5*(c-a);e=.5*(e-b);var g=f*f;return(2*b-2*c+a+e)*f*g+(-3*b+3*c-2*a-e)*g+a*f+b}};
d.fa.create=function(a,b){a.prototype=Object.create(d.fa.prototype);a.prototype.ya=b;return a};d.Bg=function(){this.Ia=[];this.Zg=[]};d.Bg.prototype=Object.create(d.fa.prototype);fa=d.Bg.prototype;fa.add=function(a){this.Ia.push(a)};fa.closePath=function(){var a=this.Ia[0].ya(0),b=this.Ia[this.Ia.length-1].ya(1);a.la(b)||this.Ia.push(new d.ye(b,a))};fa.ya=function(a){var b=a*this.Qf(),c=id(this);for(a=0;a<c.length;){if(c[a]>=b)return b=c[a]-b,a=this.Ia[a],b=1-b/a.Qf(),a.Rf(b);a++}return null};
fa.Qf=function(){var a=id(this);return a[a.length-1]};function id(a){if(a.Hi&&a.Hi.length==a.Ia.length)return a.Hi;var b=[],c=0,e,f=a.Ia.length;for(e=0;e<f;e++)c+=a.Ia[e].Qf(),b.push(c);return a.Hi=b}
fa.el=function(){var a=this.Sf(),b,c,e,f,g,h;b=c=Number.NEGATIVE_INFINITY;f=g=Number.POSITIVE_INFINITY;var k,l,n,q,r=a[0]instanceof d.b;q=r?new d.b:new d.g;l=0;for(n=a.length;l<n;l++)k=a[l],k.x>b?b=k.x:k.x<f&&(f=k.x),k.y>c?c=k.y:k.y<g&&(g=k.y),r&&(k.z>e?e=k.z:k.z<h&&(h=k.z)),q.add(k);a={ds:f,es:g,fp:b,bs:c};r&&(a.cs=e,a.fs=h);return a};function jd(a,b,c){b=a.Sf(b);var e,f;c||(c=a.Zg);e=0;for(f=c.length;e<f;e++)b=kd(a,b,c[e]);return b}
function ld(a,b,c){b=a.hh(b);var e,f;c||(c=a.Zg);e=0;for(f=c.length;e<f;e++)b=kd(a,b,c[e]);return b}function kd(a,b,c){a=a.el();var e,f,g,h,k,l;e=0;for(f=b.length;e<f;e++)g=b[e],h=g.x,k=g.y,l=h/a.fp,l=gd(c,l,h),h=c.ya(l),l=c.Tf(l),l.set(-l.y,l.x).G(k),g.x=h.x+l.x,g.y=h.y+l.y;return b}d.Yh=function(){d.A.call(this)};d.Yh.prototype=Object.create(d.A.prototype);fa=d.Yh.prototype;
fa.ra=function(a){this.oa&&this.Dd();if(this.ic||a)this.parent?(cc(this.m,this.parent.m,this.da),this.m.bh(this.bm,this.wp,this.Ql),this.da.bh(this.Wp,this.Kl,this.zp),qc(this.m,this.bm,this.Kl,this.Ql)):this.m.c(this.da),this.ic=!1,a=!0;for(var b=0,c=this.children.length;b<c;b++)this.children[b].ra(a)};fa.bm=new d.b;fa.Wp=new d.b;fa.wp=new d.Zb;fa.Kl=new d.Zb;fa.Ql=new d.b;fa.zp=new d.b;
d.Md=function(a){d.Bg.call(this);this.ha=[];if(a){this.moveTo(a[0].x,a[0].y);for(var b=1,c=a.length;b<c;b++)this.lineTo(a[b].x,a[b].y)}};d.Md.prototype=Object.create(d.Bg.prototype);d.yb={di:"moveTo",Rj:"lineTo",dk:"quadraticCurveTo",Cj:"bezierCurveTo",qm:"splineThru",jm:"arc",Kj:"ellipse"};fa=d.Md.prototype;fa.moveTo=function(a,b){this.ha.push({action:d.yb.di,Db:Array.prototype.slice.call(arguments)})};
fa.lineTo=function(a,b){var c=Array.prototype.slice.call(arguments),e=this.ha[this.ha.length-1].Db;this.Ia.push(new d.ye(new d.g(e[e.length-2],e[e.length-1]),new d.g(a,b)));this.ha.push({action:d.yb.Rj,Db:c})};fa.quadraticCurveTo=function(a,b,c,e){var f=Array.prototype.slice.call(arguments),g=this.ha[this.ha.length-1].Db;this.Ia.push(new d.Ig(new d.g(g[g.length-2],g[g.length-1]),new d.g(a,b),new d.g(c,e)));this.ha.push({action:d.yb.dk,Db:f})};
fa.bezierCurveTo=function(a,b,c,e,f,g){var h=Array.prototype.slice.call(arguments),k=this.ha[this.ha.length-1].Db;this.Ia.push(new d.Ag(new d.g(k[k.length-2],k[k.length-1]),new d.g(a,b),new d.g(c,e),new d.g(f,g)));this.ha.push({action:d.yb.Cj,Db:h})};fa.arc=function(a,b,c,e,f,g){var h=this.ha[this.ha.length-1].Db;this.Nn(a+h[h.length-2],b+h[h.length-1],c,c,e,f,g)};
fa.Nn=function(a,b,c,e,f,g,h){var k=Array.prototype.slice.call(arguments),l=new d.mf(a,b,c,e,f,g,h);this.Ia.push(l);l=l.ya(1);k.push(l.x);k.push(l.y);this.ha.push({action:d.yb.Kj,Db:k})};fa.hh=function(a){a||(a=40);for(var b=[],c=0;c<a;c++)b.push(this.ya(c/a));return b};
fa.Sf=function(a,b){if(this.$p)return console.log("tata"),this.hh(a,b);a=a||12;var c=[],e,f,g,h,k,l,n,q,r,s,u,w,v;e=0;for(f=this.ha.length;e<f;e++)switch(g=this.ha[e],h=g.action,g=g.Db,h){case d.yb.di:c.push(new d.g(g[0],g[1]));break;case d.yb.Rj:c.push(new d.g(g[0],g[1]));break;case d.yb.dk:k=g[2];l=g[3];r=g[0];s=g[1];0<c.length?(h=c[c.length-1],u=h.x,w=h.y):(h=this.ha[e-1].Db,u=h[h.length-2],w=h[h.length-1]);for(g=1;g<=a;g++)v=g/a,h=d.ga.T.Xd(v,u,r,k),v=d.ga.T.Xd(v,w,s,l),c.push(new d.g(h,v));break;
case d.yb.Cj:k=g[4];l=g[5];r=g[0];s=g[1];n=g[2];q=g[3];0<c.length?(h=c[c.length-1],u=h.x,w=h.y):(h=this.ha[e-1].Db,u=h[h.length-2],w=h[h.length-1]);for(g=1;g<=a;g++)v=g/a,h=d.ga.T.Yd(v,u,r,n,k),v=d.ga.T.Yd(v,w,s,q,l),c.push(new d.g(h,v));break;case d.yb.qm:h=this.ha[e-1].Db;v=[new d.g(h[h.length-2],h[h.length-1])];h=a*g[0].length;v=v.concat(g[0]);v=new d.mi(v);for(g=1;g<=h;g++)c.push(v.Rf(g/h));break;case d.yb.jm:k=g[0];l=g[1];s=g[2];n=g[3];h=g[4];r=!!g[5];u=h-n;w=2*a;for(g=1;g<=w;g++)v=g/w,r||(v=
1-v),v=n+v*u,h=k+s*Math.cos(v),v=l+s*Math.sin(v),c.push(new d.g(h,v));break;case d.yb.Kj:for(k=g[0],l=g[1],s=g[2],q=g[3],n=g[4],h=g[5],r=!!g[6],u=h-n,w=2*a,g=1;g<=w;g++)v=g/w,r||(v=1-v),v=n+v*u,h=k+s*Math.cos(v),v=l+q*Math.sin(v),c.push(new d.g(h,v))}e=c[c.length-1];1E-10>Math.abs(e.x-c[0].x)&&1E-10>Math.abs(e.y-c[0].y)&&c.splice(c.length-1,1);b&&c.push(c[0]);return c};
function fd(a){function b(a){for(var b=[],c=0,e=a.length;c<e;c++){var f=a[c],g=new d.ga;g.ha=f.ha;g.Ia=f.Ia;b.push(g)}return b}function c(a,b){for(var c=b.length,e=!1,f=c-1,g=0;g<c;f=g++){var h=b[f],k=b[g],l=k.x-h.x,n=k.y-h.y;if(1E-10<Math.abs(n)){if(0>n&&(h=b[g],l=-l,k=b[f],n=-n),!(a.y<h.y||a.y>k.y))if(a.y==h.y){if(a.x==h.x)return!0}else{f=n*(a.x-h.x)-l*(a.y-h.y);if(0==f)return!0;0>f||(e=!e)}}else if(a.y==h.y&&(k.x<=a.x&&a.x<=h.x||h.x<=a.x&&a.x<=k.x))return!0}return e}var e=function(a){var b,c,e,
f,g=[],h=new d.Md;b=0;for(c=a.length;b<c;b++)e=a[b],f=e.Db,e=e.action,e==d.yb.di&&0!=h.ha.length&&(g.push(h),h=new d.Md),h[e].apply(h,f);0!=h.ha.length&&g.push(h);return g}(a.ha);if(0==e.length)return[];var f,g,h;a=[];if(1==e.length)return g=e[0],h=new d.ga,h.ha=g.ha,h.Ia=g.Ia,a.push(h),a;var k=!d.ga.T.Xe(e[0].Sf());h=[];var l=[],n=[],q=0,r;l[q]=void 0;n[q]=[];var s,u;s=0;for(u=e.length;s<u;s++)g=e[s],r=g.Sf(),(f=d.ga.T.Xe(r))?(!k&&l[q]&&q++,l[q]={mj:new d.ga,wh:r},l[q].mj.ha=g.ha,l[q].mj.Ia=g.Ia,
k&&q++,n[q]=[]):n[q].push({Ho:g,wh:r[0]});if(!l[0])return b(e);if(1<l.length){s=!1;u=[];g=0;for(e=l.length;g<e;g++)h[g]=[];g=0;for(e=l.length;g<e;g++)for(f=n[g],k=0;k<f.length;k++){q=f[k];r=!0;for(var w=0;w<l.length;w++)c(q.wh,l[w].wh)&&(g!=w&&u.push({pr:g,Gs:w,ur:k}),r?(r=!1,h[w].push(q)):s=!0);r&&h[g].push(q)}0<u.length&&(s||(n=h))}s=0;for(u=l.length;s<u;s++)for(h=l[s].mj,a.push(h),g=n[s],e=0,f=g.length;e<f;e++)h.Uc.push(g[e].Ho);return a}d.ga=function(){d.Md.apply(this,arguments);this.Uc=[]};
d.ga.prototype=Object.create(d.Md.prototype);function sd(a,b){var c;if(a.$p){c=ld(a,b);var e,f=a.Uc.length,g=[];for(e=0;e<f;e++)g[e]=ld(a.Uc[e],b,a.Zg)}else for(c=jd(a,b),f=a.Uc.length,g=[],e=0;e<f;e++)g[e]=jd(a.Uc[e],b,a.Zg);return c={shape:c,Uc:g}}
d.ga.T={cm:function(a,b){function c(a,b,c){return a.x!=b.x?a.x<b.x?a.x<=c.x&&c.x<=b.x:b.x<=c.x&&c.x<=a.x:a.y<b.y?a.y<=c.y&&c.y<=b.y:b.y<=c.y&&c.y<=a.y}function e(a,b,e,f){var g=b.x-a.x,h=b.y-a.y,k=f.x-e.x,l=f.y-e.y,n=a.x-e.x,q=a.y-e.y,r=h*k-g*l,B=h*n-g*q;if(1E-10<Math.abs(r)){if(0<r){if(0>B||B>r)return[];k=l*n-k*q;if(0>k||k>r)return[]}else{if(0<B||B<r)return[];k=l*n-k*q;if(0<k||k<r)return[]}if(0==k)return 0!=B&&B!=r?[a]:[];if(k==r)return 0!=B&&B!=r?[b]:[];if(0==B)return[e];if(B==r)return[f];e=k/r;
return[{x:a.x+e*g,y:a.y+e*h}]}if(0!=B||l*n!=k*q)return[];h=0==g&&0==h;k=0==k&&0==l;if(h&&k)return a.x!=e.x||a.y!=e.y?[]:[a];if(h)return c(e,f,a)?[a]:[];if(k)return c(a,b,e)?[e]:[];0!=g?(a.x<b.x?(g=a,k=a.x,h=b,a=b.x):(g=b,k=b.x,h=a,a=a.x),e.x<f.x?(b=e,r=e.x,l=f,e=f.x):(b=f,r=f.x,l=e,e=e.x)):(a.y<b.y?(g=a,k=a.y,h=b,a=b.y):(g=b,k=b.y,h=a,a=a.y),e.y<f.y?(b=e,r=e.y,l=f,e=f.y):(b=f,r=f.y,l=e,e=e.y));return k<=r?a<r?[]:a==r?[]:a<=e?[b,h]:[b,l]:k>e?[]:k==e?[]:a<=e?[g,h]:[g,l]}function f(a,b,c,e){var f=b.x-
a.x,g=b.y-a.y;b=c.x-a.x;c=c.y-a.y;var h=e.x-a.x;e=e.y-a.y;a=f*c-g*b;f=f*e-g*h;return 1E-10<Math.abs(a)?(b=h*c-e*b,0<a?0<=f&&0<=b:0<=f||0<=b):0<f}var g,h,k,l,n,q={};k=a.concat();g=0;for(h=b.length;g<h;g++)Array.prototype.push.apply(k,b[g]);g=0;for(h=k.length;g<h;g++)n=k[g].x+":"+k[g].y,void 0!==q[n]&&console.log("Duplicate point",n),q[n]=g;g=function(a,b){function c(a,b){var e=k.length-1,g=a-1;0>g&&(g=e);var h=a+1;h>e&&(h=0);e=f(k[a],k[g],k[h],l[b]);if(!e)return!1;e=l.length-1;g=b-1;0>g&&(g=e);h=b+
1;h>e&&(h=0);return(e=f(l[b],l[g],l[h],k[a]))?!0:!1}function g(a,b){var c,f;for(c=0;c<k.length;c++)if(f=c+1,f%=k.length,f=e(a,b,k[c],k[f]),0<f.length)return!0;return!1}function h(a,c){var f,g,k,l;for(f=0;f<n.length;f++)for(g=b[n[f]],k=0;k<g.length;k++)if(l=k+1,l%=g.length,l=e(a,c,g[k],g[l]),0<l.length)return!0;return!1}var k=a.concat(),l,n=[],q,r,H,B,D,F=[],L,M,ea,T=0;for(q=b.length;T<q;T++)n.push(T);L=0;for(var Q=2*n.length;0<n.length;){Q--;if(0>Q){console.log("Infinite Loop! Holes left:"+n.length+
", Probably Hole outside Shape!");break}for(r=L;r<k.length;r++){H=k[r];q=-1;for(T=0;T<n.length;T++)if(B=n[T],D=H.x+":"+H.y+":"+B,void 0===F[D]){l=b[B];for(M=0;M<l.length;M++)if(B=l[M],c(r,M)&&!g(H,B)&&!h(H,B)){q=M;n.splice(T,1);L=k.slice(0,r+1);B=k.slice(r);M=l.slice(q);ea=l.slice(0,q+1);k=L.concat(M).concat(ea).concat(B);L=r;break}if(0<=q)break;F[D]=!0}if(0<=q)break}}return k}(a,b);var r=d.wb.ni(g,!1);g=0;for(h=r.length;g<h;g++)for(l=r[g],k=0;3>k;k++)n=l[k].x+":"+l[k].y,n=q[n],void 0!==n&&(l[k]=
n);return r.concat()},Xe:function(a){return 0>d.wb.ni.Qk(a)},Yn:function(a,b){var c=1-a;return c*c*b},Zn:function(a,b){return 2*(1-a)*a*b},$n:function(a,b){return a*a*b},Xd:function(a,b,c,e){return this.Yn(a,b)+this.Zn(a,c)+this.$n(a,e)},ao:function(a,b){var c=1-a;return c*c*c*b},bo:function(a,b){var c=1-a;return 3*c*c*a*b},co:function(a,b){return 3*(1-a)*a*a*b},eo:function(a,b){return a*a*a*b},Yd:function(a,b,c,e,f){return this.ao(a,b)+this.bo(a,c)+this.co(a,e)+this.eo(a,f)}};
d.ye=function(a,b){this.X=a;this.ba=b};d.ye.prototype=Object.create(d.fa.prototype);d.ye.prototype.ya=function(a){var b=this.ba.clone().sub(this.X);b.G(a).add(this.X);return b};d.ye.prototype.Rf=function(a){return this.ya(a)};d.ye.prototype.Tf=function(){return this.ba.clone().sub(this.X).normalize()};d.Ig=function(a,b,c){this.fb=a;this.X=b;this.ba=c};d.Ig.prototype=Object.create(d.fa.prototype);
d.Ig.prototype.ya=function(a){return new d.g(d.ga.T.Xd(a,this.fb.x,this.X.x,this.ba.x),d.ga.T.Xd(a,this.fb.y,this.X.y,this.ba.y))};d.Ig.prototype.Tf=function(a){a=new d.g(d.fa.T.$l(a,this.fb.x,this.X.x,this.ba.x),d.fa.T.$l(a,this.fb.y,this.X.y,this.ba.y));a.normalize();return a};d.Ag=function(a,b,c,e){this.fb=a;this.X=b;this.ba=c;this.Ub=e};d.Ag.prototype=Object.create(d.fa.prototype);
d.Ag.prototype.ya=function(a){return new d.g(d.ga.T.Yd(a,this.fb.x,this.X.x,this.ba.x,this.Ub.x),d.ga.T.Yd(a,this.fb.y,this.X.y,this.ba.y,this.Ub.y))};d.Ag.prototype.Tf=function(a){a=new d.g(d.fa.T.Zl(a,this.fb.x,this.X.x,this.ba.x,this.Ub.x),d.fa.T.Zl(a,this.fb.y,this.X.y,this.ba.y,this.Ub.y));a.normalize();return a};d.mi=function(a){this.ma=void 0==a?[]:a};d.mi.prototype=Object.create(d.fa.prototype);
d.mi.prototype.ya=function(a){var b=new d.g,c=[],e=this.ma,f;f=(e.length-1)*a;a=Math.floor(f);f-=a;c[0]=0==a?a:a-1;c[1]=a;c[2]=a>e.length-2?e.length-1:a+1;c[3]=a>e.length-3?e.length-1:a+2;b.x=d.fa.T.wd(e[c[0]].x,e[c[1]].x,e[c[2]].x,e[c[3]].x,f);b.y=d.fa.T.wd(e[c[0]].y,e[c[1]].y,e[c[2]].y,e[c[3]].y,f);return b};d.mf=function(a,b,c,e,f,g,h){this.Ln=a;this.Mn=b;this.eq=c;this.fq=e;this.Kk=f;this.Jk=g;this.Kn=h};d.mf.prototype=Object.create(d.fa.prototype);
d.mf.prototype.ya=function(a){var b=this.Jk-this.Kk;0>b&&(b+=2*Math.PI);b>2*Math.PI&&(b-=2*Math.PI);a=!0===this.Kn?this.Jk+(1-a)*(2*Math.PI-b):this.Kk+a*b;return new d.g(this.Ln+this.eq*Math.cos(a),this.Mn+this.fq*Math.sin(a))};d.mm=function(a,b,c,e,f,g){d.mf.call(this,a,b,c,c,e,f,g)};d.mm.prototype=Object.create(d.mf.prototype);d.Aq=d.fa.create(function(a,b){this.X=a;this.ba=b},function(a){var b=new d.b;b.ca(this.ba,this.X);b.G(a);b.add(this.X);return b});
d.Iq=d.fa.create(function(a,b,c){this.fb=a;this.X=b;this.ba=c},function(a){return new d.b(d.ga.T.Xd(a,this.fb.x,this.X.x,this.ba.x),d.ga.T.Xd(a,this.fb.y,this.X.y,this.ba.y),d.ga.T.Xd(a,this.fb.z,this.X.z,this.ba.z))});d.mq=d.fa.create(function(a,b,c,e){this.fb=a;this.X=b;this.ba=c;this.Ub=e},function(a){return new d.b(d.ga.T.Yd(a,this.fb.x,this.X.x,this.ba.x,this.Ub.x),d.ga.T.Yd(a,this.fb.y,this.X.y,this.ba.y,this.Ub.y),d.ga.T.Yd(a,this.fb.z,this.X.z,this.ba.z,this.Ub.z))});
d.Mq=d.fa.create(function(a){this.ma=void 0==a?[]:a},function(a){var b=new d.b,c=[],e=this.ma,f;a*=e.length-1;f=Math.floor(a);a-=f;c[0]=0==f?f:f-1;c[1]=f;c[2]=f>e.length-2?e.length-1:f+1;c[3]=f>e.length-3?e.length-1:f+2;f=e[c[0]];var g=e[c[1]],h=e[c[2]],c=e[c[3]];b.x=d.fa.T.wd(f.x,g.x,h.x,c.x,a);b.y=d.fa.T.wd(f.y,g.y,h.y,c.y,a);b.z=d.fa.T.wd(f.z,g.z,h.z,c.z,a);return b});
d.jq=d.fa.create(function(a){this.ma=void 0==a?[]:a},function(a){var b=new d.b,c=[],e=this.ma,f;f=(e.length-0)*a;a=Math.floor(f);f-=a;a+=0<a?0:(Math.floor(Math.abs(a)/e.length)+1)*e.length;c[0]=(a-1)%e.length;c[1]=a%e.length;c[2]=(a+1)%e.length;c[3]=(a+2)%e.length;b.x=d.fa.T.wd(e[c[0]].x,e[c[1]].x,e[c[2]].x,e[c[3]].x,f);b.y=d.fa.T.wd(e[c[0]].y,e[c[1]].y,e[c[2]].y,e[c[3]].y,f);b.z=d.fa.T.wd(e[c[0]].z,e[c[1]].z,e[c[2]].z,e[c[3]].z,f);return b});
d.$a={LINEAR:0,Sh:1,zg:2,add:function(){console.warn("THREE.AnimationHandler.add() has been deprecated.")},get:function(){console.warn("THREE.AnimationHandler.get() has been deprecated.")},remove:function(){console.warn("THREE.AnimationHandler.remove() has been deprecated.")},rd:[],vd:function(a){if(!0!==a.Vo){for(var b=0;b<a.v.length;b++){for(var c=0;c<a.v[b].keys.length;c++)0>a.v[b].keys[c].time&&(a.v[b].keys[c].time=0),void 0===a.v[b].keys[c].lg||a.v[b].keys[c].lg instanceof d.Zb||(a.v[b].keys[c].lg=
(new d.Zb).Fb(a.v[b].keys[c].lg));if(a.v[b].keys.length&&void 0!==a.v[b].keys[0].w){for(var e={},c=0;c<a.v[b].keys.length;c++)for(var f=0;f<a.v[b].keys[c].w.length;f++){var g=a.v[b].keys[c].w[f];e[g]=-1}a.v[b].Ks=e;for(c=0;c<a.v[b].keys.length;c++){var h={};for(g in e){for(f=0;f<a.v[b].keys[c].w.length;f++)if(a.v[b].keys[c].w[f]===g){h[g]=a.v[b].keys[c].jp[f];break}f===a.v[b].keys[c].w.length&&(h[g]=0)}a.v[b].keys[c].jp=h}}for(c=1;c<a.v[b].keys.length;c++)a.v[b].keys[c].time===a.v[b].keys[c-1].time&&
(a.v[b].keys.splice(c,1),c--);for(c=0;c<a.v[b].keys.length;c++)a.v[b].keys[c].index=c}a.Vo=!0;return a}},parse:function(a){function b(a,c){c.push(a);for(var e=0;e<a.children.length;e++)b(a.children[e],c)}var c=[];if(a instanceof d.vc)for(var e=0;e<a.Za.Z.length;e++)c.push(a.Za.Z[e]);else b(a,c);return c},play:function(a){-1===this.rd.indexOf(a)&&this.rd.push(a)},stop:function(a){a=this.rd.indexOf(a);-1!==a&&this.rd.splice(a,1)},update:function(a){for(var b=0;b<this.rd.length;b++)this.rd[b].update(a)}};
d.lm=function(a,b){this.root=a;this.data=d.$a.vd(b);this.v=d.$a.parse(a);this.currentTime=0;this.wj=1;this.gc=!1;this.loop=!0;this.weight=0;this.xd=d.$a.LINEAR};fa=d.lm.prototype;fa.ll=["pos","rot","scl"];fa.play=function(a,b){this.currentTime=void 0!==a?a:0;this.weight=void 0!==b?b:1;this.gc=!0;this.reset();d.$a.play(this)};fa.stop=function(){this.gc=!1;d.$a.stop(this)};
fa.reset=function(){for(var a=0,b=this.v.length;a<b;a++){var c=this.v[a];c.oa=!0;void 0===c.Ga&&(c.Ga={});void 0===c.Ga[this.data.name]&&(c.Ga[this.data.name]={},c.Ga[this.data.name].me={Hl:0,lg:0,Rl:0},c.Ga[this.data.name].ie={Hl:0,lg:0,Rl:0},c.Ga[this.data.name].El=c.da);for(var c=c.Ga[this.data.name],e=0;3>e;e++){for(var f=this.ll[e],g=this.data.v[a].keys[0],h=this.ee(f,a,1);h.time<this.currentTime&&h.index>g.index;)g=h,h=this.ee(f,a,h.index+1);c.me[f]=g;c.ie[f]=h}}};
fa.update=function(){function a(a,b,c,e,f,g,s){a=.5*(c-a);e=.5*(e-b);return(2*(b-c)+a+e)*s+(-3*(b-c)-2*a-e)*g+a*f+b}function b(b,c){var e=[],f=[],g,r,s,u,w,v;g=(b.length-1)*c;r=Math.floor(g);g-=r;e[0]=0===r?r:r-1;e[1]=r;e[2]=r>b.length-2?r:r+1;e[3]=r>b.length-3?r:r+2;r=b[e[0]];u=b[e[1]];w=b[e[2]];v=b[e[3]];e=g*g;s=g*e;f[0]=a(r[0],u[0],w[0],v[0],g,e,s);f[1]=a(r[1],u[1],w[1],v[1],g,e,s);f[2]=a(r[2],u[2],w[2],v[2],g,e,s);return f}var c=[],e=new d.b,f=new d.b,g=new d.Zb;return function(a){if(!1!==this.gc&&
(this.currentTime+=a*this.wj,0!==this.weight)){a=this.data.length;if(!0===this.loop&&this.currentTime>a)this.currentTime%=a,this.reset();else if(!1===this.loop&&this.currentTime>a){this.stop();return}a=0;for(var k=this.v.length;a<k;a++)for(var l=this.v[a],n=l.Ga[this.data.name],q=0;3>q;q++){var r=this.ll[q],s=n.me[r],u=n.ie[r];if(u.time<=this.currentTime){s=this.data.v[a].keys[0];for(u=this.ee(r,a,1);u.time<this.currentTime&&u.index>s.index;)s=u,u=this.ee(r,a,u.index+1);n.me[r]=s;n.ie[r]=u}l.oa=!0;
l.ic=!0;var w=(this.currentTime-s.time)/(u.time-s.time),v=s[r],y=u[r];0>w&&(w=0);1<w&&(w=1);if("pos"===r)if(this.xd===d.$a.LINEAR)f.x=v[0]+(y[0]-v[0])*w,f.y=v[1]+(y[1]-v[1])*w,f.z=v[2]+(y[2]-v[2])*w,l instanceof d.Vb?(s=this.weight/(this.weight+l.Vd),l.position.Ic(f,s),l.Vd+=this.weight):l.position.c(f);else{if(this.xd===d.$a.Sh||this.xd===d.$a.zg)c[0]=this.fl("pos",a,s.index-1).pos,c[1]=v,c[2]=y,c[3]=this.ee("pos",a,u.index+1).pos,w=.33*w+.33,u=b(c,w),s=1,l instanceof d.Vb&&(s=this.weight/(this.weight+
l.Vd),l.Vd+=this.weight),r=l.position,r.x+=(u[0]-r.x)*s,r.y+=(u[1]-r.y)*s,r.z+=(u[2]-r.z)*s,this.xd===d.$a.zg&&(w=b(c,1.01*w),e.set(w[0],w[1],w[2]),e.sub(r),e.y=0,e.normalize(),l.rotation.set(0,Math.atan2(e.x,e.z),0))}else"rot"===r?(d.Zb.Ih(v,y,g,w),l instanceof d.Vb?0===l.Ke?(l.cb.c(g),l.Ke=this.weight):(s=this.weight/(this.weight+l.Ke),d.Zb.Ih(l.cb,g,l.cb,s),l.Ke+=this.weight):l.cb.c(g)):"scl"===r&&(f.x=v[0]+(y[0]-v[0])*w,f.y=v[1]+(y[1]-v[1])*w,f.z=v[2]+(y[2]-v[2])*w,l instanceof d.Vb?(s=this.weight/
(this.weight+l.Wg),l.scale.Ic(f,s),l.Wg+=this.weight):l.scale.c(f))}return!0}}}();fa.ee=function(a,b,c){var e=this.data.v[b].keys;for(c=this.xd===d.$a.Sh||this.xd===d.$a.zg?c<e.length-1?c:e.length-1:c%e.length;c<e.length;c++)if(void 0!==e[c][a])return e[c];return this.data.v[b].keys[0]};fa.fl=function(a,b,c){var e=this.data.v[b].keys;for(c=this.xd===d.$a.Sh||this.xd===d.$a.zg?0<c?c:0:0<=c?c:c+e.length;0<=c;c--)if(void 0!==e[c][a])return e[c];return this.data.v[b].keys[e.length-1]};
d.Hm=function(a){this.root=a.zl;this.data=d.$a.vd(a);this.v=d.$a.parse(this.root);this.currentTime=0;this.wj=.001;this.gc=!1;this.loop=!0;a=0;for(var b=this.v.length;a<b;a++){var c=this.data.v[a].Bs,e=this.v[a];if(this.data.v[a].keys.length&&c){for(var f=0;f<c.length;f++){var g=c[f],h=this.ee(g,a,0);h&&h.apply(g)}e.oa=!1;this.data.v[a].zl.Dd();e.ic=!0}}};fa=d.Hm.prototype;
fa.play=function(a){this.currentTime=void 0!==a?a:0;if(!1===this.gc){this.gc=!0;var b=this.v.length,c,e;for(a=0;a<b;a++)c=this.v[a],e=this.data.v[a],void 0===e.Ga&&(e.Ga={},e.Ga.me=null,e.Ga.ie=null,e.Ga.El=c.da),c=this.data.v[a].keys,c.length&&(e.Ga.me=c[0],e.Ga.ie=c[1],this.startTime=Math.min(c[0].time,this.startTime),this.endTime=Math.max(c[c.length-1].time,this.endTime));this.update(0)}d.$a.play(this)};
fa.stop=function(){this.gc=!1;d.$a.stop(this);for(var a=0;a<this.data.v.length;a++){var b=this.v[a],c=this.data.v[a];if(void 0!==c.Ga){var e=c.Ga.El;e.c(b.da);b.da=e;delete c.Ga}}};
fa.update=function(a){if(!1!==this.gc){this.currentTime+=a*this.wj;a=this.data.length;!0===this.loop&&this.currentTime>a&&(this.currentTime%=a);this.currentTime=Math.min(this.currentTime,a);a=0;for(var b=this.v.length;a<b;a++){var c=this.v[a],e=this.data.v[a],f=e.keys,e=e.Ga;if(f.length){var g=e.me,h=e.ie;if(h.time<=this.currentTime){for(;h.time<this.currentTime&&h.index>g.index;)g=h,h=f[g.index+1];e.me=g;e.ie=h}this.data.v[a].zl.Dd();c.ic=!0}}}};
fa.ee=function(a,b,c){b=this.data.v[b].keys;for(c%=b.length;c<b.length;c++)if(b[c].Lo(a))return b[c];return b[0]};fa.fl=function(a,b,c){b=this.data.v[b].keys;for(c=0<=c?c:c+b.length;0<=c;c--)if(b[c].Lo(a))return b[c];return b[b.length-1]};d.Qm=function(a){this.ge=a;this.frames=a.Wa.length;this.currentTime=0;this.duration=1E3;this.loop=!0;this.gc=!1};
d.Qm.prototype={play:function(){this.gc=!0},update:function(){var a=0,b=0;return function(c){if(!1!==this.gc){this.currentTime+=c;!0===this.loop&&this.currentTime>this.duration&&(this.currentTime%=this.duration);this.currentTime=Math.min(this.currentTime,this.duration);c=this.duration/this.frames;var e=Math.floor(this.currentTime/c);e!=b&&(this.ge.Wa[a]=0,this.ge.Wa[b]=1,this.ge.Wa[e]=0,a=b,b=e);this.ge.Wa[e]=this.currentTime%c/c;this.ge.Wa[a]=1-this.ge.Wa[e]}}}()};
d.yg=function(a,b,c,e,f,g){function h(a,b,c,e,f,g,h,v){var y,z=k.Qh,x=k.Vf,C=f/2,E=g/2,A=k.e.length;if("x"===a&&"y"===b||"y"===a&&"x"===b)y="z";else if("x"===a&&"z"===b||"z"===a&&"x"===b)y="y",x=k.Li;else if("z"===a&&"y"===b||"y"===a&&"z"===b)y="x",z=k.Li;var H=z+1,B=x+1,D=f/z,F=g/x,L=new d.b;L[y]=0<h?1:-1;for(f=0;f<B;f++)for(g=0;g<H;g++){var M=new d.b;M[a]=(g*D-C)*c;M[b]=(f*F-E)*e;M[y]=h;k.e.push(M)}for(f=0;f<x;f++)for(g=0;g<z;g++)a=g+H*(f+1),b=g+1+H*(f+1),c=g+1+H*f,e=new d.g(g/z,1-f/x),h=new d.g(g/
z,1-(f+1)/x),y=new d.g((g+1)/z,1-(f+1)/x),C=new d.g((g+1)/z,1-f/x),E=new d.P(g+H*f+A,a+A,c+A),E.F.c(L),E.na.push(L.clone(),L.clone(),L.clone()),E.Hb=v,k.j.push(E),k.D[0].push([e,h,C]),E=new d.P(a+A,b+A,c+A),E.F.c(L),E.na.push(L.clone(),L.clone(),L.clone()),E.Hb=v,k.j.push(E),k.D[0].push([h.clone(),y,C.clone()])}d.u.call(this);this.Qh=e||1;this.Vf=f||1;this.Li=g||1;var k=this;e=a/2;f=b/2;g=c/2;h("z","y",-1,-1,c,b,e,0);h("z","y",1,-1,c,b,-e,1);h("x","z",1,1,a,c,f,2);h("x","z",1,-1,a,c,-f,3);h("x","y",
1,-1,a,b,g,4);h("x","y",-1,-1,a,b,-g,5);$c(this)};d.yg.prototype=Object.create(d.u.prototype);
d.Gj=function(a,b,c,e){d.u.call(this);a=a||50;b=void 0!==b?Math.max(3,b):8;c=void 0!==c?c:0;e=void 0!==e?e:2*Math.PI;var f,g=[],h=new d.g(.5,.5);this.e.push(new d.b);g.push(h);for(f=0;f<=b;f++){var k=new d.b,l=c+f/b*e;k.x=a*Math.cos(l);k.y=a*Math.sin(l);this.e.push(k);g.push(new d.g((k.x/a+1)/2,(k.y/a+1)/2))}c=new d.b(0,0,1);for(f=1;f<=b;f++)this.j.push(new d.P(f,f+1,0,[c.clone(),c.clone(),c.clone()])),this.D[0].push([g[f].clone(),g[f+1].clone(),h.clone()]);this.kb();this.Ra=new d.$b(new d.b,a)};
d.Gj.prototype=Object.create(d.u.prototype);d.kq=function(a,b,c,e,f,g){console.warn("THEE.CubeGeometry has been renamed to THREE.BoxGeometry.");return new d.yg(a,b,c,e,f,g)};
d.Cg=function(a,b,c,e,f,g){d.u.call(this);a=void 0!==a?a:20;b=void 0!==b?b:20;c=void 0!==c?c:100;e=e||8;f=f||1;g=void 0!==g?g:!1;var h=c/2,k,l,n=[],q=[];for(l=0;l<=f;l++){var r=[],s=[],u=l/f,w=u*(b-a)+a;for(k=0;k<=e;k++){var v=k/e,y=new d.b;y.x=w*Math.sin(v*Math.PI*2);y.y=-u*c+h;y.z=w*Math.cos(v*Math.PI*2);this.e.push(y);r.push(this.e.length-1);s.push(new d.g(v,1-u))}n.push(r);q.push(s)}c=(b-a)/c;for(k=0;k<e;k++)for(0!==a?(r=this.e[n[0][k]].clone(),s=this.e[n[0][k+1]].clone()):(r=this.e[n[1][k]].clone(),
s=this.e[n[1][k+1]].clone()),r.ng(Math.sqrt(r.x*r.x+r.z*r.z)*c).normalize(),s.ng(Math.sqrt(s.x*s.x+s.z*s.z)*c).normalize(),l=0;l<f;l++){var u=n[l][k],w=n[l+1][k],v=n[l+1][k+1],y=n[l][k+1],z=r.clone(),x=r.clone(),C=s.clone(),E=s.clone(),A=q[l][k].clone(),H=q[l+1][k].clone(),B=q[l+1][k+1].clone(),D=q[l][k+1].clone();this.j.push(new d.P(u,w,y,[z,x,E]));this.D[0].push([A,H,D]);this.j.push(new d.P(w,v,y,[x.clone(),C,E.clone()]));this.D[0].push([H.clone(),B,D.clone()])}if(!1===g&&0<a)for(this.e.push(new d.b(0,
h,0)),k=0;k<e;k++)u=n[0][k],w=n[0][k+1],v=this.e.length-1,z=new d.b(0,1,0),x=new d.b(0,1,0),C=new d.b(0,1,0),A=q[0][k].clone(),H=q[0][k+1].clone(),B=new d.g(H.x,0),this.j.push(new d.P(u,w,v,[z,x,C])),this.D[0].push([A,H,B]);if(!1===g&&0<b)for(this.e.push(new d.b(0,-h,0)),k=0;k<e;k++)u=n[l][k+1],w=n[l][k],v=this.e.length-1,z=new d.b(0,-1,0),x=new d.b(0,-1,0),C=new d.b(0,-1,0),A=q[l][k+1].clone(),H=q[l][k].clone(),B=new d.g(H.x,1),this.j.push(new d.P(u,w,v,[z,x,C])),this.D[0].push([A,H,B]);this.kb()};
d.Cg.prototype=Object.create(d.u.prototype);d.qb=function(a,b){"undefined"!==typeof a&&(d.u.call(this),a=a instanceof Array?a:[a],this.vi(a,b),this.kb())};d.qb.prototype=Object.create(d.u.prototype);d.qb.prototype.vi=function(a,b){for(var c=a.length,e=0;e<c;e++)this.ui(a[e],b)};
d.qb.prototype.ui=function(a,b){function c(a,b,c){b||console.log("die");return b.clone().G(c).add(a)}function e(a,b,c){var e=d.Math.Gp,f=1,f=a.x-b.x,g=a.y-b.y,h=c.x-a.x,k=c.y-a.y,l=f*f+g*g;if(1E-10<Math.abs(f*k-g*h)){var n=Math.sqrt(l),e=Math.sqrt(h*h+k*k),l=b.x-g/n;b=b.y+f/n;h=((c.x-k/e-l)*k-(c.y+h/e-b)*h)/(f*k-g*h);c=l+f*h-a.x;a=b+g*h-a.y;f=c*c+a*a;if(2>=f)return new d.g(c,a);f=Math.sqrt(f/2)}else a=!1,1E-10<f?1E-10<h&&(a=!0):-1E-10>f?-1E-10>h&&(a=!0):e(g)==e(k)&&(a=!0),a?(c=-g,a=f,f=Math.sqrt(l)):
(c=f,a=g,f=Math.sqrt(l/2));return new d.g(c/f,a/f)}function f(c,e){var f,g;for(S=c.length;0<=--S;){f=S;g=S-1;0>g&&(g=c.length-1);for(var h=0,k=u+2*q,h=0;h<k;h++){var l=V*h,n=V*(h+1),r=e+f+l,l=e+g+l,s=e+g+n,n=e+f+n,v=c,w=h,z=k,y=f,A=g,r=r+ea,l=l+ea,s=s+ea,n=n+ea;M.j.push(new d.P(r,l,n,null,null,x));M.j.push(new d.P(l,s,n,null,null,x));r=C.Eo(M,a,v,b,r,l,s,n,w,z,y,A);M.D[0].push([r[0],r[1],r[3]]);M.D[0].push([r[1],r[2],r[3]])}}}function g(a,b,c){M.e.push(new d.b(a,b,c))}function h(c,e,f,g){c+=ea;e+=
ea;f+=ea;M.j.push(new d.P(c,e,f,null,null,z));M.D[0].push(g?C.cl(M,a,b,c,e,f):C.dl(M,a,b,c,e,f))}var k=void 0!==b.Nk?b.Nk:100,l=void 0!==b.Ci?b.Ci:6,n=void 0!==b.Bi?b.Bi:l-2,q=void 0!==b.fo?b.fo:3,r=void 0!==b.Ai?b.Ai:!0,s=void 0!==b.If?b.If:12,u=void 0!==b.Tp?b.Tp:1,w=b.gr,v,y=!1,z=b.r,x=b.fr,C=void 0!==b.pi?b.pi:d.qb.tk,E,A,H,B;w&&(v=w.hh(u),y=!0,r=!1,E=void 0!==b.frames?b.frames:new d.Mg.Mj(w,u,!1),A=new d.b,H=new d.b,B=new d.b);r||(n=l=q=0);var D,F,L,M=this,ea=this.e.length,w=sd(a,s),s=w.shape,
T=w.Uc;if(w=!d.ga.T.Xe(s)){s=s.reverse();F=0;for(L=T.length;F<L;F++)D=T[F],d.ga.T.Xe(D)&&(T[F]=D.reverse());w=!1}var Q=d.ga.T.cm(s,T),P=s;F=0;for(L=T.length;F<L;F++)D=T[F],s=s.concat(D);var G,K,J,ba,R,V=s.length,U,ca=Q.length,w=[],S=0;J=P.length;G=J-1;for(K=S+1;S<J;S++,G++,K++)G===J&&(G=0),K===J&&(K=0),w[S]=e(P[S],P[G],P[K]);var Y=[],da,aa=w.concat();F=0;for(L=T.length;F<L;F++){D=T[F];da=[];S=0;J=D.length;G=J-1;for(K=S+1;S<J;S++,G++,K++)G===J&&(G=0),K===J&&(K=0),da[S]=e(D[S],D[G],D[K]);Y.push(da);
aa=aa.concat(da)}for(G=0;G<q;G++){J=G/q;ba=l*(1-J);K=n*Math.sin(J*Math.PI/2);S=0;for(J=P.length;S<J;S++)R=c(P[S],w[S],K),g(R.x,R.y,-ba);F=0;for(L=T.length;F<L;F++)for(D=T[F],da=Y[F],S=0,J=D.length;S<J;S++)R=c(D[S],da[S],K),g(R.x,R.y,-ba)}K=n;for(S=0;S<V;S++)R=r?c(s[S],aa[S],K):s[S],y?(H.c(E.cg[0]).G(R.x),A.c(E.$g[0]).G(R.y),B.c(v[0]).add(H).add(A),g(B.x,B.y,B.z)):g(R.x,R.y,0);for(J=1;J<=u;J++)for(S=0;S<V;S++)R=r?c(s[S],aa[S],K):s[S],y?(H.c(E.cg[J]).G(R.x),A.c(E.$g[J]).G(R.y),B.c(v[J]).add(H).add(A),
g(B.x,B.y,B.z)):g(R.x,R.y,k/u*J);for(G=q-1;0<=G;G--){J=G/q;ba=l*(1-J);K=n*Math.sin(J*Math.PI/2);S=0;for(J=P.length;S<J;S++)R=c(P[S],w[S],K),g(R.x,R.y,k+ba);F=0;for(L=T.length;F<L;F++)for(D=T[F],da=Y[F],S=0,J=D.length;S<J;S++)R=c(D[S],da[S],K),y?g(R.x,R.y+v[u-1].y,v[u-1].x+ba):g(R.x,R.y,k+ba)}(function(){if(r){var a;a=0*V;for(S=0;S<ca;S++)U=Q[S],h(U[2]+a,U[1]+a,U[0]+a,!0);a=u+2*q;a*=V;for(S=0;S<ca;S++)U=Q[S],h(U[0]+a,U[1]+a,U[2]+a,!1)}else{for(S=0;S<ca;S++)U=Q[S],h(U[2],U[1],U[0],!0);for(S=0;S<ca;S++)U=
Q[S],h(U[0]+V*u,U[1]+V*u,U[2]+V*u,!1)}})();(function(){var a=0;f(P,a);a+=P.length;F=0;for(L=T.length;F<L;F++)D=T[F],f(D,a),a+=D.length})()};
d.qb.tk={dl:function(a,b,c,e,f,g){return[new d.g(a.e[e].x,a.e[e].y),new d.g(a.e[f].x,a.e[f].y),new d.g(a.e[g].x,a.e[g].y)]},cl:function(a,b,c,e,f,g){return this.dl(a,b,c,e,f,g)},Eo:function(a,b,c,e,f,g,h,k){b=a.e[f].x;c=a.e[f].y;f=a.e[f].z;e=a.e[g].x;var l=a.e[g].y;g=a.e[g].z;var n=a.e[h].x,q=a.e[h].y;h=a.e[h].z;var r=a.e[k].x,s=a.e[k].y;a=a.e[k].z;return.01>Math.abs(c-l)?[new d.g(b,1-f),new d.g(e,1-g),new d.g(n,1-h),new d.g(r,1-a)]:[new d.g(c,1-f),new d.g(l,1-g),new d.g(q,1-h),new d.g(s,1-a)]}};
d.qb.Rq=new d.g;d.qb.Sq=new d.g;d.qb.Tq=new d.g;d.qb.Uq=new d.g;d.qb.Vq=new d.g;d.qb.Wq=new d.g;d.li=function(a,b){d.u.call(this);!1===a instanceof Array&&(a=[a]);this.vi(a,b);this.kb()};d.li.prototype=Object.create(d.u.prototype);d.li.prototype.vi=function(a,b){for(var c=0,e=a.length;c<e;c++)this.ui(a[c],b);return this};
d.li.prototype.ui=function(a,b){void 0===b&&(b={});var c=b.r,e=void 0===b.pi?d.qb.tk:b.pi,f,g,h,k=this.e.length;f=sd(a,void 0!==b.If?b.If:12);var l=f.shape,n=f.Uc;if(!d.ga.T.Xe(l))for(l=l.reverse(),f=0,g=n.length;f<g;f++)h=n[f],d.ga.T.Xe(h)&&(n[f]=h.reverse());var q=d.ga.T.cm(l,n);f=0;for(g=n.length;f<g;f++)h=n[f],l=l.concat(h);n=l.length;g=q.length;for(f=0;f<n;f++)h=l[f],this.e.push(new d.b(h.x,h.y,0));for(f=0;f<g;f++)n=q[f],l=n[0]+k,h=n[1]+k,n=n[2]+k,this.j.push(new d.P(l,h,n,null,null,c)),this.D[0].push(e.cl(this,
a,b,l,h,n))};
d.Im=function(a,b,c,e){d.u.call(this);b=b||12;c=c||0;e=e||2*Math.PI;for(var f=1/(a.length-1),g=1/b,h=0,k=b;h<=k;h++)for(var l=c+h*g*e,n=Math.cos(l),q=Math.sin(l),l=0,r=a.length;l<r;l++){var s=a[l],u=new d.b;u.x=n*s.x-q*s.y;u.y=q*s.x+n*s.y;u.z=s.z;this.e.push(u)}c=a.length;h=0;for(k=b;h<k;h++)for(l=0,r=a.length-1;l<r;l++){b=q=l+c*h;e=q+c;var n=q+1+c,q=q+1,s=h*g,u=l*f,w=s+g,v=u+f;this.j.push(new d.P(b,e,q));this.D[0].push([new d.g(s,u),new d.g(w,u),new d.g(s,v)]);this.j.push(new d.P(e,n,q));this.D[0].push([new d.g(w,
u),new d.g(w,v),new d.g(s,v)])}$c(this);this.kb();this.Gf()};d.Im.prototype=Object.create(d.u.prototype);
d.bk=function(a,b,c,e){d.u.call(this);var f=a/2,g=b/2;c=c||1;e=e||1;var h=c+1,k=e+1,l=a/c,n=b/e,q=new d.b(0,0,1);for(a=0;a<k;a++){var r=a*n-g;for(b=0;b<h;b++)this.e.push(new d.b(b*l-f,-r,0))}for(a=0;a<e;a++)for(b=0;b<c;b++){var f=b+h*(a+1),g=b+1+h*(a+1),k=b+1+h*a,l=new d.g(b/c,1-a/e),n=new d.g(b/c,1-(a+1)/e),r=new d.g((b+1)/c,1-(a+1)/e),s=new d.g((b+1)/c,1-a/e),u=new d.P(b+h*a,f,k);u.F.c(q);u.na.push(q.clone(),q.clone(),q.clone());this.j.push(u);this.D[0].push([l,n,s]);u=new d.P(f,g,k);u.F.c(q);u.na.push(q.clone(),
q.clone(),q.clone());this.j.push(u);this.D[0].push([n.clone(),r,s.clone()])}};d.bk.prototype=Object.create(d.u.prototype);
d.gn=function(a,b,c,e,f,g){d.u.call(this);a=a||0;b=b||50;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;e=void 0!==e?Math.max(1,e):8;var h,k=[],l=a,n=(b-a)/e;for(a=0;a<e+1;a++){for(h=0;h<c+1;h++){var q=new d.b,r=f+h/c*g;q.x=l*Math.cos(r);q.y=l*Math.sin(r);this.e.push(q);k.push(new d.g((q.x/b+1)/2,(q.y/b+1)/2))}l+=n}b=new d.b(0,0,1);for(a=0;a<e;a++)for(f=a*(c+1),h=0;h<c;h++)g=r=h+f,n=r+c+1,q=r+c+2,this.j.push(new d.P(g,n,q,[b.clone(),b.clone(),b.clone()])),this.D[0].push([k[g].clone(),
k[n].clone(),k[q].clone()]),g=r,n=r+c+2,q=r+1,this.j.push(new d.P(g,n,q,[b.clone(),b.clone(),b.clone()])),this.D[0].push([k[g].clone(),k[n].clone(),k[q].clone()]);this.kb();this.Ra=new d.$b(new d.b,l)};d.gn.prototype=Object.create(d.u.prototype);
d.Lg=function(a,b,c,e,f,g,h){d.u.call(this);a=a||50;b=Math.max(3,Math.floor(b)||8);c=Math.max(2,Math.floor(c)||6);e=void 0!==e?e:0;f=void 0!==f?f:2*Math.PI;g=void 0!==g?g:0;h=void 0!==h?h:Math.PI;var k,l,n=[],q=[];for(l=0;l<=c;l++){var r=[],s=[];for(k=0;k<=b;k++){var u=k/b,w=l/c,v=new d.b;v.x=-a*Math.cos(e+u*f)*Math.sin(g+w*h);v.y=a*Math.cos(g+w*h);v.z=a*Math.sin(e+u*f)*Math.sin(g+w*h);this.e.push(v);r.push(this.e.length-1);s.push(new d.g(u,1-w))}n.push(r);q.push(s)}for(l=0;l<c;l++)for(k=0;k<b;k++){e=
n[l][k+1];f=n[l][k];g=n[l+1][k];h=n[l+1][k+1];var r=this.e[e].clone().normalize(),s=this.e[f].clone().normalize(),u=this.e[g].clone().normalize(),w=this.e[h].clone().normalize(),v=q[l][k+1].clone(),y=q[l][k].clone(),z=q[l+1][k].clone(),x=q[l+1][k+1].clone();Math.abs(this.e[e].y)===a?(v.x=(v.x+y.x)/2,this.j.push(new d.P(e,g,h,[r,u,w])),this.D[0].push([v,z,x])):Math.abs(this.e[g].y)===a?(z.x=(z.x+x.x)/2,this.j.push(new d.P(e,f,g,[r,s,u])),this.D[0].push([v,y,z])):(this.j.push(new d.P(e,f,h,[r,s,w])),
this.D[0].push([v,y,x]),this.j.push(new d.P(f,g,h,[s.clone(),u,w.clone()])),this.D[0].push([y.clone(),z,x.clone()]))}this.kb();this.Ra=new d.$b(new d.b,a)};d.Lg.prototype=Object.create(d.u.prototype);d.qn=function(a,b){b=b||{};var c=d.wb.Do(a,b);b.Nk=void 0!==b.height?b.height:50;void 0===b.Ci&&(b.Ci=10);void 0===b.Bi&&(b.Bi=8);void 0===b.Ai&&(b.Ai=!1);d.qb.call(this,c,b)};d.qn.prototype=Object.create(d.qb.prototype);
d.ok=function(a,b,c,e,f){d.u.call(this);a=a||100;b=b||40;c=c||8;e=e||6;f=f||2*Math.PI;for(var g=new d.b,h=[],k=[],l=0;l<=c;l++)for(var n=0;n<=e;n++){var q=n/e*f,r=l/c*Math.PI*2;g.x=a*Math.cos(q);g.y=a*Math.sin(q);var s=new d.b;s.x=(a+b*Math.cos(r))*Math.cos(q);s.y=(a+b*Math.cos(r))*Math.sin(q);s.z=b*Math.sin(r);this.e.push(s);h.push(new d.g(n/e,l/c));k.push(s.clone().sub(g).normalize())}for(l=1;l<=c;l++)for(n=1;n<=e;n++)a=(e+1)*l+n-1,b=(e+1)*(l-1)+n-1,f=(e+1)*(l-1)+n,g=(e+1)*l+n,q=new d.P(a,b,g,[k[a].clone(),
k[b].clone(),k[g].clone()]),this.j.push(q),this.D[0].push([h[a].clone(),h[b].clone(),h[g].clone()]),q=new d.P(b,f,g,[k[b].clone(),k[f].clone(),k[g].clone()]),this.j.push(q),this.D[0].push([h[b].clone(),h[f].clone(),h[g].clone()]);this.kb()};d.ok.prototype=Object.create(d.u.prototype);
d.pk=function(a,b,c,e,f,g,h){function k(a,b,c,e,f){b=b/c*a;c=Math.cos(b);return new d.b(e*(2+c)*.5*Math.cos(a),e*(2+c)*Math.sin(a)*.5,f*e*Math.sin(b)*.5)}d.u.call(this);a=a||100;b=b||40;c=c||64;e=e||8;f=f||2;g=g||3;h=h||1;for(var l=Array(c),n=new d.b,q=new d.b,r=new d.b,s=0;s<c;++s){l[s]=Array(e);var u=s/c*2*f*Math.PI,w=k(u,g,f,a,h),u=k(u+.01,g,f,a,h);n.ca(u,w);q.yc(u,w);Ib(r,n,q);Ib(q,r,n);r.normalize();q.normalize();for(u=0;u<e;++u){var v=u/e*2*Math.PI,y=-b*Math.cos(v),v=b*Math.sin(v),z=new d.b;
z.x=w.x+y*q.x+v*r.x;z.y=w.y+y*q.y+v*r.y;z.z=w.z+y*q.z+v*r.z;l[s][u]=this.e.push(z)-1}}for(s=0;s<c;++s)for(u=0;u<e;++u)b=(s+1)%c,f=(u+1)%e,a=l[b][u],b=l[b][f],f=l[s][f],g=new d.g(s/c,u/e),h=new d.g((s+1)/c,u/e),n=new d.g((s+1)/c,(u+1)/e),q=new d.g(s/c,(u+1)/e),this.j.push(new d.P(l[s][u],a,f)),this.D[0].push([g,h,q]),this.j.push(new d.P(a,b,f)),this.D[0].push([h.clone(),n,q.clone()]);this.kb();this.Gf()};d.pk.prototype=Object.create(d.u.prototype);
d.Mg=function(a,b,c,e,f){d.u.call(this);b=b||64;c=c||1;e=e||8;f=f||!1;var g=[],h,k,l=b+1,n,q,r,s,u=new d.b,w,v,y;w=new d.Mg.Mj(a,b,f);v=w.cg;y=w.$g;this.am=w.am;this.cg=v;this.$g=y;for(w=0;w<l;w++)for(g[w]=[],n=w/(l-1),s=a.Rf(n),h=v[w],k=y[w],n=0;n<e;n++)q=n/e*2*Math.PI,r=-c*Math.cos(q),q=c*Math.sin(q),u.c(s),u.x+=r*h.x+q*k.x,u.y+=r*h.y+q*k.y,u.z+=r*h.z+q*k.z,g[w][n]=this.e.push(new d.b(u.x,u.y,u.z))-1;for(w=0;w<b;w++)for(n=0;n<e;n++)l=f?(w+1)%b:w+1,u=(n+1)%e,a=g[w][n],c=g[l][n],l=g[l][u],u=g[w][u],
v=new d.g(w/b,n/e),y=new d.g((w+1)/b,n/e),h=new d.g((w+1)/b,(n+1)/e),k=new d.g(w/b,(n+1)/e),this.j.push(new d.P(a,c,u)),this.D[0].push([v,y,k]),this.j.push(new d.P(c,l,u)),this.D[0].push([y.clone(),h,k.clone()]);this.kb();this.Gf()};d.Mg.prototype=Object.create(d.u.prototype);
d.Mg.Mj=function(a,b,c){var e=new d.b,f=[],g=[],h=[],k=new d.b,l=new d.S;b+=1;var n,q,r,s;this.am=f;this.cg=g;this.$g=h;for(n=0;n<b;n++)s=n/(b-1),q=n,r=a,s=gd(r,s),r=r.Tf(s),f[q]=r,f[n].normalize();g[0]=new d.b;h[0]=new d.b;a=Number.MAX_VALUE;n=Math.abs(f[0].x);q=Math.abs(f[0].y);r=Math.abs(f[0].z);n<=a&&(a=n,e.set(1,0,0));q<=a&&(a=q,e.set(0,1,0));r<=a&&e.set(0,0,1);Ib(k,f[0],e).normalize();Ib(g[0],f[0],k);Ib(h[0],f[0],g[0]);for(n=1;n<b;n++)g[n]=g[n-1].clone(),h[n]=h[n-1].clone(),Ib(k,f[n-1],f[n]),
1E-4<k.length()&&(k.normalize(),e=Math.acos(d.Math.zc(f[n-1].pa(f[n]),-1,1)),g[n].Q(rc(l,k,e))),Ib(h[n],f[n],g[n]);if(c)for(e=Math.acos(d.Math.zc(g[0].pa(g[b-1]),-1,1)),e/=b-1,0<f[0].pa(Ib(k,g[0],g[b-1]))&&(e=-e),n=1;n<b;n++)g[n].Q(rc(l,f[n],e*n)),Ib(h[n],f[n],g[n])};
d.Hg=function(a,b,c,e){function f(a){var b=a.normalize().clone();b.index=l.e.push(b)-1;b.pb=new d.g(Math.atan2(a.z,-a.x)/2/Math.PI+.5,1-(Math.atan2(-a.y,Math.sqrt(a.x*a.x+a.z*a.z))/Math.PI+.5));return b}function g(a,b,c){var e=new d.P(a.index,b.index,c.index,[a.clone(),b.clone(),c.clone()]);l.j.push(e);y.c(a).add(b).add(c).ud(3);e=Math.atan2(y.z,-y.x);l.D[0].push([k(a.pb,a,e),k(b.pb,b,e),k(c.pb,c,e)])}function h(a,b){for(var c=Math.pow(2,b),e=f(l.e[a.N]),h=f(l.e[a.i]),k=f(l.e[a.O]),n=[],q=0;q<=c;q++){n[q]=
[];for(var r=f(e.clone().Ic(k,q/c)),u=f(h.clone().Ic(k,q/c)),s=c-q,v=0;v<=s;v++)n[q][v]=0==v&&q==c?r:f(r.clone().Ic(u,v/s))}for(q=0;q<c;q++)for(v=0;v<2*(c-q)-1;v++)e=Math.floor(v/2),0==v%2?g(n[q][e+1],n[q+1][e],n[q][e]):g(n[q][e+1],n[q+1][e+1],n[q+1][e])}function k(a,b,c){0>c&&1===a.x&&(a=new d.g(a.x-1,a.y));0===b.x&&0===b.z&&(a=new d.g(c/2/Math.PI+.5,a.y));return a.clone()}d.u.call(this);c=c||1;e=e||0;for(var l=this,n=0,q=a.length;n<q;n+=3)f(new d.b(a[n],a[n+1],a[n+2]));a=this.e;for(var r=[],s=n=
0,q=b.length;n<q;n+=3,s++){var u=a[b[n]],w=a[b[n+1]],v=a[b[n+2]];r[s]=new d.P(u.index,w.index,v.index,[u.clone(),w.clone(),v.clone()])}for(var y=new d.b,n=0,q=r.length;n<q;n++)h(r[n],e);n=0;for(q=this.D[0].length;n<q;n++)b=this.D[0][n],e=b[0].x,a=b[1].x,r=b[2].x,s=Math.max(e,Math.max(a,r)),u=Math.min(e,Math.min(a,r)),.9<s&&.1>u&&(.2>e&&(b[0].x+=1),.2>a&&(b[1].x+=1),.2>r&&(b[2].x+=1));n=0;for(q=this.e.length;n<q;n++)this.e[n].G(c);$c(this);this.kb();this.Ra=new d.$b(new d.b,c)};d.Hg.prototype=Object.create(d.u.prototype);
d.Qj=function(a,b){var c=(1+Math.sqrt(5))/2;d.Hg.call(this,[-1,c,0,1,c,0,-1,-c,0,1,-c,0,0,-1,c,0,1,c,0,-1,-c,0,1,-c,c,0,-1,c,0,1,-c,0,-1,-c,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],a,b)};d.Qj.prototype=Object.create(d.u.prototype);d.Um=function(a,b){d.Hg.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],a,b)};d.Um.prototype=Object.create(d.u.prototype);
d.pn=function(a,b){d.Hg.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],a,b)};d.pn.prototype=Object.create(d.u.prototype);
d.Zm=function(a,b,c){d.u.call(this);var e=this.e,f=this.j,g=this.D[0],h,k,l,n,q=b+1;for(h=0;h<=c;h++)for(n=h/c,k=0;k<=b;k++)l=k/b,l=a(l,n),e.push(l);var r,s,u,w;for(h=0;h<c;h++)for(k=0;k<b;k++)a=h*q+k,e=h*q+k+1,n=(h+1)*q+k+1,l=(h+1)*q+k,r=new d.g(k/b,h/c),s=new d.g((k+1)/b,h/c),u=new d.g((k+1)/b,(h+1)/c),w=new d.g(k/b,(h+1)/c),f.push(new d.P(a,e,l)),g.push([r,s,w]),f.push(new d.P(e,n,l)),g.push([s.clone(),u,w.clone()]);this.kb();this.Gf()};d.Zm.prototype=Object.create(d.u.prototype);
d.om=function(a){a=a||1;var b=new Float32Array([0,0,0,a,0,0,0,0,0,0,a,0,0,0,0,0,0,a]),c=new Float32Array([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1]);a=new d.wa;Zc(a,"position",new d.ab(b,3));Zc(a,"color",new d.ab(c,3));b=new d.Ba({s:d.Rd});d.U.call(this,a,b,d.Mb)};d.om.prototype=Object.create(d.U.prototype);
d.Rh=function(){var a=new d.u;a.e.push(new d.b(0,0,0),new d.b(0,1,0));var b=new d.Cg(0,.5,1,5,1);b.Tc(tc(new d.S,0,-.5,0));return function(c,e,f,g,h,k){d.A.call(this);void 0===g&&(g=16776960);void 0===f&&(f=1);void 0===h&&(h=.2*f);void 0===k&&(k=.2*h);this.position.c(e);this.nh=new d.U(a,new d.Ba({color:g}));this.nh.oa=!1;this.add(this.nh);this.Bc=new d.Y(b,new d.xb({color:g}));this.Bc.oa=!1;this.add(this.Bc);this.Ap(c);this.Ah(f,h,k)}}();d.Rh.prototype=Object.create(d.A.prototype);
d.Rh.prototype.Ap=function(){var a=new d.b,b;return function(c){if(.99999<c.y)this.cb.set(0,0,0,1);else if(-.99999>c.y)this.cb.set(1,0,0,0);else{a.set(c.z,0,-c.x).normalize();b=Math.acos(c.y);c=this.cb;var e=b/2,f=Math.sin(e);c.n=a.x*f;c.o=a.y*f;c.p=a.z*f;c.K=Math.cos(e);c.ua()}}}();d.Rh.prototype.Ah=function(a,b,c){void 0===b&&(b=.2*a);void 0===c&&(c=.2*b);this.nh.scale.set(1,a,1);this.nh.Dd();this.Bc.scale.set(c,b,c);this.Bc.position.y=a;this.Bc.Dd()};
d.Ej=function(a){var b=new d.wa;Zc(b,"position",new d.ab(new Float32Array(72),3));d.U.call(this,b,new d.Ba({color:16776960}),d.Mb);void 0!==a&&this.update(a)};d.Ej.prototype=Object.create(d.U.prototype);
d.Ej.prototype.update=function(a){var b=a.k;null===b.Qa&&b.Ff();var c=b.Qa.min,b=b.Qa.max,e=this.k.attributes.position.d;e[0]=b.x;e[1]=b.y;e[2]=b.z;e[3]=c.x;e[4]=b.y;e[5]=b.z;e[6]=c.x;e[7]=b.y;e[8]=b.z;e[9]=c.x;e[10]=c.y;e[11]=b.z;e[12]=c.x;e[13]=c.y;e[14]=b.z;e[15]=b.x;e[16]=c.y;e[17]=b.z;e[18]=b.x;e[19]=c.y;e[20]=b.z;e[21]=b.x;e[22]=b.y;e[23]=b.z;e[24]=b.x;e[25]=b.y;e[26]=c.z;e[27]=c.x;e[28]=b.y;e[29]=c.z;e[30]=c.x;e[31]=b.y;e[32]=c.z;e[33]=c.x;e[34]=c.y;e[35]=c.z;e[36]=c.x;e[37]=c.y;e[38]=c.z;
e[39]=b.x;e[40]=c.y;e[41]=c.z;e[42]=b.x;e[43]=c.y;e[44]=c.z;e[45]=b.x;e[46]=b.y;e[47]=c.z;e[48]=b.x;e[49]=b.y;e[50]=b.z;e[51]=b.x;e[52]=b.y;e[53]=c.z;e[54]=c.x;e[55]=b.y;e[56]=b.z;e[57]=c.x;e[58]=b.y;e[59]=c.z;e[60]=c.x;e[61]=c.y;e[62]=b.z;e[63]=c.x;e[64]=c.y;e[65]=c.z;e[66]=b.x;e[67]=c.y;e[68]=b.z;e[69]=b.x;e[70]=c.y;e[71]=c.z;this.k.attributes.position.H=!0;this.k.Ne();this.oa=!1;this.m=a.m};
d.Dj=function(a,b){var c=void 0!==b?b:8947848;this.object=a;this.Ei=new d.Wb;d.Y.call(this,new d.yg(1,1,1),new d.xb({color:c,V:!0}))};d.Dj.prototype=Object.create(d.Y.prototype);d.Dj.prototype.update=function(){this.Ei.Bp(this.object);this.Ei.size(this.scale);this.Ei.ia(this.position)};
d.Uh=function(a){function b(a,b,e){c(a,e);c(b,e)}function c(a,b){e.e.push(new d.b);e.ka.push(new d.q(b));void 0===g[a]&&(g[a]=[]);g[a].push(e.e.length-1)}var e=new d.u,f=new d.Ba({color:16777215,s:d.nf}),g={};b("n1","n2",16755200);b("n2","n4",16755200);b("n4","n3",16755200);b("n3","n1",16755200);b("f1","f2",16755200);b("f2","f4",16755200);b("f4","f3",16755200);b("f3","f1",16755200);b("n1","f1",16755200);b("n2","f2",16755200);b("n3","f3",16755200);b("n4","f4",16755200);b("p","n1",16711680);b("p","n2",
16711680);b("p","n3",16711680);b("p","n4",16711680);b("u1","u2",43775);b("u2","u3",43775);b("u3","u1",43775);b("c","t",16777215);b("p","c",3355443);b("cn1","cn2",3355443);b("cn3","cn4",3355443);b("cf1","cf2",3355443);b("cf3","cf4",3355443);d.U.call(this,e,f,d.Mb);this.be=a;this.m=a.m;this.oa=!1;this.sp=g;this.update()};d.Uh.prototype=Object.create(d.U.prototype);
d.Uh.prototype.update=function(){var a=new d.b,b=new d.hb,c=new d.hi;return function(){function e(e,h,k,l){a.set(h,k,l);c.fm(a,b);e=f.sp[e];if(void 0!==e)for(h=0,k=e.length;h<k;h++)f.k.e[e[h]].c(a)}var f=this;b.za.c(this.be.za);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",.7,1.1,-1);e("u2",-.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",
-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);this.k.Oa=!0}}();d.Jj=function(a,b){d.A.call(this);this.W=a;this.W.ra();this.m=a.m;this.oa=!1;b=b||1;var c=new d.u;c.e.push(new d.b(-b,b,0),new d.b(b,b,0),new d.b(b,-b,0),new d.b(-b,-b,0),new d.b(-b,b,0));var e=new d.Ba({L:!1});e.color.c(this.W.color).G(this.W.ja);this.mh=new d.U(c,e);this.add(this.mh);c=new d.u;c.e.push(new d.b,new d.b);e=new d.Ba({L:!1});e.color.c(this.W.color).G(this.W.ja);this.Lh=new d.U(c,e);this.add(this.Lh);this.update()};
d.Jj.prototype=Object.create(d.A.prototype);d.Jj.prototype.update=function(){var a=new d.b,b=new d.b,c=new d.b;return function(){Cb(a,this.W.m);Cb(b,this.W.target.m);c.ca(b,a);this.mh.gb(c);this.mh.r.color.c(this.W.color).G(this.W.ja);this.Lh.k.e[1].c(c);this.Lh.k.Oa=!0;this.Lh.r.color.c(this.mh.r.color)}}();
d.Cm=function(a,b){function c(a,b){return a-b}var e=void 0!==b?b:16777215,f=[0,0],g={},h=["a","b","c"],k=new d.wa,l=a.k.clone();$c(l);l.kb();for(var n=l.e,l=l.j,q=0,r=0,s=l.length;r<s;r++)for(var u=l[r],w=0;3>w;w++){f[0]=u[h[w]];f[1]=u[h[(w+1)%3]];f.sort(c);var v=f.toString();void 0===g[v]?(g[v]={aq:f[0],bq:f[1],Bo:r,Pi:void 0},q++):g[v].Pi=r}Zc(k,"position",new d.Dm(6*q));f=k.attributes.position.d;h=0;for(v in g)if(q=g[v],void 0===q.Pi||.9999>l[q.Bo].F.pa(l[q.Pi].F))r=n[q.aq],f[h++]=r.x,f[h++]=r.y,
f[h++]=r.z,r=n[q.bq],f[h++]=r.x,f[h++]=r.y,f[h++]=r.z;d.U.call(this,k,new d.Ba({color:e}),d.Mb);this.oa=!1;this.m=a.m};d.Cm.prototype=Object.create(d.U.prototype);d.Lj=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;a=void 0!==c?c:16776960;e=void 0!==e?e:1;b=new d.u;c=0;for(var f=this.object.k.j.length;c<f;c++)b.e.push(new d.b,new d.b);d.U.call(this,b,new d.Ba({color:a,nb:e}),d.Mb);this.oa=!1;this.je=new d.Nb;this.update()};d.Lj.prototype=Object.create(d.U.prototype);
d.Lj.prototype.update=function(){var a=this.k.e,b=this.object,c=b.k.e,e=b.k.j,f=b.m;b.ra(!0);bc(this.je,f);for(var g=b=0,h=e.length;b<h;b++,g+=2){var k=e[b];a[g].c(c[k.N]).add(c[k.i]).add(c[k.O]).ud(3).Q(f);Xb(a[g+1].c(k.F),this.je).normalize().G(this.size).add(a[g])}this.k.Oa=!0;return this};
d.Em=function(a,b){var c=new d.u,e=new d.Ba({s:d.Rd});this.lo=new d.q(4473924);this.mo=new d.q(8947848);for(var f=-a;f<=a;f+=b){c.e.push(new d.b(-a,0,f),new d.b(a,0,f),new d.b(f,0,-a),new d.b(f,0,a));var g=0===f?this.lo:this.mo;c.ka.push(g,g,g,g)}d.U.call(this,c,e,d.Mb)};d.Em.prototype=Object.create(d.U.prototype);
d.Pj=function(a,b){d.A.call(this);this.W=a;this.W.ra();this.m=a.m;this.oa=!1;this.ka=[new d.q,new d.q];var c=new d.Lg(b,4,2);c.Tc(sc());for(var e=0;8>e;e++)c.j[e].color=this.ka[4>e?0:1];e=new d.xb({s:d.nf,V:!0});this.Yi=new d.Y(c,e);this.add(this.Yi);this.update()};d.Pj.prototype=Object.create(d.A.prototype);d.Pj.prototype.update=function(){var a=new d.b;return function(){this.ka[0].c(this.W.color).G(this.W.ja);this.ka[1].c(this.W.Uf).G(this.W.ja);this.Yi.gb(Cb(a,this.W.m).he());this.Yi.k.Eb=!0}}();
d.ck=function(a,b){this.W=a;this.W.ra();var c=new d.Lg(b,4,2),e=new d.xb({V:!0,L:!1});e.color.c(this.W.color).G(this.W.ja);d.Y.call(this,c,e);this.m=this.W.m;this.oa=!1};d.ck.prototype=Object.create(d.Y.prototype);d.ck.prototype.update=function(){this.r.color.c(this.W.color).G(this.W.ja)};
d.kk=function(a){this.Z=td(this,a);for(var b=new d.u,c=0;c<this.Z.length;c++)this.Z[c].parent instanceof d.Vb&&(b.e.push(new d.b),b.e.push(new d.b),b.ka.push(new d.q(0,0,1)),b.ka.push(new d.q(0,1,0)));c=new d.Ba({s:d.Rd,Dc:!1,Ec:!1,eb:!0});d.U.call(this,b,c,d.Mb);this.root=a;this.m=a.m;this.oa=!1;this.update()};d.kk.prototype=Object.create(d.U.prototype);function td(a,b){var c=[];b instanceof d.Vb&&c.push(b);for(var e=0;e<b.children.length;e++)c.push.apply(c,td(a,b.children[e]));return c}
d.kk.prototype.update=function(){for(var a=this.k,b=(new d.S).Gb(this.root.m),c=new d.S,e=0,f=0;f<this.Z.length;f++){var g=this.Z[f];g.parent instanceof d.Vb&&(cc(c,b,g.m),Cb(a.e[e],c),cc(c,b,g.parent.m),Cb(a.e[e+1],c),e+=2)}a.Oa=!0;a.Ne()};d.lk=function(a){d.A.call(this);this.W=a;this.W.ra();this.m=a.m;this.oa=!1;a=new d.Cg(0,1,1,8,1,!0);a.Tc(tc(new d.S,0,-.5,0));a.Tc(sc());var b=new d.xb({V:!0,L:!1});this.Bc=new d.Y(a,b);this.add(this.Bc);this.update()};d.lk.prototype=Object.create(d.A.prototype);
d.lk.prototype.update=function(){var a=new d.b,b=new d.b;return function(){var c=this.W.Da?this.W.Da:1E4,e=c*Math.tan(this.W.xf);this.Bc.scale.set(e,e,c);Cb(a,this.W.m);Cb(b,this.W.target.m);this.Bc.gb(b.sub(a));this.Bc.r.color.c(this.W.color).G(this.W.ja)}}();
d.rk=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:16711680;e=void 0!==e?e:1;c=new d.u;a=a.k.j;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].na.length;h<k;h++)c.e.push(new d.b,new d.b);d.U.call(this,c,new d.Ba({color:b,nb:e}),d.Mb);this.oa=!1;this.je=new d.Nb;this.update()};d.rk.prototype=Object.create(d.U.prototype);
d.rk.prototype.update=function(){var a=new d.b;return function(){var b=["a","b","c","d"];this.object.ra(!0);bc(this.je,this.object.m);for(var c=this.k.e,e=this.object.k.e,f=this.object.k.j,g=this.object.m,h=0,k=0,l=f.length;k<l;k++)for(var n=f[k],q=0,r=n.na.length;q<r;q++){var s=n.na[q];c[h].c(e[n[b[q]]]).Q(g);Xb(a.c(s),this.je).normalize().G(this.size);a.add(c[h]);h+=1;c[h].c(a);h+=1}this.k.Oa=!0;return this}}();
d.sk=function(a,b,c,e){this.object=a;this.size=void 0!==b?b:1;b=void 0!==c?c:255;e=void 0!==e?e:1;c=new d.u;a=a.k.j;for(var f=0,g=a.length;f<g;f++)for(var h=0,k=a[f].Gd.length;h<k;h++)c.e.push(new d.b),c.e.push(new d.b);d.U.call(this,c,new d.Ba({color:b,nb:e}),d.Mb);this.oa=!1;this.update()};d.sk.prototype=Object.create(d.U.prototype);
d.sk.prototype.update=function(){var a=new d.b;return function(){var b=["a","b","c","d"];this.object.ra(!0);for(var c=this.k.e,e=this.object.k.e,f=this.object.k.j,g=this.object.m,h=0,k=0,l=f.length;k<l;k++)for(var n=f[k],q=0,r=n.Gd.length;q<r;q++){var s=n.Gd[q];c[h].c(e[n[b[q]]]).Q(g);var s=a.c(s),u=s.x,w=s.y,v=s.z,y=g.elements;s.x=y[0]*u+y[4]*w+y[8]*v;s.y=y[1]*u+y[5]*w+y[9]*v;s.z=y[2]*u+y[6]*w+y[10]*v;s.normalize();s.G(this.size);a.add(c[h]);h+=1;c[h].c(a);h+=1}this.k.Oa=!0;return this}}();
d.zn=function(a,b){function c(a,b){return a-b}var e=void 0!==b?b:16777215,f=[0,0],g={},h=["a","b","c"],k=new d.wa;if(a.k instanceof d.u){for(var l=a.k.e,n=a.k.j,q=0,r=new Uint32Array(6*n.length),s=0,u=n.length;s<u;s++)for(var w=n[s],v=0;3>v;v++){f[0]=w[h[v]];f[1]=w[h[(v+1)%3]];f.sort(c);var y=f.toString();void 0===g[y]&&(r[2*q]=f[0],r[2*q+1]=f[1],g[y]=!0,q++)}f=new Float32Array(6*q);s=0;for(u=q;s<u;s++)for(v=0;2>v;v++)q=l[r[2*s+v]],h=6*s+3*v,f[h+0]=q.x,f[h+1]=q.y,f[h+2]=q.z;Zc(k,"position",new d.ab(f,
3))}else if(a.k instanceof d.wa){if(void 0!==a.k.attributes.index){for(var l=a.k.attributes.position.d,u=a.k.attributes.index.d,n=a.k.Qb,q=0,r=new Uint32Array(2*u.length),w=0,z=n.length;w<z;++w)for(var v=n[w].start,y=n[w].count,h=n[w].index,s=v,x=v+y;s<x;s+=3)for(v=0;3>v;v++)f[0]=h+u[s+v],f[1]=h+u[s+(v+1)%3],f.sort(c),y=f.toString(),void 0===g[y]&&(r[2*q]=f[0],r[2*q+1]=f[1],g[y]=!0,q++);f=new Float32Array(6*q);s=0;for(u=q;s<u;s++)for(v=0;2>v;v++)h=6*s+3*v,q=3*r[2*s+v],f[h+0]=l[q],f[h+1]=l[q+1],f[h+
2]=l[q+2]}else for(l=a.k.attributes.position.d,q=l.length/3,r=q/3,f=new Float32Array(6*q),s=0,u=r;s<u;s++)for(v=0;3>v;v++)h=18*s+6*v,r=9*s+3*v,f[h+0]=l[r],f[h+1]=l[r+1],f[h+2]=l[r+2],q=9*s+(v+1)%3*3,f[h+3]=l[q],f[h+4]=l[q+1],f[h+5]=l[q+2];Zc(k,"position",new d.ab(f,3))}d.U.call(this,k,new d.Ba({color:e}),d.Mb);this.oa=!1;this.m=a.m};d.zn.prototype=Object.create(d.U.prototype);d.Zh=function(){d.A.call(this);this.t=function(){}};d.Zh.prototype=Object.create(d.A.prototype);
d.ai=function(a,b,c,e,f){d.A.call(this);this.Xf=[];this.l=new d.b;this.Uk=void 0;void 0!==a&&this.add(a,b,c,e,f)};d.ai.prototype=Object.create(d.A.prototype);d.ai.prototype.add=function(a,b,c,e,f,g){void 0===b&&(b=-1);void 0===c&&(c=0);void 0===g&&(g=1);void 0===f&&(f=new d.q(16777215));void 0===e&&(e=d.gi);c=Math.min(c,Math.max(0,c));this.Xf.push({Up:a,size:b,Da:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:g,color:f,Pa:e})};
function ud(a){var b,c=a.Xf.length,e,f=2*-a.l.x,g=2*-a.l.y;for(b=0;b<c;b++)e=a.Xf[b],e.x=a.l.x+f*e.Da,e.y=a.l.y+g*e.Da,e.dq=e.x*Math.PI*.25,e.rotation+=.25*(e.dq-e.rotation)}d.Vj=function(a,b){d.Y.call(this,a,b);this.Pk={};this.wi=[];var c=this.k.w.length,e=c-1,c=c/1,e={Rp:0,dr:e,length:e-0+1,or:c,duration:(e-0)/c,Xi:0,Hf:0,On:!1,time:0,direction:1,weight:1,Qe:!1,sh:!1};this.Pk.__default=e;this.wi.push(e);if(e=this.Pk.__default)e.weight=1};d.Vj.prototype=Object.create(d.Y.prototype);
d.Vj.prototype.update=function(a){for(var b=0,c=this.wi.length;b<c;b++){var e=this.wi[b];if(e.On){var f=e.duration/e.length;e.time+=e.direction*a;if(e.sh){if(e.time>e.duration||0>e.time)e.direction*=-1,e.time>e.duration&&(e.time=e.duration,e.Qe=!0),0>e.time&&(e.time=0,e.Qe=!1)}else e.time%=e.duration,0>e.time&&(e.time+=e.duration);var g=e.Rp+d.Math.zc(Math.floor(e.time/f),0,e.length-1),h=e.weight;g!==e.Hf&&(this.Wa[e.Xi]=0,this.Wa[e.Hf]=1*h,this.Wa[g]=0,e.Xi=e.Hf,e.Hf=g);f=e.time%f/f;e.Qe&&(f=1-f);
this.Wa[e.Hf]=f*h;this.Wa[e.Xi]=(1-f)*h}}};
d.Jm=function(){function a(a,b){var e=c.createProgram(),f=c.createShader(c.FRAGMENT_SHADER),g=c.createShader(c.VERTEX_SHADER),h="precision "+b+" float;\n";c.shaderSource(f,h+a.I);c.shaderSource(g,h+a.J);c.compileShader(f);c.compileShader(g);c.attachShader(e,f);c.attachShader(e,g);c.linkProgram(e);return e}var b=[],c,e,f,g,h,k,l,n,q,r,s,u,w;this.vd=function(b){c=b.td;e=b;f=b.Ti();g=new Float32Array(16);h=new Uint16Array(6);b=0;g[b++]=-1;g[b++]=-1;g[b++]=0;g[b++]=0;g[b++]=1;g[b++]=-1;g[b++]=1;g[b++]=
0;g[b++]=1;g[b++]=1;g[b++]=1;g[b++]=1;g[b++]=-1;g[b++]=1;g[b++]=0;g[b++]=1;b=0;h[b++]=0;h[b++]=1;h[b++]=2;h[b++]=0;h[b++]=2;h[b++]=3;k=c.createBuffer();l=c.createBuffer();c.bindBuffer(c.ARRAY_BUFFER,k);c.bufferData(c.ARRAY_BUFFER,g,c.STATIC_DRAW);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,l);c.bufferData(c.ELEMENT_ARRAY_BUFFER,h,c.STATIC_DRAW);n=c.createTexture();q=c.createTexture();c.bindTexture(c.TEXTURE_2D,n);c.texImage2D(c.TEXTURE_2D,0,c.RGB,16,16,0,c.RGB,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,
c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);c.bindTexture(c.TEXTURE_2D,q);c.texImage2D(c.TEXTURE_2D,0,c.RGBA,16,16,0,c.RGBA,c.UNSIGNED_BYTE,null);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE);c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.NEAREST);
c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.NEAREST);0>=c.getParameter(c.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(r=!1,s=a(d.ik.lensFlare,f)):(r=!0,s=a(d.ik.lensFlareVertexTexture,f));u={};w={};u.hm=c.getAttribLocation(s,"position");u.pb=c.getAttribLocation(s,"uv");w.lj=c.getUniformLocation(s,"renderType");w.map=c.getUniformLocation(s,"map");w.mp=c.getUniformLocation(s,"occlusionMap");w.opacity=c.getUniformLocation(s,"opacity");w.color=c.getUniformLocation(s,"color");w.scale=c.getUniformLocation(s,
"scale");w.rotation=c.getUniformLocation(s,"rotation");w.Sl=c.getUniformLocation(s,"screenPosition")};this.t=function(a,f,g,h){b.length=0;Nc(a,function(a){a instanceof d.ai&&b.push(a)});if(0!==b.length){a=new d.b;var C=h/g,E=.5*g,A=.5*h,H=16/h,B=new d.g(H*C,H),D=new d.b(1,1,0),F=new d.g(1,1),L=w,H=u;c.useProgram(s);c.enableVertexAttribArray(u.hm);c.enableVertexAttribArray(u.pb);c.uniform1i(L.mp,0);c.uniform1i(L.map,1);c.bindBuffer(c.ARRAY_BUFFER,k);c.vertexAttribPointer(H.hm,2,c.FLOAT,!1,16,0);c.vertexAttribPointer(H.pb,
2,c.FLOAT,!1,16,8);c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,l);c.disable(c.CULL_FACE);c.depthMask(!1);for(var M=0,ea=b.length;M<ea;M++){H=16/h;B.set(H*C,H);var T=b[M];a.set(T.m.elements[12],T.m.elements[13],T.m.elements[14]);a.Q(f.Ea);Wb(a,f.za);D.c(a);F.x=D.x*E+E;F.y=D.y*A+A;if(r||0<F.x&&F.x<g&&0<F.y&&F.y<h){c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,n);c.copyTexImage2D(c.TEXTURE_2D,0,c.RGB,F.x-8,F.y-8,16,16,0);c.uniform1i(L.lj,0);c.uniform2f(L.scale,B.x,B.y);c.uniform3f(L.Sl,D.x,D.y,D.z);
c.disable(c.BLEND);c.enable(c.DEPTH_TEST);c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0);c.activeTexture(c.TEXTURE0);c.bindTexture(c.TEXTURE_2D,q);c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,F.x-8,F.y-8,16,16,0);c.uniform1i(L.lj,1);c.disable(c.DEPTH_TEST);c.activeTexture(c.TEXTURE1);c.bindTexture(c.TEXTURE_2D,n);c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0);T.l.c(D);T.Uk?T.Uk(T):ud(T);c.uniform1i(L.lj,2);c.enable(c.BLEND);for(var Q=0,P=T.Xf.length;Q<P;Q++){var G=T.Xf[Q];.001<G.opacity&&.001<G.scale&&
(D.x=G.x,D.y=G.y,D.z=G.z,H=G.size*G.scale/h,B.x=H*C,B.y=H,c.uniform3f(L.Sl,D.x,D.y,D.z),c.uniform2f(L.scale,B.x,B.y),c.uniform1f(L.rotation,G.rotation),c.uniform1f(L.opacity,G.opacity),c.uniform3f(L.color,G.color.C,G.color.B,G.color.i),e.ef(G.Pa,G.blendEquation,G.ae,G.$d),e.ff(G.Up,1),c.drawElements(c.TRIANGLES,6,c.UNSIGNED_SHORT,0))}}}c.enable(c.CULL_FACE);c.enable(c.DEPTH_TEST);c.depthMask(!0)}}};
d.ki=function(){function a(b,c,e){if(c.visible){var f=b.wc[c.id];if(f&&c.tb&&(!1===c.Ve||!0===k.lh(c)))for(var g=0,h=f.length;g<h;g++){var l=f[g];cc(c.xc,e.Ea,c.m);s.push(l)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],e)}}var b,c,e,f,g,h,k=new d.we,l=new d.S,n=new d.b,q=new d.b,r=new d.b,s=[];this.vd=function(a){b=a.td;c=a;a=d.Kg.depthRGBA;var k=d.ac.clone(a.M);e=new d.Fa({I:a.I,J:a.J,M:k});f=new d.Fa({I:a.I,J:a.J,M:k,w:!0});g=new d.Fa({I:a.I,J:a.J,M:k,va:!0});h=new d.Fa({I:a.I,J:a.J,M:k,
w:!0,va:!0});e.pd=!0;f.pd=!0;g.pd=!0;h.pd=!0};this.t=function(a,b){c.pe&&c.Dp&&this.update(a,b)};this.update=function(u,w){var v,y,z,x,C,E,A,H,B=[];x=0;b.clearColor(1,1,1,1);b.disable(b.BLEND);b.enable(b.CULL_FACE);b.frontFace(b.CCW);c.Ul===d.Vh?b.cullFace(b.FRONT):b.cullFace(b.BACK);c.ne(!0);v=0;for(y=u.Bb.length;v<y;v++)if(z=u.Bb[v],z.tb)if(z instanceof d.vb&&z.sg)for(C=0;C<z.rj;C++){var D;if(z.oe[C])D=z.oe[C];else{A=z;var F=C;D=new d.vb;D.Wo=!0;D.Bd=!0;D.tb=!0;D.bd=A.bd;D.ad=A.ad;D.pg=A.pg;D.qg=
A.qg;D.og=A.og;D.rg=A.rg;D.Rb=A.Rb;D.kc=A.kc;D.Zc=A.Ch[F];D.dd=A.uj[F];D.cd=A.sj[F];D.Gl=[];D.dj=[];H=D.Gl;E=D.dj;for(var L=0;8>L;L++)H[L]=new d.b,E[L]=new d.b;H=A.Eh[F];A=A.Dh[F];E[0].set(-1,-1,H);E[1].set(1,-1,H);E[2].set(-1,1,H);E[3].set(1,1,H);E[4].set(-1,-1,A);E[5].set(1,-1,A);E[6].set(-1,1,A);E[7].set(1,1,A);D.np=w;E=new d.Yh;E.position.c(z.tj);E.add(D);E.add(D.target);w.add(E);z.oe[C]=D;console.log("Created virtualLight",D)}F=z;H=C;A=F.oe[H];A.position.c(F.position);A.target.position.c(F.target.position);
A.gb(A.target);A.Rb=F.Rb;A.kc=F.kc;A.Zc=F.Ch[H];E=F.Eh[H];F=F.Dh[H];A=A.dj;A[0].z=E;A[1].z=E;A[2].z=E;A[3].z=E;A[4].z=F;A[5].z=F;A[6].z=F;A[7].z=F;B[x]=D;x++}else B[x]=z,x++;v=0;for(y=B.length;v<y;v++){z=B[v];z.gf||(C=d.Jd,c.tg===d.ak&&(C=d.Be),z.gf=new d.Ee(z.dd,z.cd,{ub:C,Pb:C,format:d.Nd}),z.Hh=new d.g(z.dd,z.cd),z.hf=new d.S);if(!z.$c){if(z instanceof d.Oc)z.$c=new d.zb(z.qj,z.dd/z.cd,z.bd,z.ad);else if(z instanceof d.vb)z.$c=new d.Ce(z.pg,z.qg,z.rg,z.og,z.bd,z.ad);else{console.error("Unsupported light type for shadow");
continue}u.add(z.$c);!0===u.Le&&u.ra()}z.Rb&&!z.Ef&&(z.Ef=new d.Uh(z.$c),z.$c.add(z.Ef));if(z.Wo&&D.np==w){C=w;x=z.$c;E=z.dj;A=z.Gl;n.set(Infinity,Infinity,Infinity);q.set(-Infinity,-Infinity,-Infinity);for(F=0;8>F;F++)H=A[F],H.c(E[F]),d.ki.Fn.fm(H,C),H.Q(x.Ea),H.x<n.x&&(n.x=H.x),H.x>q.x&&(q.x=H.x),H.y<n.y&&(n.y=H.y),H.y>q.y&&(q.y=H.y),H.z<n.z&&(n.z=H.z),H.z>q.z&&(q.z=H.z);x.left=n.x;x.right=q.x;x.top=q.y;x.bottom=n.y;x.Mh()}x=z.gf;E=z.hf;C=z.$c;Cb(C.position,z.m);Cb(r,z.target.m);C.gb(r);C.ra();
C.Ea.Gb(C.m);z.Ef&&(z.Ef.visible=z.Rb);z.Rb&&z.Ef.update();E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1);E.multiply(C.za);E.multiply(C.Ea);cc(l,C.za,C.Ea);uc(k,l);c.nj(x);c.clear();s.length=0;a(u,u,C);z=0;for(x=s.length;z<x;z++)A=s[z],E=A.object,A=A.buffer,F=E.r instanceof d.jd?E.r.Va[0]:E.r,H=void 0!==E.k.w&&0<E.k.w.length&&F.w,L=E instanceof d.vc&&F.va,H=E.ah?E.ah:L?H?h:g:H?f:e,c.Bh(F),A instanceof d.wa?c.jj(C,u.Bb,null,H,A,E):c.ij(C,u.Bb,null,H,A,E);F=u.nd;z=0;for(x=F.length;z<x;z++)A=F[z],E=A.object,
E.visible&&E.tb&&(cc(E.xc,C.Ea,E.m),c.kj(C,u.Bb,null,e,E))}v=c.Si();b.clearColor(v.C,v.B,v.i,0);b.enable(b.BLEND);c.Ul===d.Vh&&b.cullFace(b.BACK)}};d.ki.Fn=new d.hi;
d.ln=function(){var a,b,c,e,f,g,h,k,l,n,q,r,s,u,w,v,y;function z(a,b){return a.z!==b.z?b.z-a.z:b.id-a.id}var x,C,E,A=[],H,B,D,F,L;this.vd=function(z){x=z.td;C=z;H=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]);B=new Uint16Array([0,1,2,0,2,3]);D=x.createBuffer();F=x.createBuffer();x.bindBuffer(x.ARRAY_BUFFER,D);x.bufferData(x.ARRAY_BUFFER,H,x.STATIC_DRAW);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,F);x.bufferData(x.ELEMENT_ARRAY_BUFFER,B,x.STATIC_DRAW);z=x.createProgram();var A=x.createShader(x.VERTEX_SHADER),
T=x.createShader(x.FRAGMENT_SHADER);x.shaderSource(A,["precision "+C.Ti()+" float;","uniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position * scale;\nvec2 rotatedPosition;\nrotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\nrotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\nvec4 finalPosition;\nfinalPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition;\nfinalPosition = projectionMatrix * finalPosition;\ngl_Position = finalPosition;\n}"].join("\n"));
x.shaderSource(T,["precision "+C.Ti()+" float;","uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"].join("\n"));
x.compileShader(A);x.compileShader(T);x.attachShader(z,A);x.attachShader(z,T);x.linkProgram(z);L=z;v=x.getAttribLocation(L,"position");y=x.getAttribLocation(L,"uv");a=x.getUniformLocation(L,"uvOffset");b=x.getUniformLocation(L,"uvScale");c=x.getUniformLocation(L,"rotation");e=x.getUniformLocation(L,"scale");f=x.getUniformLocation(L,"color");g=x.getUniformLocation(L,"map");h=x.getUniformLocation(L,"opacity");k=x.getUniformLocation(L,"modelViewMatrix");l=x.getUniformLocation(L,"projectionMatrix");n=
x.getUniformLocation(L,"fogType");q=x.getUniformLocation(L,"fogDensity");r=x.getUniformLocation(L,"fogNear");s=x.getUniformLocation(L,"fogFar");u=x.getUniformLocation(L,"fogColor");w=x.getUniformLocation(L,"alphaTest");z=document.createElement("canvas");z.width=8;z.height=8;A=z.getContext("2d");A.fillStyle="white";A.fillRect(0,0,8,8);E=new d.xa(z);E.H=!0};this.t=function(B,H){A.length=0;Nc(B,function(a){a instanceof d.Pc&&A.push(a)});if(0!==A.length){x.useProgram(L);x.enableVertexAttribArray(v);x.enableVertexAttribArray(y);
x.disable(x.CULL_FACE);x.enable(x.BLEND);x.bindBuffer(x.ARRAY_BUFFER,D);x.vertexAttribPointer(v,2,x.FLOAT,!1,16,0);x.vertexAttribPointer(y,2,x.FLOAT,!1,16,8);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,F);x.uniformMatrix4fv(l,!1,H.za.elements);x.activeTexture(x.TEXTURE0);x.uniform1i(g,0);var T=0,Q=0,P=B.L;P?(x.uniform3f(u,P.color.C,P.color.B,P.color.i),P instanceof d.Dg?(x.uniform1f(r,P.Xa),x.uniform1f(s,P.Ta),x.uniform1i(n,1),Q=T=1):P instanceof d.of&&(x.uniform1f(q,P.Ki),x.uniform1i(n,2),Q=T=2)):(x.uniform1i(n,
0),Q=T=0);for(var P=0,G=A.length;P<G;P++){var K=A[P],J=K.r;cc(K.xc,H.Ea,K.m);K.z=-K.xc.elements[14]}A.sort(z);for(var ba=[],P=0,G=A.length;P<G;P++)K=A[P],J=K.r,x.uniform1f(w,J.Wd),x.uniformMatrix4fv(k,!1,K.xc.elements),ba[0]=K.scale.x,ba[1]=K.scale.y,K=0,B.L&&J.L&&(K=Q),T!==K&&(x.uniform1i(n,K),T=K),null!==J.map?(x.uniform2f(a,J.map.offset.x,J.map.offset.y),x.uniform2f(b,J.map.repeat.x,J.map.repeat.y)):(x.uniform2f(a,0,0),x.uniform2f(b,1,1)),x.uniform1f(h,J.opacity),x.uniform3f(f,J.color.C,J.color.B,
J.color.i),x.uniform1f(c,J.rotation),x.uniform2fv(e,ba),C.ef(J.Pa,J.blendEquation,J.ae,J.$d),C.ne(J.Dc),C.mg(J.Ec),J.map&&J.map.$&&J.map.$.width?C.ff(J.map,0):C.ff(E,0),x.drawElements(x.TRIANGLES,6,x.UNSIGNED_SHORT,0);x.enable(x.CULL_FACE)}}};
d.qq=function(){function a(b,c,e){if(c.visible){var f=b.wc[c.id];if(f&&(!1===c.Ve||!0===k.lh(c)))for(var g=0,h=f.length;g<h;g++){var l=f[g];cc(c.xc,e.Ea,c.m);n.push(l)}g=0;for(h=c.children.length;g<h;g++)a(b,c.children[g],e)}}this.enabled=!1;this.Ol=null;var b,c,e,f,g,h,k=new d.we,l=new d.S,n=[];this.vd=function(a){b=a.td;c=a;a=d.Kg.depthRGBA;var k=d.ac.clone(a.M);e=new d.Fa({I:a.I,J:a.J,M:k});f=new d.Fa({I:a.I,J:a.J,M:k,w:!0});g=new d.Fa({I:a.I,J:a.J,M:k,va:!0});h=new d.Fa({I:a.I,J:a.J,M:k,w:!0,
va:!0});e.pd=!0;f.pd=!0;g.pd=!0;h.pd=!0};this.t=function(a,b){this.enabled&&this.update(a,b)};this.update=function(q,r){var s,u,w,v,y;b.clearColor(1,1,1,1);b.disable(b.BLEND);c.ne(!0);!0===q.Le&&q.ra();r.Ea.Gb(r.m);cc(l,r.za,r.Ea);uc(k,l);c.nj(this.Ol);c.clear();n.length=0;a(q,q,r);var z;s=0;for(u=n.length;s<u;s++)w=n[s],y=w.object,w=w.buffer,y instanceof d.Ab&&!y.ah||((z=y.r instanceof d.jd?y.r.Va[0]:y.r)&&c.Bh(y.r),v=void 0!==y.k.w&&0<y.k.w.length&&z.w,z=y instanceof d.vc&&z.va,v=y.ah?y.ah:z?v?
h:g:v?f:e,w instanceof d.wa?c.jj(r,q.Bb,null,v,w,y):c.ij(r,q.Bb,null,v,w,y));v=q.nd;s=0;for(u=v.length;s<u;s++)w=v[s],y=w.object,y.visible&&(cc(y.xc,r.Ea,y.m),c.kj(r,q.Bb,null,e,y));s=c.Si();b.clearColor(s.C,s.B,s.i,0);b.enable(b.BLEND)}};
d.ik={lensFlareVertexTexture:{J:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility =        visibility.r / 9.0;\nvVisibility *= 1.0 - visibility.g / 9.0;\nvVisibility *=       visibility.b / 9.0;\nvVisibility *= 1.0 - visibility.a / 9.0;\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",I:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{J:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",I:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a;\nvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
function vd(a,b){null!==this.canvas?(this.Mc=new d.yn,void 0==this.Mc&&console.log("Flory : WebGL is not supported in your browser."),this.Mc.oj(window.innerWidth,window.innerHeight),document.body.appendChild(this.Mc.Yk)):console.log("Flory : A canvas_id must be specified.");this.Cd=void 0===a?new d.Pd:a;this.be=void 0===b?new d.zb(45,window.innerWidth/window.innerHeight,1,1E3):b;this.be.position.set(0,0,100);this.be.mc=new d.b(0,0,1);this.be.gb(this.Cd.position);this.Cd.add(this.be)}
vd.prototype={t:function(){this.Mc.t(this.Cd,this.be);return this}};function wd(){this.ge={};this.k={};this.r={}}wd.prototype={};function xd(){wd.call(this);this.id=yd++;this.name="";this.data={}}xd.prototype=Object.create(wd.prototype);xd.prototype.update=function(){};var yd=0;function zd(){this.entities=[];this.Mc={};this.data={};this.Ph=!1}
zd.prototype={add:function(a){if(this.id==a.id)console.log("Flory: Can't add an entity to itself.");else{for(var b=0,c=this.entities.length;b<c;b++)if(this.entities[b].id===a.id){console.log("Flory : Can't add an entity twice to the same enviroment.");return}this.Mk(this.entities[this.entities.push(a)-1])}return this},Mk:function(){},update:function(){},Tl:function(){}};Object.create(xd.prototype);Object.create(xd.prototype);Object.create(xd.prototype);Object.create(xd.prototype);
function Ad(a,b,c,e){xd.call(this);var f=b=void 0,g=void 0,h=void 0;void 0!=e&&(b=e.position,f=e.re,g=e.acceleration,h=e.de);this.ea=void 0!==a?a:Bd;this.sl=void 0!=c?c:0;void 0==b?this.position=new Ka(0,0):b instanceof Array?this.position=new Ka(b[0],b[1]):void 0!=b.x&&void 0!=b.y&&void 0!=b.z&&(this.position=new Ka(b.x,b.y));void 0==f?this.re=new Ka(0,0):f instanceof Array?this.re=new Ka(f[0],f[1]):void 0!=f.x&&void 0!=f.y&&void 0!=f.z&&(this.re=new Ka(f.x,f.y));void 0==g?this.acceleration=new Ka(0,
0):g instanceof Array?this.acceleration=new Ka(g[0],g[1]):void 0!=g.x&&void 0!=g.y&&void 0!=g.z&&(this.acceleration=new Ka(g.x,g.y));void 0==h?this.de=new Ka(0,0):h instanceof Array?this.de=new Ka(h[0],h[1]):void 0!=h.x&&void 0!=h.y&&void 0!=h.z&&(this.de=new Ka(h.x,h.y))}Ad.prototype=Object.create(xd.prototype);Ad.prototype.mb=function(a){return this.position.mb(a.position)};Ad.prototype.Se=function(a){return this.position.Se(a.position)};Ad.prototype.clone=function(){return new Ad(this.ea)};
var Bd=1;
function Cd(a,b,c,e){if(void 0==e)console.log("Flory: Flory.Monomer needs at least the kinematics.position to know what the dimension of the monomer is.");else if(void 0==e.position)console.log("Flory: Flory.Monomer needs at least the kinematics.position to know what the dimension of the monomer is.");else{xd.call(this);var f=b=void 0,g=void 0,h=void 0;void 0!=e&&(b=e.position,f=e.re,g=e.acceleration,h=e.de);this.ea=void 0!=a?a:Dd;this.sl=void 0!=c?c:0;this.position=void 0==b.h&&b instanceof Array?
new Oa(b):b.clone();this.re=void 0==f?new Oa([].slice.apply(new Uint8Array(this.position.Kf()))):void 0==f.h&&f instanceof Array?new Oa(f):f.clone();this.acceleration=void 0==g?new Oa([].slice.apply(new Uint8Array(this.position.Kf()))):void 0==g.h&&g instanceof Array?new Oa(g):g.clone();this.de=void 0==h?new Oa([].slice.apply(new Uint8Array(this.position.Kf()))):void 0==h.h&&h instanceof Array?new Oa(h):h.clone()}}Cd.prototype=Object.create(xd.prototype);Cd.prototype.mb=function(a){return this.position.mb(a.position)};
Cd.prototype.Se=function(a){return this.position.Se(a.position)};Cd.prototype.clone=function(){return new Ad(this.ea)};var Dd=1;Object.create(zd.prototype);Object.create(zd.prototype);function Ed(a,b){zd.call(this);this.zo=void 0!=a?a:Fd;this.Fp=void 0!=b?b:Id}Ed.prototype=Object.create(zd.prototype);
Ed.prototype.Mk=function(a){if(a instanceof Cd&&(a.data.vr=a.position.clone(),this.Ph)){this.data.af=new d.u;this.data.cj=new d.uc({color:16711680,size:2});a=0;for(var b=this.entities.length;a<b;a++)this.data.af.e.push(new d.b(this.entities[a].position.h[0],this.entities[a].position.h[1],this.entities[a].position.h[2]));this.Mc.Cd.remove(this.data.ig);this.data.ig=new d.Ab(this.data.af,this.data.cj);this.Mc.Cd.add(this.data.ig)}};
Ed.prototype.Tl=function(){this.data.af=new d.u;this.data.cj=new d.uc({color:16711680,size:2});for(var a=0,b=this.entities.length;a<b;a++)this.entities[a]instanceof Cd&&this.data.af.e.push(new d.b(this.entities[a].position.h[0],this.entities[a].position.h[1],this.entities[a].position.h[2]));this.data.ig=new d.Ab(this.data.af,this.data.cj);this.Mc.Cd.add(this.data.ig)};
Ed.prototype.update=function(){for(var a=0,b=this.entities.length;a<b;a++){var c=this.entities[a],e=new Oa(this.entities[a].position.Kf());if(c instanceof Cd){for(var f=0,b=this.entities.length;f<b;f++){var g=this.entities[f];if(g instanceof Cd&&g.id!=c.id){var g=g.position.clone().sub(c.position),h=g.length();if(!(h>Jd)){var k=this.Fp/h,g=g.scale(-24*this.zo/(h*h)*(2*Math.pow(k,12)-Math.pow(k,6)));e.add(g)}}}c.de=e.clone()}}a=0;for(b=this.entities.length;a<b;a++)c=this.entities[a],c instanceof Cd&&
(c.acceleration=c.de.th(1/c.sl),c.re.add(c.acceleration.th(.01)),c.position.add(c.re.th(.005)),this.Ph&&(this.data.af.e[a]=new d.b(c.position.h[0],c.position.h[1],c.position.h[2])));this.data.ig.k.Oa=!0;this.Ph&&this.Mc.t();return this};var Jd=100,Id=1,Fd=1;Object.create(zd.prototype);var Kd=new Sa,Ld=[],Md=new Ed(1,1);
function Nd(a){var b;b=100*Kd.random()*(.5-Kd.random());var c=100*Kd.random()*(.5-Kd.random());b=new Oa([b,c]);for(c=0;c<a.length;c++)4.25>=a[c].position.Se(b)&&Nd(a);return new Cd(.5,0,1,{position:b})}for(var Od=0;150>Od;Od++)Ld.push(Nd(Ld)),Md.add(Ld[Od]);Md.Mc=new vd;Md.Ph=!0;Md.Tl();var Pd=0;setInterval(function(){Md.update();Pd++},1);setInterval(function(){Pd=0},1E3);
