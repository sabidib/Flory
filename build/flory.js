var Flory={VERSION:"0.01",Vector3:function(a,c,d){this.x=void 0===a?0:a;this.y=void 0===c?0:c;this.z=void 0===d?0:d}};
Flory.Vector3.prototype={constructor:Flory.Vector3,dimension:function(){return 3},add:function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this},sub:function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this},dot:function(a){return this.x*a.x+this.y*a.y+this.z*a.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},distanceTo:function(a){return Math.sqrt((a.x-this.x)*(a.x-this.x)+(a.y-this.y)*(a.y-
this.y)+(a.z-this.z)*(a.z-this.z))},distanceToSq:function(a){return(a.x-this.x)*(a.x-this.x)+(a.y-this.y)*(a.y-this.y)+(a.z-this.z)*(a.z-this.z)},clone:function(){return new Flory.Vector3(this.x,this.y,this.z)}};Flory.Vector2=function(a,c){this.x=void 0===a?0:a;this.y=void 0===c?0:c};
Flory.Vector2.prototype={constructor:Flory.Vector2,dimension:function(){return 2},add:function(a){this.x+=a.x;this.y+=a.y;return this},sub:function(a){this.x-=a.x;this.y-=a.y;return this},dot:function(a){return this.x*a.x+this.y*a.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},lengthSq:function(){return this.x*this.x+this.y*this.y},distanceTo:function(a){return Math.sqrt((a.x-this.x)*(a.x-this.x)+(a.y-this.y)*(a.y-this.y))},distanceToSq:function(a){return(a.x-this.x)*(a.x-this.x)+
(a.y-this.y)*(a.y-this.y)},clone:function(){return new Flory.Vector2(this.x,this.y)}};Flory.Vector=function(a){this.components=a};
Flory.Vector3.prototype={constructor:Flory.Vector,dimension:function(){return this.components.length},add:function(a){for(var c=0,d=this.a.length;c<d;c++)this.components[c]+=a[c];return this},sub:function(a){for(var c=0,d=this.a.length;c<d;c++)this.components[c]-=a[c];return this},dot:function(a){if(a.length!=b.length)console.log("Flory.vector.dot(a) can only accept a vector of the same dimension as the object.");else{for(var c=0,d=0,e=this.a.length;d<e;d++)c+=this.components[d]*a[d];return c}},length:function(){for(var a=
0,c=0,d=this.components.length;c<d;c++)a+=this.components[c]*this.components[c];return Math.sqrt(a)},lengthSq:function(){for(var a=0,c=0,d=this.components.length;c<d;c++)a+=this.components[c]*this.components[c];return a},distanceTo:function(a){for(var c=0,d=0,e=this.a.length;d<e;d++)c+=(this.components[d]-a.components[d])*(this.components[d]-a.components[d]);d=0;e=this.components.length;for(a=this.components.length-this.a.length;a<e;d++)c+=this.components[d+e]*this.components[d+e];return Math.sqrt(c)},
distance:function(a){for(var c=0,d=0,e=this.a.length;d<e;d++)c+=(this.components[d]-a.components[d])*(this.components[d]-a.components[d]);d=0;e=this.components.length;for(a=this.components.length-this.a.length;a<e;d++)c+=this.components[d+e]*this.components[d+e];return c},clone:function(){return new Flory.Vector(this.x,this.y,this.z)}};
Flory.RandomGen=function(a){void 0==a&&(a=(new Date).getTime());this.N=624;this.M=397;this.MATRIX_A=2567483615;this.UPPER_MASK=2147483648;this.LOWER_MASK=2147483647;this.mt=Array(this.N);this.mti=this.N+1;this.init_genrand(a)};Flory.RandomGen.prototype.init_genrand=function(a){this.mt[0]=a>>>0;for(this.mti=1;this.mti<this.N;this.mti++)a=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30,this.mt[this.mti]=(1812433253*((a&4294901760)>>>16)<<16)+1812433253*(a&65535)+this.mti,this.mt[this.mti]>>>=0};
Flory.RandomGen.prototype.init_by_array=function(a,c){var d,e,f;this.init_genrand(19650218);d=1;e=0;for(f=this.N>c?this.N:c;f;f--){var g=this.mt[d-1]^this.mt[d-1]>>>30;this.mt[d]=(this.mt[d]^(1664525*((g&4294901760)>>>16)<<16)+1664525*(g&65535))+a[e]+e;this.mt[d]>>>=0;d++;e++;d>=this.N&&(this.mt[0]=this.mt[this.N-1],d=1);e>=c&&(e=0)}for(f=this.N-1;f;f--)g=this.mt[d-1]^this.mt[d-1]>>>30,this.mt[d]=(this.mt[d]^(1566083941*((g&4294901760)>>>16)<<16)+1566083941*(g&65535))-d,this.mt[d]>>>=0,d++,d>=this.N&&
(this.mt[0]=this.mt[this.N-1],d=1);this.mt[0]=2147483648};
Flory.RandomGen.prototype.genrand_int32=function(){var a,c=[0,this.MATRIX_A];if(this.mti>=this.N){var d;this.mti==this.N+1&&this.init_genrand(5489);for(d=0;d<this.N-this.M;d++)a=this.mt[d]&this.UPPER_MASK|this.mt[d+1]&this.LOWER_MASK,this.mt[d]=this.mt[d+this.M]^a>>>1^c[a&1];for(;d<this.N-1;d++)a=this.mt[d]&this.UPPER_MASK|this.mt[d+1]&this.LOWER_MASK,this.mt[d]=this.mt[d+(this.M-this.N)]^a>>>1^c[a&1];a=this.mt[this.N-1]&this.UPPER_MASK|this.mt[0]&this.LOWER_MASK;this.mt[this.N-1]=this.mt[this.M-
1]^a>>>1^c[a&1];this.mti=0}a=this.mt[this.mti++];a^=a>>>11;a^=a<<7&2636928640;a^=a<<15&4022730752;return(a^a>>>18)>>>0};Flory.RandomGen.prototype.genrand_int31=function(){return this.genrand_int32()>>>1};Flory.RandomGen.prototype.genrand_real1=function(){return this.genrand_int32()*(1/4294967295)};Flory.RandomGen.prototype.random=function(){return this.genrand_int32()*(1/4294967296)};Flory.RandomGen.prototype.genrand_real3=function(){return(this.genrand_int32()+.5)*(1/4294967296)};
Flory.RandomGen.prototype.genrand_res53=function(){var a=this.genrand_int32()>>>5,c=this.genrand_int32()>>>6;return 1.1102230246251565E-16*(67108864*a+c)};Flory.Monomer2D=function(a,c){this.radius=void 0==a?a:Flory.Monomer2D.defaultRadius;this.position=void 0==c.x&&void 0==c.y?new Flory.Vector2(c[0],c[1]):new Flory.Vector2(c.x,c.y)};
Flory.Monomer2D.prototype={incrementX:function(a){this.position.x+=a;return this},incrementY:function(a){this.position.y+=a;return this},distanceTo:function(a){return this.position.distanceTo(a.position)},distanceToSq:function(a){return this.position.distanceToSq(a.position)},clone:function(){return new Flory.Monomer2D(this.radius,this.position)}};Flory.Monomer2D.defaultRadius=1;
Flory.Monomer3D=function(a,c){this.radius=void 0==a?a:Flory.Monomer3D.defaultRadius;this.position=void 0==c.x&&void 0==c.y&&void 0==c.z?new Flory.Vector3(c[0],c[1],c[2]):new Flory.Vector3(c.x,c.y,c.z)};
Flory.Monomer3D.prototype={incrementX:function(a){this.position.x+=a;return this},incrementY:function(a){this.position.y+=a;return this},incrementZ:function(a){this.position.z+=a;return this},distanceTo:function(a){return this.position.distanceTo(a.position)},distanceToSq:function(a){return this.position.distanceToSq(a.position)},clone:function(){return new Flory.Monomer3D(this.radius,this.position)}};Flory.Monomer3D.defaultRadius=1;
Flory.Monomer=function(a,c){this.radius=void 0==a?a:Flory.Monomer.defaultRadius;this.position=void 0==c.components?new Flory.Vector(c):c.clone()};Flory.Monomer3D.prototype={incrementDimension:function(a,c){this.position.components[a]+=c;return this},distanceTo:function(a){return this.position.distanceTo(a.position)},distanceToSq:function(a){return this.position.distanceToSq(a.position)},clone:function(){return new Flory.Monomer3D(this.radius,this.position)}};Flory.Monomer.defaultRadius=1;
